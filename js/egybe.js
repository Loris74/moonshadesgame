function karakterlap_kibe(e){if($("#karekterlap_"+e).is(":visible")){$("#karekterlap_"+e).fadeOut(200)}else{$("#karekterlap_"+e).fadeIn(200)}}function inventory_kibe(e){if($("#inventory_"+e).is(":visible")){$("#inventory_"+e).fadeOut(200)}else{$("#inventory_"+e).fadeIn(200)}}function skills_kibe(e){if($("#skills_"+e).is(":visible")){$("#skills_"+e).fadeOut(200)}else{$("#skills_"+e).fadeIn(200)}}function abilities_kibe(e){if($("#abilities_"+e).is(":visible")){$("#abilities_"+e).fadeOut(200)}else{$("#abilities_"+e).fadeIn(200)}}function inventory_be(e){$("#inventory_"+e).fadeIn(200)}function karakterlap_be(e){$("#karekterlap_"+e).fadeIn(200)}function skills_be(e){$("#skills_"+e).fadeIn(200)}function abilities_be(e){$("#abilities_"+e).fadeIn(200)}function minden_ablak_ki(){$("#inventory_1").hide();$("#inventory_2").hide();$("#inventory_3").hide();$("#inventory_4").hide();$("#inventory_5").hide();$("#inventory_6").hide();$("#karekterlap_1").hide();$("#karekterlap_2").hide();$("#karekterlap_3").hide();$("#karekterlap_4").hide();$("#karekterlap_5").hide();$("#karekterlap_6").hide();$("#skills_1").hide();$("#skills_2").hide();$("#skills_3").hide();$("#skills_4").hide();$("#skills_5").hide();$("#skills_6").hide();$("#abilities_1").hide();$("#abilities_2").hide();$("#abilities_3").hide();$("#abilities_4").hide();$("#abilities_5").hide();$("#abilities_6").hide();$("#terkepek").hide();$("#kuldi_hatter").hide();$("#jatek_menu_fedo_reteg").hide();$("#artifact_hatter").hide();$(".achievements_hatter").hide();$(".gems_hatter").hide();$(".forge_hatter").hide()}function hang_lejatszas(e,t){var n;for(var r=0;r<hangok_betoltesre.length;r++){if(hangok_betoltesre[r][0]==e){n=r;break}}if(hangok_betoltesre[n][2]==1){clearTimeout(i);soundManager.play(e,t)}else{var i=setTimeout(function(){hang_lejatszas(e,t)},1e3)}}function intro(){hang_lejatszas(2);$("#cutscenes").show();fade_cutscene(elso,elso+1);elso++;cutscene=setInterval(function(){fade_cutscene(elso,elso+1);elso++;if(elso>=cutscenes_length){clearInterval(cutscene)}},fade_time+6e3)}function fade_cutscene(e,t){if(e!=0){$("#cutscene_image_"+e).animate({width:"-=200",height:"-=200",opacity:"0"},fade_time)}$("#cutscene_image_"+t).fadeIn(fade_time);if(e!=0){$("#cutscene_text_"+e).fadeOut(fade_time)}$("#cutscene_text_"+t).fadeIn(fade_time)}function info_szoveg(e){var t=new Date,n=t.getHours().pad(2),r=t.getMinutes().pad(2);s=t.getSeconds().pad(2);var i=$("#szovegek").index();$("#szovegek").prepend('<div class="szovegek_egysor" style="display:none" id="egysor_'+(i+1)+'">'+n+":"+r+":"+s+": "+e+"</div>");$("#egysor_"+(i+1)).fadeIn(300)}function gomb_skill(e){var t=0;var n=0;if(e==49){t=1;n=1}if(e==50){t=2;n=2}if(e==51){t=3;n=1}if(e==52){t=4;n=2}var r=false;for(i=0;i<karakterek.length;i++){if(t==1||t==2){if(karakterek[i].hanyadik_sorban_van=="1"&&karakterek[i].sorban_melyik_oldal=="bal"){r=karakterek[i]}}if(t==3||t==4){if(karakterek[i].hanyadik_sorban_van=="1"&&karakterek[i].sorban_melyik_oldal=="jobb"){r=karakterek[i]}}}r.tamadas(n)}function jatek_betoltese(e){var t=function(){var t=$.ajax({type:"POST",async:false,url:"ajax_jatek_betoltese.php",data:"id="+e+"&mit=terkepek",success:function(t){var n=JSON.parse(t);if(typeof n.length==="undefined"){ideiglenes_terkepek.push(n)}else{for(var r=0;r<n.length;r++){ideiglenes_terkepek.push(n[r])}}var i=0;if(e==0){i=1}else{for(var r=0;r<ideiglenes_terkepek.length;r++){if(ideiglenes_terkepek[r].ezen_van==1){i=ideiglenes_terkepek[r].id;break}}}terkep.init(i);terkep.dungeon_felepitese();ideiglenes_terkepek_frissitese(i)}});return t};var n=function(){var t=$.ajax({type:"POST",async:false,url:"ajax_jatek_betoltese.php",data:"id="+e+"&mit=karakterek",success:function(e){var t=JSON.parse(e);for(var n=0;n<t.length;n++){var r=new Karakter;r.letrehozas(t[n].id,t[n].nev);r.sor_beallitas(t[n].hanyadik_sorban_van,t[n].sorban_melyik_oldal);r.adatok_beolvasasa_mentesbol(t[n]);r.hozzadas_a_domhoz();for(var i=0;i<t[n].inventory.length;i++){if(t[n].inventory[i]!=0){r.loot_taskaba_pontos_helyre(t[n].inventory[i],i)}}for(var i=0;i<t[n].karakterlap.length;i++){if(t[n].karakterlap[i]!=0){r.karakterlapra_item(t[n].karakterlap[i],i)}}for(var i=0;i<t[n].portre_skillek.length;i++){if(t[n].portre_skillek[i]!=0){r.portre_skillre_skill(t[n].portre_skillek[i],i)}}r.portre_skillek_objektum_frissitese();r.inventory_objektum_frissitese();r.karakterlap_objektum_frissitese();r.hp_es_mana_beallitasa()}var r=new Karakter;r.listenerek_bekapcsolasa()}});return t};var r=function(){var t=$.ajax({type:"POST",async:false,url:"ajax_jatek_betoltese.php",data:"id="+e+"&mit=npck",success:function(e){if(e!=""){var t=JSON.parse(e);ideiglenes_npc_adatok=t}}});return t};$.when(r(),n(),t()).done(function(e,t,n){init()})}function artifakt_toogle(){if($("#artifact_hatter").is(":visible")){$("#jatek_menu_fedo_reteg").hide();$("#artifact_hatter").fadeOut(100)}else{$("#artifact_hatter").center();var e=$(document).height();$("#jatek_menu_fedo_reteg").height(e);$("#jatek_menu_fedo_reteg").show();$("#artifact_hatter").fadeIn(100,function(){})}}function gems_toogle(){if($(".gems_hatter").is(":visible")){$(".gems_hatter").fadeOut(100)}else{$(".gems_hatter").fadeIn(100,function(){})}}function achievements_toogle(){if($(".achievements_hatter").is(":visible")){$(".achievements_hatter").fadeOut(100)}else{$(".achievements_hatter").fadeIn(100,function(){})}}function forge_toogle(){if($(".forge_hatter").is(":visible")){$(".forge_hatter").fadeOut(100)}else{$(".forge_hatter").fadeIn(100,function(){})}}function terkep_toogle(){if($("#terkepek").is(":visible")){$("#jatek_menu_fedo_reteg").hide();$("#terkepek").fadeOut(100)}else{$("#terkepek").center();var e=$(document).height();$("#jatek_menu_fedo_reteg").height(e);$("#jatek_menu_fedo_reteg").show();$("#terkepek").fadeIn(100,function(){})}}function jatek_menu_toogle(){if($("#jatek_menu").is(":visible")){$("#jatek_menu_fedo_reteg").hide();$("#jatek_menu").fadeOut(100);start()}else{stop();$("#jatek_menu").center();var e=$(document).height();$("#jatek_menu_fedo_reteg").height(e);$("#jatek_menu_fedo_reteg").show();$("#jatek_menu").fadeIn(100,function(){})}}function terkep_matrix_kiegeszitesek_pozicio_alapjan(e,t){var n=terkep.getTerkepMatrixKiegeszitesek();var r=new Array;for(var i=0;i<n.length;i++){if(n[i].x==e&&n[i].y==t){r.push(n[i])}}return r}function foldrol_targy_felvetele(e){var t=false;for(var n=0;n<karakterek.length;n++){var r=karakterek[n];if(r.loot_taskaba(e)){t=r;break}}if(t===false){info_szoveg("Not enough space in inventory!");return false}else{hang_lejatszas(5,{pan:0,volume:90});var i=targyak.targyadatok(e);info_szoveg(t.nev+' got a <span class="item_chatben" title="'+i.targy_leirasa+'" style="color:#'+i.kategoria_szine+'">'+i.targy_neve+"</span>");$(".item_chatben").qtip(tooltip_options);return true}}function karakter_hanyadik_a_tombben_id_alapjan(e){var t=0;for(i=0;i<karakterek.length;i++){if(karakterek[i].id==e){t=i;break}}return t}function rad(e){return e*(Math.PI/180)}function deg(e){return Math.round(e*(180/Math.PI))}function randint(e,t){var e=parseInt(e);var t=parseInt(t);return parseInt(Math.floor(Math.random()*(t-e+1))+e)}function morphColorsToFaceColors(e){if(e.morphColors&&e.morphColors.length){var t=e.morphColors[0];for(var n=0;n<t.colors.length;n++){e.faces[n].color=t.colors[n];THREE.ColorUtils.adjustHSV(e.faces[n].color,0,.125,0)}}}function removeReferences(e){try{e.traverse(function(e){try{}catch(t){}try{e.geometry.dispose();e.geometry.morphTargets=[]}catch(t){}try{for(var n=0;n<e.material.length;n++){e.material[n].dispose();e.material[n].map.dispose()}e.material.map.dispose();e.material.dispose()}catch(t){}try{}catch(t){}})}catch(t){}}function szintvaltas(e){if(e==0){hang_lejatszas(38,{pan:0,volume:40});info_szoveg("You cant go back to the surface while the demons are there!");return}if(e==2){hang_lejatszas(38,{pan:0,volume:40});info_szoveg("You cant go down yet!");return}stop();terkep.ezen_van=0;ideiglenes_terkepek_frissitese(terkep.id);npck=[];morphs=[];ellensegek=[];aktiv_objektumok=[];collidableMeshList=[];psys_tomb_fenyek=[];psys_tomb=[];var t,n;for(var n=scene.children.length-1;n>=0;n--){var t=scene.children[n];if(t instanceof THREE.PerspectiveCamera||t instanceof THREE.AmbientLight){}else{t.off("click");scene.remove(t);removeReferences(t);continue;if(typeof t!=="undefined"){for(var r=0;r<t.children.length;r++){if(typeof t.children[r].geometry!=="undefined"){t.children[r].geometry.deallocate()}t.children[r]=null}t.deallocate();if(typeof t.geometry!=="undefined"){if(typeof t.geometry.materials!=="undefined"){for(var r=0;r<t.geometry.materials.length;r++){t.geometry.materials[r].deallocate()}}t.geometry.deallocate()}if(typeof t.material!=="undefined"){if(t.material instanceof THREE.MeshFaceMaterial){renderer.deallocateMaterial(t.material)}else{if(t.material.map instanceof THREE.Texture){t.material.map.deallocate();renderer.deallocateTexture(t.material.map)}if(t.material.normalMap instanceof THREE.Texture){t.material.normalMap.deallocate();renderer.deallocateTexture(t.material.normalMap)}if(t.material.specularMap instanceof THREE.Texture){t.material.specularMap.deallocate();renderer.deallocateTexture(t.material.specularMap)}t.material.deallocate();renderer.deallocateMaterial(t.material)}}renderer.deallocateObject(t)}}}start();terkep.init(e);terkep_matrix=terkep.getTerkepMatrix();terkep_matrix_kiegeszitesek=terkep.getTerkepMatrixKiegeszitesek();terkep_szelesseg=terkep_matrix[0].length;terkep_magassag=terkep_matrix.length;grid=new PF.Grid(terkep_szelesseg,terkep_magassag,terkep_matrix);finder=new PF.AStarFinder;terkep.dungeon_felepitese();terkep.ezen_van=1;ideiglenes_terkepek_frissitese(e)}function ideiglenes_terkepek_frissitese(e){for(var t=0;t<ideiglenes_terkepek.length;t++){if(ideiglenes_terkepek[t].id==e){ideiglenes_terkepek.splice(t,1)}}ideiglenes_terkepek.push(terkep.getTerkepKiegeszitesek())}function npc_interakcio_be(e){$("#npc_interakcio_div").show();$("#npc_interakcio_div").click(function(){$("#npc_interakcio_div").hide();$("#kuldi_tartalom").empty();e.interakcio_inditasa();hang_lejatszas(15,{pan:0,volume:20})})}function npc_interakcio_ki(){$("#kuldi_0").fadeOut(300);$("#npc_interakcio_div").hide();$("#npc_interakcio_div").unbind("click")}function npc_interakcio_valaszadas(e){$('[id^="beszed_id_"]').hide();$("#beszed_id_"+e).show();mozgas_logolas("NPC BESZELGETES id:"+e);if(e==0){$("#kuldi_0").fadeOut(300)}hang_lejatszas(15,{pan:0,volume:20})}function npc_boltot_nyit(e){console.log(e);$('[id^="beszed_id_"]').hide();$("#npc_interakcio_elinditva_div").hide();for(var t=0;t<npck.length;t++){if(npck[t].id==e){npck[t].boltot_nyit()}}}function npc_kuldit_elfogad(e,t){alert("kuldi_id"+t)}function npc_targyat_ad(e,t){var n=false;for(var r=0;r<npck.length;r++){if(npck[r].id==e){n=npck[r];break}}mozgas_logolas("NPC TARGYAT AD id:"+t);if(n.odaadta_e_mar_a_targyat(t)){info_szoveg("You already got this item.");return}var i=false;for(r=0;r<karakterek.length;++r){var s=karakterek[r];if(s.loot_taskaba(t)){i=s;n.targy_odaadva(t);break}}if(i===false){info_szoveg("Not enough space in inventory!")}else{var o=targyak.targyadatok(t);info_szoveg(s.nev+" got a "+o.targy_neve);hang_lejatszas(5,{pan:0,volume:90})}}function lada_kinyitas(e,t){hang_lejatszas(29,{pan:0,volume:100});e.off("click");e.time=0;e.setFrameRange(3,5);lada_kinyitva_timeout=setInterval(function(){lada_kinyitva(e,t)},0)}function lada_kinyitva(e,t){if(e.currentKeyframe==5){clearInterval(lada_kinyitva_timeout);e.lastKeyframe=5;e.currentKeyframe=5;e.setFrameRange(5,5);for(var n=0;n<t.length;n++){var r=foldrol_targy_felvetele(t[n])}hang_lejatszas(5,{pan:0,volume:90});scene.remove(e);e.material.map.dispose();e.material.dispose();e.geometry.dispose()}else{}}function van_e_megfelelo_targy_a_nyitashoz(e){var t=false;for(i=0;i<karakterek.length;i++){var n=karakterek[i].van_e_nala_targy_id(e);if(n!==false){karakterek[i].targy_elvetele(e);t=true;break}}return t}function fenyek_bekapcsolasa4(){console.log("scene.children.length: "+scene.children.length);for(var e=0;e<psys_tomb_fenyek.length;e++){scene.remove(psys_tomb_fenyek[e])}}function compare(e,t){if(e.tavolsag<t.tavolsag)return-1;if(e.tavolsag>t.tavolsag)return 1;return 0}function fenyek_bekapcsolasa3(){var e=new Array;for(var t=0;t<psys_tomb_fenyek.length;t++){var n=psys_tomb_fenyek[t].position;var r=MovingCube.position.distanceTo(psys_tomb_fenyek[t].position);e.push({tavolsag:r,obj:psys_tomb_fenyek[t]})}e.sort(compare);var i=0;for(var t=0;t<e.length;t++){var n=e[t].obj.position;if(parseInt(e[t].tavolsag)<=400){if(i<4){scene.add(e[t].obj);i++}else{}}else{if(i<4){scene.add(e[t].obj);i++}else{scene.remove(e[t].obj)}}}}function targy_use(e,t,n){var r=targyak.targyadatok(t);if(r.fokategoria=="ital"){if(r.alkategoria=="mana"){var i=karakter_hanyadik_a_tombben_id_alapjan(n);karakterek[i].manat_kap(r.mennyi_manat_ad);if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}}}else{info_szoveg("You cant use that.")}}function targy_unequip(e,t,n){var r=targyak.targyadatok(t);var i='<img title="'+r.targy_leirasa+'" class="item" data-item-id="'+r.id+'" src="assets/items/'+r.kep_fajl+'">';var s=karakter_hanyadik_a_tombben_id_alapjan(n);karakterek[s].loot_taskaba(t);$(".item").qtip(tooltip_options);console.log(e);$("#karekterlap_"+n).children("#karekterlap_felszerelesek").children("#"+e).html("");if(e=="karakterlap_bal_kez"){$("#karakter_"+n+"_kez_1").html("")}if(e=="karakterlap_jobb_kez"){$("#karakter_"+n+"_kez_2").html("")}hang_lejatszas(8,{pan:0,volume:20})}function targy_atadas(e,t,n,r){var i=targyak.targyadatok(t);var s='<img title="'+i.targy_leirasa+'" class="item" data-item-id="'+i.id+'" src="assets/items/'+i.kep_fajl+'">';var o=karakter_hanyadik_a_tombben_id_alapjan(r);var u=karakterek[o].loot_taskaba(t);if(u){if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}var a=karakter_hanyadik_a_tombben_id_alapjan(n);karakterek[a].inventory_objektum_frissitese()}}function targy_equip(e,t,n){var r=targyak.targyadatok(t);var i='<img title="'+r.targy_leirasa+'" class="item" data-item-id="'+r.id+'" src="assets/items/'+r.kep_fajl+'">';var s=karakter_hanyadik_a_tombben_id_alapjan(n);if(!karakterek[s].tudja_e_hasznalni(t)){info_szoveg("You cant equip this type of item.");return false}mozgas_logolas("TARGY EQUIP targy_id:"+t+" targyadatok.fokategoria:"+r.fokategoria+" targyadatok.alkategoria:"+r.alkategoria+" karakter_id:"+n);if(r.fokategoria=="fegyver"||r.fokategoria=="pancel"){if(r.fokategoria=="pancel"){var o="";if(r.alkategoria=="mellvert"){o="karakterlap_"+n+"_torzs"}if(r.alkategoria=="sapka"){o="karakterlap_"+n+"_fej"}if(r.alkategoria=="nyaklanc"){o="karakterlap_"+n+"_nyak"}if(r.alkategoria=="gyuru"){o="karakterlap_"+n+"_gyuru1"}if(r.alkategoria=="cipo"){o="karakterlap_"+n+"_cipo"}if(r.alkategoria=="kesztyu"){o="karakterlap_"+n+"_kesztyu"}var u=$("#karekterlap_"+n).children("#karekterlap_felszerelesek").children("#"+o);if(u.html()==""){u.html(i);if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}hang_lejatszas(8,{pan:0,volume:30})}else{var a=u.children().attr("data-item-id");u.html(i);if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}karakterek[s].loot_taskaba(a);$(".item").qtip(tooltip_options);hang_lejatszas(8,{pan:0,volume:30})}}if(r.fokategoria=="fegyver"){var f=$("#karekterlap_"+n).children("#karekterlap_felszerelesek").children("#karakterlap_"+n+"_bal_kez");var l=$("#karekterlap_"+n).children("#karekterlap_felszerelesek").children("#karakterlap_"+n+"_jobb_kez");if(f.html()==""){f.html(i);$(".item").qtip(tooltip_options);$("#karakter_"+n+"_kez_1").html('<img src="assets/items/'+r.kep_fajl+'">');if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}hang_lejatszas(8,{pan:0,volume:30})}else if(l.html()==""){l.html(i);$(".item").qtip(tooltip_options);$("#karakter_"+n+"_kez_2").html('<img src="assets/items/'+r.kep_fajl+'">');if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}hang_lejatszas(8,{pan:0,volume:30})}else{var c=f.children().attr("data-item-id");f.html(i);$("#karakter_"+n+"_kez_1").html('<img src="assets/items/'+r.kep_fajl+'">');if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}var s=karakter_hanyadik_a_tombben_id_alapjan(n);karakterek[s].loot_taskaba(c);$(".item").qtip(tooltip_options);hang_lejatszas(8,{pan:0,volume:30})}}karakterek[s].inventory_objektum_frissitese();karakterek[s].karakterlap_objektum_frissitese();$(".item").qtip(tooltip_options)}else{info_szoveg("You cant equip that.")}}function toltes_jelzo_bekapcsol(){toltes_hanyszor_kapcsolt_be++}function toltes_jelzo_kikapcsol(){toltes_hanyszor_kapcsolt_be--;if(toltes_hanyszor_kapcsolt_be==0){}}function base64_encode(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e){return e}do{n=e.charCodeAt(l++);r=e.charCodeAt(l++);i=e.charCodeAt(l++);f=n<<16|r<<8|i;s=f>>18&63;o=f>>12&63;u=f>>6&63;a=f&63;p[c++]=t.charAt(s)+t.charAt(o)+t.charAt(u)+t.charAt(a)}while(l<e.length);h=p.join("");var d=e.length%3;return(d?h.slice(0,d-3):h)+"===".slice(d||3)}function base64_decode(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e){return e}e+="";do{s=t.indexOf(e.charAt(l++));o=t.indexOf(e.charAt(l++));u=t.indexOf(e.charAt(l++));a=t.indexOf(e.charAt(l++));f=s<<18|o<<12|u<<6|a;n=f>>16&255;r=f>>8&255;i=f&255;if(u==64){p[c++]=String.fromCharCode(n)}else if(a==64){p[c++]=String.fromCharCode(n,r)}else{p[c++]=String.fromCharCode(n,r,i)}}while(l<e.length);h=p.join("");return h}function kerdoiv_megjelenites(){$(document).unbind("keydown");$("#kerdoiv").show()}function kerdoiv_bezar(){$.ajax({type:"POST",url:"ajax_kerdoiv.php",data:"valaszolt=0",success:function(){$("#kerdoiv").hide()}});$(document).bind("keydown",function(e){var t=e.which;if(t==83){mozgas("le")}if(t==87){mozgas("fel")}if(t==65){mozgas("bal")}if(t==68){mozgas("jobb")}if(t==81){fordulas("bal")}if(t==69){fordulas("jobb")}if(t==27){if($(".karekterlap_hatter").is(":visible")||$(".inventory_hatter").is(":visible")||$(".skills_hatter").is(":visible")||$(".abilities_hatter").is(":visible")||$("#kuldi_hatter").is(":visible")||$("#terkepek").is(":visible")||$("#artifact_hatter").is(":visible")||$(".forge_hatter").is(":visible")||$(".achievements_hatter").is(":visible")||$(".gems_hatter").is(":visible")){minden_ablak_ki()}else{jatek_menu_toogle()}}if(t==49||t==50||t==51||t==52){gomb_skill(t)}})}function kerdoiv_elkuld(){$.ajax({type:"POST",url:"ajax_kerdoiv.php",data:"valaszolt=1&valasz1="+$("input:radio[name='valasz1']:checked").val()+"&valasz2="+$("input:radio[name='valasz2']:checked").val()+"&valasz3="+$("input:radio[name='valasz3']:checked").val()+"&valasz4="+$("input:radio[name='valasz4']:checked").val()+"&valasz_egyeb="+$("#valasz_egyeb").val(),success:function(){$("#kerdoiv").hide()}});$(document).bind("keydown",function(e){var t=e.which;if(t==83){mozgas("le")}if(t==87){mozgas("fel")}if(t==65){mozgas("bal")}if(t==68){mozgas("jobb")}if(t==81){fordulas("bal")}if(t==69){fordulas("jobb")}if(t==27){if($(".karekterlap_hatter").is(":visible")||$(".inventory_hatter").is(":visible")||$(".skills_hatter").is(":visible")||$(".abilities_hatter").is(":visible")||$("#kuldi_hatter").is(":visible")||$("#terkepek").is(":visible")||$("#artifact_hatter").is(":visible")||$(".forge_hatter").is(":visible")||$(".achievements_hatter").is(":visible")||$(".gems_hatter").is(":visible")){minden_ablak_ki()}else{jatek_menu_toogle()}}if(t==49||t==50||t==51||t==52){gomb_skill(t)}})}function Elemek(){this.id=0;this.ajto_eppen_mozog=0;this.createCube=function(e,t,n,r,i){var s;var o=e||new THREE.MeshBasicMaterial({color:170});o.transparent=1;var u=t||{x:1,y:1,z:1};var a=n||{x:50,y:50,z:50};var f=r||{x:1,y:1,z:1};var l=i||{x:0,y:0,z:0};s=new THREE.Mesh(new THREE.CubeGeometry(a.x,a.y,a.z),o);s.scale.set(f.x,f.y,f.z);s.position.set(u.x,u.y,u.z);s.rotation.set(l.x,l.y,l.z);return s};this.createPadlo=function(e,t,n){if(terkep.meta.ALAP_PADLO_TEXTURA_NORMAL!=""&&terkep.meta.ALAP_PADLO_TEXTURA_SPECULAR!=""){var r=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA_NORMAL,undefined,toltes_jelzo_kikapcsol);r.anisotropy=anisotropy;r=this.repeatTexture(r,n);toltes_jelzo_bekapcsol();var i=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA_SPECULAR,undefined,toltes_jelzo_kikapcsol);i.anisotropy=anisotropy;i=this.repeatTexture(i,n);toltes_jelzo_bekapcsol();var s=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA,undefined,toltes_jelzo_kikapcsol);s.anisotropy=anisotropy;s=this.repeatTexture(s,n);var o=new THREE.Vector2(1,1);var u=new THREE.MeshPhongMaterial({map:s,normalMap:r,normalScale:o,specularMap:i,specular:16755578,shininess:10})}else{toltes_jelzo_bekapcsol();var r=THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA,undefined,toltes_jelzo_kikapcsol);r.anisotropy=anisotropy;r=this.repeatTexture(r,n);r.wrapS=THREE.RepeatWrapping;r.wrapT=THREE.RepeatWrapping;var u=new THREE.MeshPhongMaterial({map:r})}var a=new THREE.PlaneGeometry(t.x,t.z,t.x/cubesize,t.z/cubesize);plane2=new THREE.Mesh(a,u);plane2.position.set(e.x,e.y,e.z);plane2.rotation.x=rad(270);return plane2};this.createPlafon=function(e,t,n,r){if(terkep.meta.ALAP_PLAFON_TEXTURA_NORMAL!=""&&terkep.meta.ALAP_PLAFON_TEXTURA_SPECULAR!=""){toltes_jelzo_bekapcsol();var i=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PLAFON_TEXTURA_NORMAL,undefined,toltes_jelzo_kikapcsol);i.anisotropy=anisotropy;i=this.repeatTexture(i,r);toltes_jelzo_bekapcsol();var s=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PLAFON_TEXTURA_SPECULAR,undefined,toltes_jelzo_kikapcsol);s.anisotropy=anisotropy;s=this.repeatTexture(s,r);toltes_jelzo_bekapcsol();var o=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PLAFON_TEXTURA,undefined,toltes_jelzo_kikapcsol);o.anisotropy=anisotropy;o=this.repeatTexture(o,r);var u=new THREE.Vector2(1,1);var a=new THREE.MeshPhongMaterial({map:o,normalMap:i,normalScale:u,specularMap:s,specular:16755578,shininess:180})}else{toltes_jelzo_bekapcsol();var i=THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_PLAFON_TEXTURA,undefined,toltes_jelzo_kikapcsol);i.anisotropy=anisotropy;i=this.repeatTexture(i,r);var a=new THREE.MeshPhongMaterial({map:i})}var f=new THREE.PlaneGeometry(n.x,n.z,n.x/cubesize,n.z/cubesize);plane2=new THREE.Mesh(f,a);plane2.position.set(t.x,t.y,t.z);plane2.rotation.x=rad(90);return plane2};this.tabla_falra=function(e,t){var n=40;var r=20;if(typeof e.textura==="undefined"){var i="assets/textures/tabla_falra/alap_tabla.jpg"}else{var i="assets/textures/"+e.textura;if(typeof e.meret_x!=="undefined"){n=e.meret_x}if(typeof e.meret_y!=="undefined"){r=e.meret_y}}var s=THREE.ImageUtils.loadTexture(i);var o=new THREE.MeshPhongMaterial({map:s});o.transparent=1;var u=new THREE.PlaneGeometry(n,r,1,1);var a=new THREE.Mesh(u,o);if(e.melyik_oldalon=="DEL"){a.position.set(t.x,t.y,t.z+51)}if(e.melyik_oldalon=="ESZAK"){a.position.set(t.x,t.y,t.z-51);a.rotation.y=rad(180)}if(e.melyik_oldalon=="KELET"){a.position.set(t.x+51,t.y,t.z);a.rotation.y=rad(90)}if(e.melyik_oldalon=="NYUGAT"){a.position.set(t.x-51,t.y,t.z);a.rotation.y=rad(270)}scene.add(a);a.on("click",function(){console.log("click");var t=a.position.distanceTo(MovingCube.position);if(t>200){return}hang_lejatszas(33,{pan:0,volume:90});info_szoveg(e.szoveg)})};this.createKulcslyukAktiv=function(e,t,n){var r=this;var i=new THREE.JSONLoader;i.load("assets/models/female_head/head.js",function(i){var s=new THREE.ImageUtils.loadTexture("assets/models/Bone2-conde-nasenbein.png");var o=new THREE.MeshPhongMaterial({map:s});var u=new THREE.Mesh(i,o);u.scale.x=3;u.scale.y=3;u.scale.z=3;if(n.melyik_oldalon=="DEL"){u.position.set(e.x,-10,e.z+47)}if(n.melyik_oldalon=="ESZAK"){u.position.set(e.x,-10,e.z-47);u.rotation.y=rad(180)}if(n.melyik_oldalon=="KELET"){u.position.set(e.x+47,-10,e.z);u.rotation.y=rad(90)}if(n.melyik_oldalon=="NYUGAT"){u.position.set(e.x-47,-10,e.z);u.rotation.y=rad(270)}scene.add(u);u.on("click",function(){var e=u.position.distanceTo(MovingCube.position);if(e>200){return}if(n.kinyitva=="NEM"){hang_lejatszas(42,{pan:0,volume:70});var i=prompt("The head says: Tell me the password and I will open the door for you.");mozgas_logolas("FEJRE KATTINT valasz:"+i);var s=false;if(i.toLowerCase()==n.mi_a_jelszo.toLowerCase()){s=true}if(s){u.off("click");terkep.zart_ajto_kinyitva(n.ajto_id,n.id);info_szoveg("Correct password, door opened.");r.toogleDoor2(t)}else{info_szoveg("Wrong password.")}}else{info_szoveg("You already unlocked this door.")}})})};this.createKulcslyuk=function(e,t,n){if(typeof n.textura==="undefined"){var r=THREE.ImageUtils.loadTexture("assets/textures/keyhole2.png");var i={x:10,y:10,z:100}}else{var r=THREE.ImageUtils.loadTexture("assets/textures/"+n.textura);var i={x:6,y:6,z:100}}var s=new THREE.MeshPhongMaterial({map:r});s.transparent=1;var o=new THREE.PlaneGeometry(i.x,i.y,1,1);var u=new THREE.Mesh(o,s);if(n.melyik_oldalon=="DEL"){u.position.set(e.x,e.y-15,e.z+51)}if(n.melyik_oldalon=="ESZAK"){u.position.set(e.x,e.y-15,e.z-51);u.rotation.y=rad(180)}if(n.melyik_oldalon=="KELET"){u.position.set(e.x+41,e.y-15,e.z);u.rotation.y=rad(90)}if(n.melyik_oldalon=="NYUGAT"){u.position.set(e.x-51,e.y-15,e.z);u.rotation.y=rad(270)}var a=this;u.on("click",function(){var e=u.position.distanceTo(MovingCube.position);if(e>200){return}if(n.kinyitva=="NEM"){var r=van_e_megfelelo_targy_a_nyitashoz(n.melyik_item_id_kell_a_nyitashoz);var i=targyak.targy_generalas(n.melyik_item_id_kell_a_nyitashoz);var s=targyak.targyadatok(i);mozgas_logolas("KULCSLYKRA KATTINT vanemeglelelo:"+r);if(r){u.off("click");terkep.zart_ajto_kinyitva(n.ajto_id,n.id);info_szoveg(s.targy_neve+" used to open the door");a.toogleDoor2(t)}else{info_szoveg("You need a "+s.targy_neve+"  to open the door.")}}else{info_szoveg("You already unlocked this.")}});return u};this.createTitkosKapcsolo=function(e,t,n){var r={x:5,y:5};var i=THREE.ImageUtils.loadTexture("assets/textures/titkos_gomb2.png");var s=THREE.ImageUtils.loadTexture("assets/textures/titkos_gomb_be.png");var o=new THREE.MeshPhongMaterial({map:i});var u=new THREE.PlaneGeometry(r.x,r.y,1,1);var a=new THREE.Mesh(u,o);if(n.melyik_oldalon=="DEL"){a.position.set(e.x,e.y-17.3,e.z+51)}if(n.melyik_oldalon=="ESZAK"){a.position.set(e.x-15.6,e.y-14,e.z-51);a.rotation.y=rad(180)}if(n.melyik_oldalon=="KELET"){a.position.set(e.x+51,e.y-17.3,e.z);a.rotation.y=rad(90)}if(n.melyik_oldalon=="NYUGAT"){a.position.set(e.x-51,e.y-17.3,e.z);a.rotation.y=rad(270)}scene.add(a);var f=this;if(n.kinyitva=="NEM"){a.on("click",function(){var e=a.position.distanceTo(MovingCube.position);if(e>200){return}mozgas_logolas("TITKOST KINYIT id:"+n.id);info_szoveg("A secret door is moving somewhere.");o.map=s;terkep.titkos_ajto_kinyitva(n.ajto_id,n.id);if(f.ajto_eppen_mozog==0){hang_lejatszas(39,{pan:0,volume:70});f.ajto_eppen_mozog=1;a.off("click");doorInterval=setInterval(function(){t.position.y+=1;if(t.position.y>=100){f.ajto_eppen_mozog=0;clearInterval(doorInterval)}},3)}})}else{o.map=s}};this.createWallSwitch=function(e,t,n){var r={x:5,y:5,z:100};var i=THREE.ImageUtils.loadTexture("assets/textures/gomb3.png");var s=THREE.ImageUtils.loadTexture("assets/textures/gomb3_be.png");var o=new THREE.MeshPhongMaterial({map:i});o.transparent=1;var u=new THREE.PlaneGeometry(r.x,r.y,1,1);var a=new THREE.Mesh(u,o);if(n.melyik_oldalon=="DEL"){a.position.set(e.x,e.y,e.z+51)}if(n.melyik_oldalon=="ESZAK"){a.position.set(e.x,e.y,e.z-51);a.rotation.y=rad(180)}if(n.melyik_oldalon=="KELET"){a.position.set(e.x+51,e.y,e.z);a.rotation.y=rad(90)}if(n.melyik_oldalon=="NYUGAT"){a.position.set(e.x-51,e.y,e.z);a.rotation.y=rad(270)}scene.add(a);var f=this;if(n.kinyitva=="NEM"){a.on("click",function(){var e=a.position.distanceTo(MovingCube.position);if(e>200){return}mozgas_logolas("AJTOKAPCSOLORA KATT ID:"+n.id);if(o.map==i){o.map=s}else{o.map=i}terkep.zart_ajto_kinyitva(n.ajto_id,n.id);a.off("click");info_szoveg("A door is moving somewhere.");if(typeof n.kapcsolodo_esemeny!=="undefined"){if(n.kapcsolodo_esemeny=="hang_lejatszas"){hang_lejatszas(n.hang_id,{pan:0,volume:20,multiShot:false})}if(n.kapcsolodo_esemeny=="ellenseg_megjelenik"){var r={ellenseg_tipusa:n.ellenseg_tipusa,id:n.ellenseg_id};var u={x:n.ellenseg_x*cubesize,y:0,z:n.ellenseg_y*cubesize};var l=new Enemy(r,u);l.create()}}f.toogleDoor2(t)})}else{o.map=s}};this.toogleDoor2=function(e){if(this.ajto_eppen_mozog==0){hang_lejatszas(10,{pan:75,volume:50});var t=this;this.ajto_eppen_mozog=1;if(e.position.y==100){doorInterval=setInterval(function(){e.position.y-=1;if(e.position.y<=0){t.ajto_eppen_mozog=0;clearInterval(doorInterval)}},1)}else{doorInterval=setInterval(function(){e.position.y+=1;if(e.position.y>=100){t.ajto_eppen_mozog=0;clearInterval(doorInterval)}},1)}}};this.lepcso_le=function(e,t){var n=e.x*100;var r=e.y*100;var i="assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA;var s="assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA;var o=new THREE.ImageUtils.loadTexture(i);o.wrapS=THREE.RepeatWrapping;o.wrapT=THREE.RepeatWrapping;if(e.melyik_oldalon=="ESZAK"){var u={x:cubesize,y:20,z:20};var a=-cubesize;var f=cubesize;var l=0;var c=0;o.repeat.x=1;o.repeat.y=.5}if(e.melyik_oldalon=="DEL"){var u={x:cubesize,y:20,z:20};var a=cubesize;var f=-cubesize;var l=0;var c=0;o.repeat.x=1;o.repeat.y=.5}if(e.melyik_oldalon=="KELET"){var u={x:20,y:20,z:cubesize};var a=0;var f=0;var l=cubesize;var c=-cubesize;o.repeat.x=.5;o.repeat.y=1}if(e.melyik_oldalon=="NYUGAT"){var u={x:20,y:20,z:cubesize};var a=0;var f=0;var l=-cubesize;var c=cubesize;o.repeat.x=.5;o.repeat.y=1}var h=new THREE.MeshPhongMaterial({map:o});var p=new THREE.CubeGeometry(u.x,u.y,u.z,1,1,1);var d=-50;for(var v=-50;v>=-120;v=v-10){var m=new THREE.Mesh(p,h);if(e.melyik_oldalon=="ESZAK"){m.position.set(n,v,r+d*-1)}if(e.melyik_oldalon=="DEL"){m.position.set(n,v,r+d)}if(e.melyik_oldalon=="KELET"){m.position.set(n+d,v,r)}if(e.melyik_oldalon=="NYUGAT"){m.position.set(n+d*-1,v,r)}scene.add(m);d=d+20}var o=textura_konytarbol(s,new THREE.Vector2(1,1));var h=new THREE.MeshPhongMaterial({map:o});var p=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var m=new THREE.Mesh(p,h);m.position.set(n,cubesize_y,r);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+l,cubesize_y,r+a);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f,0,r+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a,0,r+c);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f+l,0,r+a+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a+l,0,r+a+c);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f,-cubesize_y,r+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a,-cubesize_y,r+c);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f+l,-cubesize_y,r+a+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a+l,-cubesize_y,r+a+c);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f+l,-cubesize_y*2,r+a+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a+l,-cubesize_y*2,r+a+c);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+l*2,0,r+a*2);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+l*2,-cubesize_y*2-30,r+a*2);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+l*3,-cubesize_y*2-30,r+a*3);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+a+l*2,-cubesize_y-30,r+a*2+l);scene.add(m);var m=new THREE.Mesh(p,h);m.position.set(n+f+l*2,-cubesize_y-30,r+a*2+c);scene.add(m);var p=new THREE.CubeGeometry(cubesize,cubesize_y-40,cubesize,1,1,1);var m=new THREE.Mesh(p,h);m.position.set(n+l*2,-cubesize_y+20,r+a*2);scene.add(m)};this.lepcso_fel=function(e,t){var n=new THREE.Geometry;var r=e.x*100;var i=e.y*100;var s="assets/textures/"+terkep.meta.ALAP_PADLO_TEXTURA;var o="assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA;var u=new THREE.ImageUtils.loadTexture(s);u.wrapS=THREE.RepeatWrapping;u.wrapT=THREE.RepeatWrapping;if(e.melyik_oldalon=="ESZAK"){var a={x:cubesize,y:20,z:20};var f=-cubesize;var l=cubesize;var c=0;var h=0;u.repeat.x=1;u.repeat.y=.2}if(e.melyik_oldalon=="DEL"){var a={x:cubesize,y:20,z:20};var f=cubesize;var l=-cubesize;var c=0;var h=0;u.repeat.x=1;u.repeat.y=.5}if(e.melyik_oldalon=="KELET"){var a={x:20,y:20,z:cubesize};var f=0;var l=0;var c=cubesize;var h=-cubesize;u.repeat.x=.5;u.repeat.y=1}if(e.melyik_oldalon=="NYUGAT"){var a={x:20,y:20,z:cubesize};var f=0;var l=0;var c=-cubesize;var h=cubesize;u.repeat.x=.5;u.repeat.y=1}var p=new THREE.MeshPhongMaterial({map:u});var d=new THREE.CubeGeometry(a.x,a.y,a.z,1,1,1);var v=-50;for(var m=-40;m<=20;m=m+6){var g=new THREE.Mesh(d,p);if(e.melyik_oldalon=="ESZAK"){g.position.set(r,m,i+v*-1)}if(e.melyik_oldalon=="DEL"){g.position.set(r,m,i+v)}if(e.melyik_oldalon=="KELET"){g.position.set(r+v,m,i)}if(e.melyik_oldalon=="NYUGAT"){g.position.set(r+v*-1,m,i)}THREE.GeometryUtils.merge(n,g);v=v+20}var g=new THREE.Mesh(n,p);scene.add(g);var n=new THREE.Geometry;var y=textura_konytarbol(o,new THREE.Vector2(1,1));var p=new THREE.MeshPhongMaterial({map:y});var d=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var g=new THREE.Mesh(d,p);g.position.set(r,cubesize_y*2,i);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+c,cubesize_y*2,i+f);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+l,0,i+c);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+l,cubesize_y,i+c);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+f,0,i+h);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+f,cubesize_y,i+h);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+l+c,0,i+f+c);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+f+c,0,i+f+h);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+l,-cubesize_y,i+c);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+f,-cubesize_y,i+h);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+l+c,cubesize_y,i+f+c);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(d,p);g.position.set(r+f+c,cubesize_y,i+f+h);THREE.GeometryUtils.merge(n,g);var g=new THREE.Mesh(n,p);scene.add(g);return};this.utjelzo_tabla_a_foldre=function(e,t){var n=getTextureFromCache("assets/images/sign2.png");var r=new THREE.MeshBasicMaterial({map:n,transparent:true});var i=new THREE.Mesh(new THREE.PlaneGeometry(30,30,1,1),r);i.position.set(t.x,t.y-28,t.z-40);i.rotation=MovingCube.rotation;scene.add(i);i.on("click",function(){var t=i.position.distanceTo(MovingCube.position);if(t>200){return}mozgas_logolas("UTJELZO TABLARA KATT ID:"+e);hang_lejatszas(33,{pan:0,volume:90});info_szoveg(e)})};this.feltamasztas=function(e,t){var n=new THREE.JSONLoader;n.load("assets/models/knight_statue.js",function(n){var r=new THREE.MeshPhongMaterial({ambient:197379,color:1118481,specular:16755200,shininess:10});var i=new THREE.Mesh(n,r);if(e.merre_nez=="DEL"){}if(e.merre_nez=="ESZAK"){i.rotation.y=rad(180)}if(e.merre_nez=="KELET"){i.rotation.y=rad(90)}if(e.merre_nez=="NYUGAT"){i.rotation.y=rad(270)}i.position.set(t.x,-40,t.z);i.scale.x=21;i.scale.y=21;i.scale.z=21;scene.add(i);i.on("click",function(){var t=i.position.distanceTo(MovingCube.position);if(t>110){return}console.log(e.hanyszor_hasznalta);if(e.hanyszor_hasznalta==0){terkep.feltamasztas(e.id);info_szoveg("Resurrection statue used.");for(var n=0;n<karakterek.length;n++){karakterek[n].feltamasztas();karakterek[n].manat_kap(karakterek[n].max_mana)}}else{info_szoveg("You already used this resurrection statue.")}})})};this.laba_foldre=function(e,t){if(e.kinyitva=="NEM"){var n=getGeomertyFromCache("assets/models/treasurechestidle.js");var r=new THREE.ImageUtils.loadTexture("assets/models/SawBlade1.jpg");var i=new THREE.MeshPhongMaterial({morphTargets:true,map:r});var s=new THREE.MorphAnimMesh(n.geometry,i);s.position.set(t.x,-38,t.z);s.scale.x=5.6;s.scale.y=5.6;s.scale.z=5.6;s.rotation=MovingCube.rotation;s.duration=4e3;s.setFrameRange(0,1);morphs.push(s);scene.add(s);var o=new Array;for(var u=0;u<e.targy_idk.length;u++){var a=targyak.targy_generalas(e.targy_idk[u]);o.push(a)}s.on("click",function(){var t=s.position.distanceTo(MovingCube.position);if(t>200){return}mozgas_logolas("LADAT KINYIT id:"+e.id);terkep.lada_kinyitva(e.id);lada_kinyitas(s,o)})}};this.faklya=function(e,t){var n=getTextureFromCache("assets/textures/particles/sajatfire1.png");var r=new TextureAnimator(n,5,6,12,80,1);skill_animaciok.push(r);var i=new THREE.PlaneGeometry(15,15,1,1);var s=new THREE.MeshBasicMaterial({map:n,fog:false});s.transparent=true;var o=new THREE.Mesh(i,s);o.rotation=MovingCube.rotation;scene.add(o);if(e.melyik_oldalon=="DEL"){o.position.set(t.x,3.6,t.z+43.2)}if(e.melyik_oldalon=="ESZAK"){o.position.set(t.x,3.6,t.z-43.2)}if(e.melyik_oldalon=="KELET"){o.position.set(t.x+43.2,3.6,t.z)}if(e.melyik_oldalon=="NYUGAT"){o.position.set(t.x-43.2,3.6,t.z)}t.y=5;var u=new THREE.PointLight(16755578,2.2,190);if(e.melyik_oldalon=="DEL"){u.position.set(t.x,t.y,t.z+43)}if(e.melyik_oldalon=="ESZAK"){u.position.set(t.x,t.y,t.z-43)}if(e.melyik_oldalon=="KELET"){u.position.set(t.x+43,t.y,t.z)}if(e.melyik_oldalon=="NYUGAT"){u.position.set(t.x-43,t.y,t.z)}psys_tomb_fenyek.push(u);var a=3;setInterval(function(){var e=randint(-a,a);u.position.z+=e;if(u.position.z>t.z+a){u.position.z=t.z}if(u.position.z<t.z-a){u.position.z=t.z}var e=randint(-a,a);u.position.y+=e;if(u.position.y>t.y+a){u.position.y=t.y}if(u.position.y<t.y-a){u.position.y=t.y}},70);var f=getGeomertyFromCache("assets/models/torch/torch.js");var l=new THREE.ImageUtils.loadTexture("assets/models/torch/untitled.jpg");var c=new THREE.MeshPhongMaterial({map:l});var h=new THREE.Mesh(f.geometry,c);h.scale.x=1.5;h.scale.y=1.5;h.scale.z=1.5;scene.add(h);if(e.melyik_oldalon=="DEL"){h.position.set(t.x,-9,t.z+46);h.rotation.y=rad(180)}if(e.melyik_oldalon=="ESZAK"){h.position.set(t.x,-9,t.z-46);h.rotation.y=rad(0)}if(e.melyik_oldalon=="KELET"){h.position.set(t.x+46,-9,t.z);h.rotation.y=rad(270)}if(e.melyik_oldalon=="NYUGAT"){h.position.set(t.x-46,-9,t.z);h.rotation.y=rad(90)}};this.teleport=function(e,t){var n=getGeomertyFromCache("assets/models/teleport/teleporter3.js");var r=new THREE.Mesh(n.geometry,new THREE.MeshFaceMaterial(n.materials));r.position.set(t.x,t.y-38,t.z);r.scale.x=22;r.scale.y=22;r.scale.z=22;scene.add(r);var s=new THREE.Geometry;var o=THREE.ImageUtils.loadTexture("assets/images/particle.png");var u=[];for(i=0;i<250;i++){var a=new THREE.Vector3;a.x=randint(-10,10);a.y=randint(-30,20);a.z=randint(-10,10);s.vertices.push(a);u[i]=new THREE.Color(16711680);var f=randint(1,10)}s.colors=u;s.dynamic=false;s.verticesNeedUpdate=false;var l=new THREE.ParticleBasicMaterial({size:13,transparent:true,map:o,sizeAttenuation:false,vertexColors:true,blending:THREE.AdditiveBlending});var c=new THREE.ParticleSystem(s,l);c.position.set(t.x,-5,t.z);c.sortParticles=true;scene.add(c);var h=setInterval(function(){c.rotation.y+=.1},50)};this.targy_a_foldre=function(e,t){var n=targyak.targy_generalas(e.targy_id);var r=targyak.targyadatok(n);var i=new THREE.ImageUtils.loadTexture("assets/items/"+r.kep_fajl);var s=new THREE.MeshBasicMaterial({map:i,transparent:true});var o=new THREE.Mesh(new THREE.PlaneGeometry(6,6,1,1),s);o.position.set(t.x,t.y-35,t.z);o.rotation=MovingCube.rotation;scene.add(o);o.on("click",function(){var t=o.position.distanceTo(MovingCube.position);if(t>200){return}mozgas_logolas("TARGYAT FOLDROL targy_id:"+e.targy_id);var r=foldrol_targy_felvetele(n);if(r){o.off("click");scene.remove(o);terkep.targy_felveve(e.id)}})};this.createDoorTitkos=function(e,t,n,r,i){if(terkep.meta.ALAP_FAL_TEXTURA_NORMAL!=""&&terkep.meta.ALAP_FAL_TEXTURA_SPECULAR!=""){toltes_jelzo_bekapcsol();var s=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA_NORMAL,undefined,toltes_jelzo_kikapcsol);s.anisotropy=anisotropy;toltes_jelzo_bekapcsol();var o=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA_SPECULAR,undefined,toltes_jelzo_kikapcsol);o.anisotropy=anisotropy;toltes_jelzo_bekapcsol();var u=new THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA,undefined,toltes_jelzo_kikapcsol);u.anisotropy=anisotropy;var a=new THREE.Vector2(1,1);var f=new THREE.MeshPhongMaterial({map:u,normalMap:s,normalScale:a,specularMap:o,specular:16755578,shininess:180})}else{toltes_jelzo_bekapcsol();var s=THREE.ImageUtils.loadTexture("assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA,undefined,toltes_jelzo_kikapcsol);s.anisotropy=anisotropy;s=this.repeatTexture(s,repeat);s.wrapS=THREE.RepeatWrapping;s.wrapT=THREE.RepeatWrapping;var f=new THREE.MeshPhongMaterial({map:s})}var l=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var c=new THREE.Mesh(l,f);c.position.set(t.x,t.y,t.z);scene.add(c);collidableMeshList.push(c);if(i.kinyitva=="IGEN"){c.position.y=100}return c;var h=this};this.createDoor=function(e,t,n,r,i){var s="x";if(typeof i.tengely!=="undefined"){s=i.tengely}var o={x:0,y:0,z:0};if(s=="x"){o.y=rad(90)}var u=textura_konytarbol("assets/textures/"+terkep.meta.ALAP_FAL_TEXTURA,new THREE.Vector2(1,1));u.repeat.x=.2;var a=new THREE.CubeGeometry(20,cubesize_y,20,1,1,1);var f=new THREE.MeshPhongMaterial({map:u});var l=new THREE.Mesh(a,f);if(s=="x"){l.position.set(t.x,t.y,t.z-40)}else{l.position.set(t.x-40,t.y,t.z)}scene.add(l);var a=new THREE.CubeGeometry(20,cubesize_y,20,1,1,1);var f=new THREE.MeshPhongMaterial({map:u});var l=new THREE.Mesh(a,f);if(s=="x"){l.position.set(t.x,t.y,t.z+40)}else{l.position.set(t.x+40,t.y,t.z)}scene.add(l);var u=THREE.ImageUtils.loadTexture(e);var c=this.createCube(new THREE.MeshPhongMaterial({map:u}),t,n,{x:1,y:1,z:1},o);collidableMeshList.push(c);if(r=="AJTO2"){if(typeof i.kinyitva!=="undefined"){if(i.kinyitva=="IGEN"){c.position.y=100}}c.on("click",function(){var e=c.position.distanceTo(MovingCube.position);if(e>200){return}hang_lejatszas(38,{pan:0,volume:40});info_szoveg("The door is Locked.")})}var h=this;if(r=="AJTO1"){if(typeof i.kinyitva!=="undefined"){if(i.kinyitva=="IGEN"){c.position.y=100}}c.on("click",function(){var e=c.position.distanceTo(MovingCube.position);if(e>200){return}mozgas_logolas("AJTORA KATTINT ID:"+i.id);if(typeof i.kapcsolodo_esemeny!=="undefined"){if(i.kapcsolodo_esemeny=="hang_lejatszas"){hang_lejatszas(i.hang_id,{pan:0,volume:20,multiShot:false})}if(i.kapcsolodo_esemeny=="ellenseg_megjelenik"){var t={ellenseg_tipusa:i.ellenseg_tipusa,id:i.ellenseg_id};var n={x:i.ellenseg_x*cubesize,y:0,z:i.ellenseg_y*cubesize};var r=new Enemy(t,n);r.create()}}terkep.sima_ajto_kinyitva(i.id);h.toogleDoor2(c)})}return c};this.repeatTexture=function(e,t){e.wrapS=THREE.RepeatWrapping;e.wrapT=THREE.RepeatWrapping;e.repeat.x=t.x;e.repeat.y=t.y;return e}}function Enemy(e,t){this.tipus=e.ellenseg_tipusa;this.id=0;this.nev="";this.egyeb_infok="";this.terkep_kieg_id=e.id;this.hp=100;this.max_hp=100;this.xp=10;this.animacio_sebessege=2e3;this.animaciok=null;this.model_texturak=new Array;this.tamadasi_sebesseg=3e3;this.hany_sort_tud_tamadni=1;this.statok={power:4,dexterity:10,defense:10,vitality:10,szint:1};this.eppen_tamad=false;this.eppen_meghal=false;this.mit_dobott=null;this.ledobott_targy_o3d=null;this.ledobott_targy_id=null;this.mennyi_penzt_dobott=0;this.dotok=[];this.debuffok=[];this.hangok_serul=[72,73,74];this.hangok_meghal=[13];this.kategoria_eselyek=new Array(75,50,30,10);this.targyak_basic=new Array(1,2,3);this.targyak_fine=new Array(4,5,6);this.targyak_masterwork=new Array(7,8,9);this.targyak_rare=new Array(10,11,12);this.penz=100;this.pozicio=t;this.kezdo_pozicio=t;this.max_elmozgas=500;this.latja_a_jatekost=false;this.koveti_a_jatekost=false;this.hol_jar_a_pathfindingben=1;this.mesh=false;this.meshAnim=false;this.eppen_mozog=0;this.movement={dx:0,dz:0};this.path;this.Tx=false;this.Ty=false;this.Tx_jatekos=false;this.Ty_jatekos=false;this.merre_nez=0;this.mennyit_sebez=function(){var e=0;var t=this.statok.power;for(var n=0;n<this.debuffok.length;n++){if(typeof this.debuffok[n].parameterek.enemy_power!=="undefined"){t=t-t*this.debuffok[n].parameterek.enemy_power}}e=t*4;for(var n=0;n<this.debuffok.length;n++){if(typeof this.debuffok[n].parameterek.enemy_damage!=="undefined"){e=e-e*this.debuffok[n].parameterek.enemy_damage}}return e};this.drop_kivalasztasa=function(){var e=0;var t=0;for(i=0;i<this.kategoria_eselyek.length;i++){t+=this.kategoria_eselyek[i]}var n=randint(0,t-1);var r=0;for(i=0;i<this.kategoria_eselyek.length;i++){r+=this.kategoria_eselyek[i];if(r>n){break}}var s=0;if(i==0){s=this.targyak_basic.length}if(i==1){s=this.targyak_fine.length}if(i==2){s=this.targyak_masterwork.length}if(i==3){s=this.targyak_rare.length}var n=randint(0,s-1);if(i==0){return this.targyak_basic[n]}if(i==1){return this.targyak_fine[n]}if(i==2){return this.targyak_masterwork[n]}if(i==3){return this.targyak_rare[n]}};this.drop_a_foldre=function(e){this.ledobott_targy_id=e;var t=this;var n=new THREE.JSONLoader;n.load("assets/models/bagofmarbles/bagofmarbles.js",function(e){var n=new THREE.ImageUtils.loadTexture("assets/models/bagofmarbles/textil1.png");var r=new THREE.MeshPhongMaterial({map:n});r.transparent=false;var i=new THREE.Mesh(e,r);var s=randint(-30,30);var o=randint(-30,30);i.position.set(t.mesh.position.x+s,-40,t.mesh.position.z+o);i.scale.x=3;i.scale.y=3;i.scale.z=3;scene.add(i);hang_lejatszas(5,{pan:0,volume:70});t.ledobott_targy_o3d=i;var u=i.on("mouseover",function(e){t.ledobott_targy_o3d.material.emissive.setHex(16711680)});var a=i.on("mouseout",function(e){if(t.ledobott_targy_o3d!=null){t.ledobott_targy_o3d.material.emissive.setHex(0)}});var f=i.on("click",function(e){t.ledobott_targy_o3d.off("mouseover");t.ledobott_targy_o3d.off("mouseout");t.ledobott_targy_o3d.off("click");t.drop_felveve(t.ledobott_targy_id,t.ledobott_targy_o3d)})})};this.drop_felveve=function(e,t){var n=false;for(var r=0;r<karakterek.length;r++){var i=karakterek[r];if(i.loot_taskaba(e)){n=i;if(this.mennyi_penzt_dobott>0){i.penz_taskaba(this.mennyi_penzt_dobott)}break}}if(n===false){info_szoveg("Not enough space in inventory!")}else{scene.remove(t);t.material.map.dispose();t.material.dispose();t.geometry.dispose();var s=targyak.targyadatok(e);info_szoveg(n.nev+' got a <span class="item_chatben" title="'+s.targy_leirasa+'" style="color:#'+s.kategoria_szine+'">'+s.targy_neve+"</span>");$(".item_chatben").qtip(tooltip_options);if(this.mennyi_penzt_dobott>0){info_szoveg("Your party got "+this.mennyi_penzt_dobott+" gold.")}hang_lejatszas(32,{pan:0,volume:70});this.ledobott_targy_o3d=null;this.ledobott_targy_id=null}};this.create_altalanos=function(e,t,n){var r=this;var i=getGeomertyFromCache(e);for(var s=0;s<i.materials.length;s++){i.materials[s].morphTargets=true;if(typeof r.model_texturak[s]!=="undefined"){var o=new THREE.ImageUtils.loadTexture(r.model_texturak[s]);i.materials[s].map=o}}var u=new THREE.MorphAnimMesh(i.geometry,new THREE.MeshFaceMaterial(i.materials));u.position.set(0,t,0);u.scale.x=n;u.scale.y=n;u.scale.z=n;u.setAnimationLabel("jar",r.animaciok.jar.eleje,r.animaciok.jar.vege);u.setAnimationLabel("tamad",r.animaciok.tamad.eleje,r.animaciok.tamad.vege);u.setAnimationLabel("all",r.animaciok.all.eleje,r.animaciok.all.vege);u.setAnimationLabel("serul",r.animaciok.serul.eleje,r.animaciok.serul.vege);u.setAnimationLabel("meghal",r.animaciok.meghal.eleje,r.animaciok.meghal.vege);u.playAnimation("jar",r.animaciok.jar.fps);var a=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var f=new THREE.Mesh(a);f.visible=false;var l=new THREE.Object3D;l.add(f);l.add(u);scene.add(l);l.position.set(r.pozicio.x,r.pozicio.y,r.pozicio.z);collidableMeshList.push(l);scene.add(l);morphs.push(u);r.mesh=l;r.meshAnim=u;r.id=l.id;ellensegek.push(r)};this.create=function(){var e=this;var t=(new Date).getTime();if(this.tipus=="antlion"){this.statok={power:8,dexterity:10,defense:50,vitality:10,szint:1};this.max_hp=this.hp=700;this.tamadasi_sebesseg=2500;this.nev="Fire ant";this.egyeb_infok="High resistance to fire";this.hangok_serul=[75,76,77];this.targyak_basic=new Array(1,2,3,130,150,170,190,210,230,250,270,290,310,330,350,370,390,410,430,450,470);this.targyak_fine=new Array(4,5,6,2005,2006,2008,2009,1001,1002,1003);this.targyak_masterwork=new Array(7,8,9,2015,2016,2017,2018);this.targyak_rare=new Array(10,11,12,2025,2026,2027);this.animaciok={jar:{eleje:5,vege:11,fps:4},tamad:{eleje:13,vege:16,fps:2.5},all:{eleje:1,vege:4,fps:.5},serul:{eleje:17,vege:18,fps:2},meghal:{eleje:19,vege:31,fps:2}};this.model_texturak=new Array("assets/models/antlion/fire.jpg","assets/models/antlion/fire.jpg");this.create_altalanos("assets/models/antlion/antlion.js",-30,21)}if(this.tipus=="spider"){this.statok={power:5,dexterity:10,defense:60,vitality:10,szint:1};this.max_hp=this.hp=400;this.tamadasi_sebesseg=3e3;this.nev="Spider";this.hangok_serul=[78,79,80];this.targyak_basic=new Array(1,2,3,130,150,170,190,210,230,250,270,290,310,330,350,370,390,410,430,450,470);this.targyak_fine=new Array(4,5,6,2005,2006,2008,2009,1001,1002,1003);this.targyak_masterwork=new Array(7,8,9,2015,2016,2017,2018);this.targyak_rare=new Array(10,11,12,2025,2026,2027);this.animaciok={jar:{eleje:5,vege:12,fps:3.9},tamad:{eleje:13,vege:16,fps:2},all:{eleje:1,vege:4,fps:1},serul:{eleje:18,vege:20,fps:2.1},meghal:{eleje:18,vege:24,fps:1.6}};this.model_texturak=new Array;this.create_altalanos("assets/models/spider/spider_flare.js",-36,35)}if(this.tipus=="skeleton"){this.statok={power:7,dexterity:10,defense:55,vitality:10,szint:1};this.max_hp=this.hp=500;this.xp=10;this.tamadasi_sebesseg=4e3;this.nev="Skeleton";this.egyeb_infok="Slow but hits hard";this.hangok_serul=[72,73,74];this.targyak_basic=new Array(8e3,1,2,3,130,150,170,190,210,230,250,270,290,310,330,350,370,390,410,430,450,470);this.targyak_fine=new Array(4,5,6,2005,2006,2008,2009,1001,1002,1003);this.targyak_masterwork=new Array(7,8,9,2015,2016,2017,2018);this.targyak_rare=new Array(10,11,12,2025,2026,2027);this.animaciok={jar:{eleje:4,vege:11,fps:4},tamad:{eleje:12,vege:15,fps:3},all:{eleje:1,vege:3,fps:.5},serul:{eleje:22,vege:23,fps:1},meghal:{eleje:23,vege:27,fps:1}};this.model_texturak=new Array;this.create_altalanos("assets/models/skeleton/skeleton_texturaval.js",-38,21)}};this.detectCollision=function(e){var t=false;var n=this.mesh.clone();n.position.x+=e.dx;n.position.z+=e.dz;for(var r in collidableMeshList){if(n.position.distanceTo(collidableMeshList[r].position)<=99){t=true}}return t};this.jatekos_kovetes=function(){var e=Math.abs(Math.floor(this.mesh.position.x/cubesize));var t=Math.abs(Math.floor(this.mesh.position.z/cubesize));var n=Math.abs(Math.floor(MovingCube.position.x/cubesize));var r=Math.abs(Math.floor(MovingCube.position.z/cubesize));if(this.Tx_jatekos!=n||this.Ty_jatekos!=r){this.koveti_a_jatekost=true;this.hol_jar_a_pathfindingben=1;this.Tx_jatekos=n;this.Ty_jatekos=r;var i=new PF.Grid(terkep.terkep_szelesseg,terkep.terkep_magassag,terkep.getTerkepMatrix());var s=new PF.AStarFinder;this.path=s.findPath(e,t,n,r,i);for(k=0;k<this.path.length;k++){}if(this.path.length==0){this.koveti_a_jatekost=false;return}if(this.path.length<=2){this.koveti_a_jatekost=false;return}var o=this.path[this.hol_jar_a_pathfindingben]}if(this.path.length>0){var o=this.path[this.hol_jar_a_pathfindingben];if(e<o[0]){this.movement.dx+=cubesize;this.mesh.rotation.y=rad(90)}if(e>o[0]){this.movement.dx-=cubesize;this.mesh.rotation.y=rad(270)}if(this.movement.dx==0){if(t<o[1]){this.movement.dz+=cubesize;this.mesh.rotation.y=rad(0)}if(t>o[1]){this.movement.dz-=cubesize;this.mesh.rotation.y=rad(180)}}this.mozgas()}};this.mozgas=function(){if(!this.detectCollision(this.movement)){this.meshAnim.position.z=0;if(this.meshAnim&&this.animaciok){this.meshAnim.playAnimation("jar",this.animaciok.jar.fps)}this.eppen_mozog=1;this.aaa=0;var e=this;this.goEnemy=setInterval(function(){e.aaa++;if(e.movement.dx==cubesize){e.mesh.position.x+=1}if(e.movement.dx==-cubesize){e.mesh.position.x-=1}if(e.movement.dz==cubesize){e.mesh.position.z+=1}if(e.movement.dz==-cubesize){e.mesh.position.z-=1}if(e.aaa>=100){e.eppen_mozog=0;if(e.koveti_a_jatekost){e.hol_jar_a_pathfindingben+=1;if(e.hol_jar_a_pathfindingben<e.path.length-1){}else{e.koveti_a_jatekost=false;e.hol_jar_a_pathfindingben=1}}clearInterval(e.goEnemy)}},10)}else{}};this.tamadas=function(){if(this.meshAnim.currentKeyframe==this.animaciok.tamad.vege||this.meshAnim.currentKeyframe==this.animaciok.jar.vege||this.meshAnim.currentKeyframe==this.animaciok.serul.vege){this.meshAnim.playAnimation("all",this.animaciok.all.fps)}if(this.eppen_tamad===false&&this.hp>0){this.eppen_tamad=true;this.meshAnim.position.z=30;this.meshAnim.playAnimation("tamad",this.animaciok.tamad.fps);hang_lejatszas(6,{pan:0,volume:50});utes_3do.position.set(this.mesh.position.x,this.mesh.position.y,this.mesh.position.z);utes_3do.visible=true;var e=setInterval(function(){utes_3do.visible=false;clearInterval(e)},100);var t=this.mennyit_sebez();var n=new Array;for(i=0;i<karakterek.length;++i){var r=karakterek[i];if(r.hanyadik_sorban_van<=this.hany_sort_tud_tamadni&&r.hp>0){n.push(r)}}if(n.length==0){for(i=0;i<karakterek.length;++i){var r=karakterek[i];if(r.hanyadik_sorban_van<=this.hany_sort_tud_tamadni+1&&r.hp>0){n.push(r)}}}if(n.length==0){for(i=0;i<karakterek.length;++i){var r=karakterek[i];if(r.hanyadik_sorban_van<=this.hany_sort_tud_tamadni+1&&r.hp>0){n.push(r)}}}if(n.length>0){var s=randint(0,n.length-1);if(n[s].sebzodes(t)){}else{}}else{this.eppen_tamad=false}var o=this;var u=setTimeout(function(){o.eppen_tamad=false},this.tamadasi_sebesseg)}};this.milyen_messze_van_a_jatekostol=function(){var e=this.mesh.position.clone();e.y=0;return MovingCube.position.distanceTo(e)};this.debuffot_kap=function(e){var t=0;for(var n=0;n<this.debuffok.length;n++){if(this.debuffok[n].karakter_id==e.karakter_id&&this.debuffok[n].skill_id==e.skill_id){t=1;break}}if(t==0){this.debuffok.push(e)}};this.dotot_kap=function(e){if(e!=null){var t=0;for(var n=0;n<this.dotok.length;n++){if(this.dotok[n].karakter_id==e.karakter_id&&this.dotok[n].skill_id==e.skill_id){t=1;break}}if(t==0){this.dotok.push(e)}}};this.tick=function(){this.toScreenXY();if(this.hp>0){var e=Math.round(Date.now()/1e3);for(var t=0;t<this.debuffok.length;t++){var n=skillek.skill_adatok(this.debuffok[t].skill_id);if(this.debuffok[t].elozo_tick==0){this.debuffok[t].elozo_tick=e;this.debuffok[t].debuff_ido-=1}else{if(this.debuffok[t].debuff_ido>0&&this.debuffok[t].elozo_tick<e){this.debuffok[t].elozo_tick=e;this.debuffok[t].dot_ido-=1}if(typeof this.debuffok[t].debuff_ido!=="undefined"){if(this.debuffok[t].debuff_ido<=0){this.debuffok.splice(t,1)}}}}var e=Math.round(Date.now()/1e3);for(var t=0;t<this.dotok.length;t++){var n=skillek.skill_adatok(this.dotok[t].skill_id);if(this.dotok[t].elozo_tick==0){this.dotok[t].elozo_tick=e;this.dotok[t].dot_ido-=1;var r=parseInt(this.dotok[t].dot_damage*.2);var i=randint(this.dotok[t].dot_damage-r-1,this.dotok[t].dot_damage+r);var s=this.sebzodes(i);info_szoveg(this.nev+" got "+i+" damage from "+n.nev);if(s.halott==1){info_szoveg(this.nev+" is dead.")}}else{if(this.dotok[t].dot_ido>0&&this.dotok[t].elozo_tick<e){this.dotok[t].elozo_tick=e;this.dotok[t].dot_ido-=1;var r=parseInt(this.dotok[t].dot_damage*.2);var i=randint(this.dotok[t].dot_damage-r,this.dotok[t].dot_damage+r);var s=this.sebzodes(i);info_szoveg(this.nev+" got "+i+" damage from "+n.nev);if(s.halott==1){info_szoveg(this.nev+" is dead.")}}if(typeof this.dotok[t]!=="undefined"){if(this.dotok[t].dot_ido<=0){this.dotok.splice(t,1)}}}}}if(this.hp<=0&&this.eppen_meghal===true){$("#ellenseg_info_"+this.id).hide();removeByAttr(collidableMeshList,"id",this.mesh.id);if(this.meshAnim.currentKeyframe==this.animaciok.meghal.vege){this.meshAnim.currentKeyframe=this.animaciok.meghal.vege;this.meshAnim.setFrameRange(this.animaciok.meghal.vege,this.animaciok.meghal.vege-1);this.drop_a_foldre(this.mit_dobott);var o=this;var u=setTimeout(function(){mozgas_logolas("ELLENSEG MEGHALT NEV:"+o.nev);for(var e=0;e<morphs.length;e++){if(morphs[e]==o.meshAnim){morphs.splice(e,1)}}removeByAttr(ellensegek,"id",o.mesh.id);scene.remove(o.mesh);scene.remove(o.meshAnim);scene.remove(o.meshAnim);for(var e=0;e<o.meshAnim.material.length;e++){o.meshAnim.material[e].dispose()}o.meshAnim.geometry.dispose()},5e3)}}if(this.eppen_mozog==0&&this.mesh&&this.hp>0){var a=0;for(t=0;t<karakterek.length;++t){var f=karakterek[t];if(f.hp>0){a=1;break}}if(this.milyen_messze_van_a_jatekostol()==100&&a==1){var l=0;var c=Math.abs(Math.floor(this.mesh.position.x/cubesize));var h=Math.abs(Math.floor(this.mesh.position.z/cubesize));var p=Math.abs(Math.floor(MovingCube.position.x/cubesize));var d=Math.abs(Math.floor(MovingCube.position.z/cubesize));var v=0;if(c<p){this.mesh.rotation.y=rad(90);v=1}if(c>p){this.mesh.rotation.y=rad(270);v=1}if(v==0){if(h<d){this.mesh.rotation.y=rad(0)}if(h>d){this.mesh.rotation.y=rad(180)}}this.tamadas()}this.movement={dx:0,dz:0};if(this.mesh.position.distanceTo(MovingCube.position)<=400&&this.mesh.position.distanceTo(MovingCube.position)>100&&a==1){this.jatekos_kovetes();return}else{this.koveti_a_jatekost=false}}};this.penz_kivalasztasa=function(){var e=0;var t=randint(0,1);if(t){var n=randint(1,this.penz);e=n}return e};this.sebzodes=function(e){var t={halott:0,targy:"",penz:0};if(this.hp<=0){return t}this.hp-=e;if(this.hp<0){this.hp=0}this.meshAnim.playAnimation("serul",this.animaciok.serul.fps);if(this.hp<=0){hang_lejatszas(this.hangok_meghal[0],{pan:0,volume:70});this.eppen_tamad=true;this.dotok=[];this.eppen_meghal=true;this.meshAnim.playAnimation("meghal",this.animaciok.meghal.fps);terkep.ellenseg_meghalt(this.terkep_kieg_id);var n=this.drop_kivalasztasa();var r=targyak.targy_generalas(n);this.mit_dobott=r;this.mennyi_penzt_dobott=this.penz_kivalasztasa();t.targy=r;t.halott=1;var i=new Karakter;i.mindenki_xpt_kap(this.xp)}else{var s=randint(0,this.hangok_serul.length-1);hang_lejatszas(this.hangok_serul[s],{pan:0,volume:100})}return t};this.toScreenXY=function(){var e='<div class="ellenseg_infok" id="ellenseg_info_'+this.id+'"><div class="ellenseg_infok_nev">Level '+this.statok.szint+" "+this.nev+'</div><div class="ellenseg_infok_hp"><div class="ellenseg_hp_bar" id="ellenseg_info_hp_'+this.id+'"></div></div><div class="ellenseg_infok_egyeb">'+this.egyeb_infok+"</div></div>";if($("#ellenseg_info_"+this.id).length==0){$("body").append(e)}if(this.milyen_messze_van_a_jatekostol()<=100&&this.hp>0){$("#ellenseg_info_"+this.id).show();var t=$("#ellenseg_info_"+this.id);$("#ellenseg_info_"+this.id).css("left",$(window).width()/2-t.width()/2);$("#ellenseg_info_"+this.id).css("top","50px");var n=parseInt(this.hp/this.max_hp*119);$("#ellenseg_info_hp_"+this.id).css("width",n)}else{$("#ellenseg_info_"+this.id).hide()}}}function Npc(e,t){this.id=e.id;this.tipus=e.npc_tipusa;this.pozicio=t;this.nev="";this.automatikusan_elkezd_beszelni=0;this.Tx=false;this.Ty=false;this.beszelgetesek=new Array;this.mesh=false;this.meshAnim=false;this.targyak=false;this.adatok_beolvasasa_mentesbol=function(e){this.targyak=e;console.log("this.targyak===============================:");console.log(this.targyak)};this.interakcio_inditasa=function(){console.log("interakcio_inditasa");$("#kuldi_tartalom").empty();var e=randint(17,19);hang_lejatszas(e,{pan:0,volume:100});var t=1;var n="";for(var r=0;r<this.beszelgetesek.length;r++){var i="";if(t==1){var i=""}else{var i='style="display:none"'}n+="<div "+i+' id="beszed_id_'+this.beszelgetesek[r].beszed_id+'">';n+='<div class="npc_int_szoveg_npc"><span>'+this.nev+"</span>: "+this.beszelgetesek[r].szoveg+"</div>";for(var s=0;s<this.beszelgetesek[r].valaszok.length;s++){var o=this.beszelgetesek[r].valaszok[s];var u="";if(this.beszelgetesek[r].valaszok[s].melyik_beszed_idt_hivja==999){u="npc_boltot_nyit("+this.id+")"}else{u="npc_interakcio_valaszadas("+this.beszelgetesek[r].valaszok[s].melyik_beszed_idt_hivja+")"}if(typeof this.beszelgetesek[r].valaszok[s].kuldetes_elfogadva_id!=="undefined"){u+=";npc_kuldit_elfogad("+this.id+","+this.beszelgetesek[r].valaszok[s].kuldetes_elfogadva_id+")"}if(typeof this.beszelgetesek[r].valaszok[s].targyat_kap_id!=="undefined"){var a=this.beszelgetesek[r].valaszok[s].targyat_kap_id;var f=targyak.targy_generalas(a);u+=";npc_targyat_ad("+this.id+",'"+f+"')"}n+='<div onclick="'+u+'" class="npc_int_szoveg_valasz">- '+this.beszelgetesek[r].valaszok[s].valasz+"</div>"}t=0;n+="</div>"}$("#kuldi_tartalom").append(n);$("#kuldi_0").fadeIn(300)};this.boltot_nyit=function(){};this.targy_odaadva=function(e){for(var t=0;t<this.targyak.length;t++){if(this.targyak[t].targy_id=e){this.targyak[t].odaadva="IGEN";break}}};this.odaadta_e_mar_a_targyat=function(e){var t=false;for(var n=0;n<this.targyak.length;n++){if(this.targyak[n].targy_id=e){if(this.targyak[n].odaadva=="IGEN"){t=true}break}}return t};this.create=function(){this.Tx=Math.abs(Math.floor(t.x/cubesize));this.Ty=Math.abs(Math.floor(t.z/cubesize));var e=(new Date).getTime();if(this.tipus=="npc1"){this.nev="Tuwen";this.automatikusan_elkezd_beszelni=1;this.targyak=[{targy_id:12,odaadva:"NEM"}];this.beszelgetesek=[{beszed_id:1,szoveg:"Greetings adventurers! What do you seek?",valaszok:[{valasz:"Mind your own business, we've been walking for hours without anything to cut down.",melyik_beszed_idt_hivja:4},{valasz:"Good day, we are on a journey to the heart of the dungeons. We seek vengeance and justice for all of us.",melyik_beszed_idt_hivja:2,targyat_kap_id:6e3},{valasz:"Hey, we are just passing trough here, any good advice woud really help us out.",melyik_beszed_idt_hivja:3}]},{beszed_id:2,szoveg:"Thank the gods, it's always relieving to see such heroism. It would be my heart's pleasure to help you out. Next to me, there is a portal which you can use to get to crucial parts of the dungeon. Not far from here is a locked door. Here, take this key, and good luck.",valaszok:[{valasz:"Thank You. Bye",melyik_beszed_idt_hivja:0}]},{beszed_id:3,szoveg:"Oh, I was hoping that you would... Excuse me. There is a portal, you can use it to get to crucial parts of the dungeon. Be safe.",valaszok:[{valasz:"Thank You. Bye",melyik_beszed_idt_hivja:0}]},{beszed_id:4,szoveg:"...(she looks frightened...I think I scared her.)",valaszok:[{valasz:"Is there a way to get by that door?",melyik_beszed_idt_hivja:5},{valasz:"Any way, we can bust down that door? Wait.. are those keys in your hands, pretty? Give it to us, and we will kill everything in no time.",melyik_beszed_idt_hivja:7,targyat_kap_id:6e3},{valasz:"Bye",melyik_beszed_idt_hivja:0}]},{beszed_id:5,szoveg:"I have the key, but I was hoping that I can give it to heroes, who are willing to face the evil.",valaszok:[{valasz:"We are going to do just that, Ma'am. You can trust us.",melyik_beszed_idt_hivja:6,targyat_kap_id:6e3}]},{beszed_id:6,szoveg:"Good. Here, take it. Good luck.",valaszok:[{valasz:"Thank You. Bye",melyik_beszed_idt_hivja:0}]},{beszed_id:7,szoveg:"Take it and just go.",valaszok:[{valasz:"Bye",melyik_beszed_idt_hivja:0}]}];this.create_altalanos("assets/models/npc_lany/fleurOptonl6.js","assets/models/npc_lany/textura.png")}if(this.tipus=="npc2"){this.nev="Viki";this.automatikusan_elkezd_beszelni=0;this.beszelgetesek=[{beszed_id:1,szoveg:"En egy masik noc vagyok nem kezdek el automatikusan rizsazni?",valaszok:[{valasz:"Semmit haggya beken",melyik_beszed_idt_hivja:2},{valasz:"Jotttem keresni a kincset",melyik_beszed_idt_hivja:3},{valasz:"Csak a szemuvegem keresem",melyik_beszed_idt_hivja:4}]},{beszed_id:2,szoveg:"Jovan akkor bekenhagylak szia es nincs is csak egy ebucsuzas valaszod",valaszok:[{valasz:"Csa",melyik_beszed_idt_hivja:0}]},{beszed_id:3,szoveg:"kincset? akkor meg fogsz halni az tuti. es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg es valami hosszu szoveg",valaszok:[{valasz:"mondd tovabb a rizsat",melyik_beszed_idt_hivja:5},{valasz:"mast akarok kerdezni visszavisz az elejere",melyik_beszed_idt_hivja:1}]},{beszed_id:4,szoveg:"en adok el neked szemuveget ha akarod",valaszok:[{valasz:"Nemkell csa",melyik_beszed_idt_hivja:0},{valasz:"megnezem milynek vannak, boltot nyit",melyik_beszed_idt_hivja:999}]},{beszed_id:5,szoveg:"megtobb rizsa es elksooznes",valaszok:[{valasz:"jovan koszi csa",melyik_beszed_idt_hivja:0}]}];this.create_altalanos("assets/models/Igrac_glavni_ver_7_splastom_anim.js","assets/textures/Igrac_glavni_ver_7_splastom.js.png")}};this.create_altalanos=function(e,t){for(var n=0;n<ideiglenes_npc_adatok.length;n++){if(ideiglenes_npc_adatok[n].npc_id==this.id){this.targyak=ideiglenes_npc_adatok[n].adatok}}var r=this;var i=getGeomertyFromCache(e);i.geometry.computeMorphNormals();var s=THREE.ImageUtils.loadTexture(t);var o=new THREE.MeshPhongMaterial({morphTargets:true,map:s});var u=new THREE.MorphAnimMesh(i.geometry,o);u.duration=15e3;u.scale.set(1,1,1);u.position.x=-40;u.position.y=-5;u.position.z=0;u.rotation.y=rad(-90);u.rotation=MovingCube.rotation;var a=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var f=new THREE.Mesh(a);f.visible=false;var l=new THREE.Object3D;l.add(f);l.add(u);scene.add(l);l.position.set(r.pozicio.x,r.pozicio.y,r.pozicio.z);morphs.push(u);npck.push(r);r.meshAnim=u;r.mesh=l;u.on("click",function(){console.log("click on npc1");var e=l.position.distanceTo(MovingCube.position);if(e>130){return}mozgas_logolas("NPCRE KATTINT id:"+r.id);r.interakcio_inditasa();hang_lejatszas(15,{pan:0,volume:20})})}}function Karakter(){this.id=0;this.nev="";this.kep="";this.penz=0;this.hanyadik_sorban_van=1;this.sorban_melyik_oldal="bal";this.max_taskahely=48;this.szabad_taskahely=48;this.max_hp=100;this.hp=100;this.max_mana=100;this.mana=100;this.mana_regen=.5;this.harcban_van=0;this.xp=0;this.szintlepes_ertekek=[{szint:2,xp:15},{szint:3,xp:20},{szint:4,xp:40},{szint:5,xp:80}];this.szint=1;this.faj=1;this.osztaly=1;this.statok_alapertekek={power:10,dexterity:10,defense:10,vitality:10,szint:1,magicfind:0};this.statok={power:0,dexterity:0,defense:0,vitality:0,szint:1,magicfind:0};this.statok_hatasok_nelkul={power:10,dexterity:10,defense:10,vitality:10,szint:1,magicfind:0};this.statok_skillekbol={power:0,dexterity:0,defense:0,vitality:0,szint:0,magicfind:0};this.hasznalhato_skillek=[];this.megtanult_skillek=[];this.osszes_skill=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36];this.elkoltheto_skill_pontok=1;this.skillek_hatasok=[];this.targy_balkezben=null;this.targy_jobbkezben=null;this.balkez_eppen_ut=false;this.jobbkez_eppen_ut=false;this.utesTimeout_balkez=null;this.utesTimeout_jobbkez=null;this.inventory=[];this.karakterlap=[];this.portre_skillek=[];this.letrehozas=function(e,t){this.id=e;this.nev=t;karakterek.push(this)};this.tudja_e_hasznalni=function(e){var t=true;var n=targyak.targyadatok(e);var r=[];var i=[];if(this.osztaly==1){r=["kard","ketkezes_kard","katana","scimitar","falchion","pajzs","ij","szamszerij","fejsze","kes","csephadaro","alabard","kalapacs","morningstar","vivobot","kasza","szigony","landzsa","csuzli","bot","palca"]}if(this.osztaly==2){r=["bot","palca","kes","csuzli"]}if(this.osztaly==3){r=["kard","ketkezes_kard","katana","scimitar","falchion","pajzs","ij","szamszerij","fejsze","kes","csephadaro","alabard","kalapacs","morningstar","vivobot","kasza","szigony","landzsa","csuzli","bot","palca"]}if(this.osztaly==4){r=["kard","ketkezes_kard","katana","scimitar","falchion","pajzs","ij","szamszerij","fejsze","kes","csephadaro","alabard","kalapacs","morningstar","vivobot","kasza","szigony","landzsa","csuzli","bot","palca"]}if(this.osztaly==5){r=["bot","palca","kes","csuzli"]}if(this.osztaly==6){r=["kes","kard","ij","szamszerij","csuzli"]}if(this.osztaly==7){r=["kes","kard","ij","szamszerij","csuzli"]}if(this.osztaly==8){r=["kard","ketkezes_kard","katana","scimitar","falchion","pajzs","ij","szamszerij","fejsze","kes","csephadaro","alabard","kalapacs","morningstar","vivobot","kasza","szigony","landzsa","csuzli","bot","palca"]}if(this.osztaly==1){i=["plate","leather"]}if(this.osztaly==2){i=["leather","cloth"]}if(this.osztaly==3){i=["plate"]}if(this.osztaly==4){i=["plate","leather"]}if(this.osztaly==5){i=["cloth"]}if(this.osztaly==6){i=["leather"]}if(this.osztaly==7){i=["leather","cloth"]}if(this.osztaly==8){i=["plate","leather"]}if(n.fokategoria=="fegyver"){if(jQuery.inArray(n.alkategoria,r)==-1){t=false}}if(n.fokategoria=="pancel"){if(jQuery.inArray(n.pancel_anyaga,i)==-1){t=false}}return t};this.karakterlap_objektum_frissitese=function(){var e=new Array;var t=$("#karekterlap_"+this.id).children("#karekterlap_felszerelesek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()!=""){e.push($(n).children().attr("data-item-id"))}else{e.push(0)}}this.karakterlap=e};this.karakterlapra_item=function(e,t){var n=$("#karekterlap_"+this.id).children("#karekterlap_felszerelesek").children();var r=n[t];var i=targyak.targyadatok(e);$(r).append('<img title="'+i.targy_leirasa+'" class="item" data-item-id="'+i.id+'" src="assets/items/'+i.kep_fajl+'">');$(".item").qtip(tooltip_options);if($(r).attr("id")=="karakterlap_"+this.id+"_bal_kez"){$("#karakter_"+this.id+"_kez_1").html('<img src="assets/items/'+i.kep_fajl+'">')}if($(r).attr("id")=="karakterlap_"+this.id+"_jobb_kez"){$("#karakter_"+this.id+"_kez_2").html('<img src="assets/items/'+i.kep_fajl+'">')}};this.portre_skillek_objektum_frissitese=function(){var e=new Array;var t=$("#portre_skill_ikonok_"+this.id).children(".portre_skill_egy_ikon");for(i=0;i<t.length;i++){var n=t[i];if($(n).html()!=""){e.push($(n).children().attr("data-skill-id"))}else{e.push(0)}}this.portre_skillek=e};this.inventory_objektum_frissitese=function(){var e=new Array;var t=$("#inventory_"+this.id).children("#inventory_elemek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()!=""){e.push($(n).children().attr("data-item-id"))}else{e.push(0)}}this.inventory=e};this.benne_van_a_skill_a_hatasaokban=function(e){var t={benne_van:0,hanyadik:0};for(var n=0;n<this.skillek_hatasok.length;n++){if(this.skillek_hatasok[n].skill_id==e){t.benne_van=1;t.hanyadik=n;break}}return t};this.skillek_init=function(){for(var e=0;e<this.osszes_skill.length;e++){var t=this.osszes_skill[e];var n={skill_id:t,mikor_aktivalta:"",power:0,dexterity:0,defense:0,vitality:0,szint:0,magicfind:0,hp:0,buff_lejart:0,buff_bekapcsolt:0,forras_karakter_id:this.id};this.skillek_hatasok.push(n)}};this.skill_hasznalat_celpont_valasztas=function(e,t){var n=skillek.skill_adatok(e);var r=this.skillek_hatasok_index(e);if(this.skillek_hatasok[r].mikor_aktivalta!=""){hang_lejatszas(38,{pan:0,volume:40});info_szoveg("This skill is on cooldown.");return}info_szoveg(n.nev+": Select your target!");$("body").css("cursor","crosshair");var i=this;$(".portre_kep").unbind("click");$(".portre_kep").click(function(){$("body").css("cursor","auto");$(".portre_kep").unbind("click");i.portre_kep_listener();var n=$(this).attr("data-id");i.skill_hasznalat(e,n,t)})};this.skill_hasznalat=function(e,t,n){if(this.hp<=0){return false}mozgas_logolas("SKILLT HASZNAL skill_id:"+e);var r=this.skillek_hatasok_index(e);this.skillek_hatasok[r].forras_karakter_id=n;var i=skillek.skill_adatok(e);if(i.tipus=="passziv"){return false}if(this.skillek_hatasok[r].mikor_aktivalta!=""){hang_lejatszas(38,{pan:0,volume:40});info_szoveg("This skill is on cooldown.");return false}if(n==this.id){if(!this.ki_van_rakva_a_skillbarra(e)){return false}if(this.mana-i.mana>=0){this.mana-=i.mana;var s=parseInt(this.mana/this.max_mana*119);this.mana_csik_animalas(s)}else{hang_lejatszas(38,{pan:0,volume:50});info_szoveg("Not enough mana to use that skill.");return false}}var o={karakter_id:this.id,power:this.statok_hatasok_nelkul.power,dexterity:this.statok_hatasok_nelkul.dexterity,defense:this.statok_hatasok_nelkul.defense,vitality:this.statok_hatasok_nelkul.vitality,szint:this.statok_hatasok_nelkul.szint,magicfind:this.statok_hatasok_nelkul.magicfind,hp:this.hp,max_hp:this.max_hp,hanyadik_sorban_van:this.hanyadik_sorban_van};var r=this.skillek_hatasok_index(e);var u=skillek.skill_inditasa(e,o,this.skillek_hatasok[r]);this.skillek_hatasok[r]=u;var a=i.cd+i.mennyi_ideig_marad_aktiv*1e3;var f=$("#portre_skill_ikonok_"+this.id).children();for(var l=0;l<f.length;l++){if($(f[l]).html()!=""){var c=$(f[l]).children().attr("data-skill-id");var h=$(f[l]).position();if(c==e){var p=$(f[l]).attr("id");if(i.tipus!="passziv"){$("#"+p).append("<div class='skill_fedo' id='portre_skill_fedo_"+this.id+"_"+e+"_fedo'></div>");$("#portre_skill_fedo_"+this.id+"_"+e+"_fedo").css("left",0);$("#portre_skill_fedo_"+this.id+"_"+e+"_fedo").css("top",0);var d=this;var v=setInterval(function(){$("#portre_skill_fedo_"+d.id+"_"+e+"_fedo").remove();d.skillek_hatasok[r].mikor_aktivalta="";clearInterval(v)},a)}}}}if(i.tipus=="buff"||i.tipus=="passziv"){this.buff_hozzadas_a_domhoz(i.ikon,e)}if(typeof u.enemy_damage!=="undefined"||typeof u.enemy_power!=="undefined"||typeof u.enemy_defense!=="undefined"){this.debuff_ellensegre(e,u)}if(i.tipus=="aktiv"&&i.alap_sebzes!=0){this.sebzes_skillel(e,u.mennyit_sebzett)}if(i.tipus=="gyogyitas"){this.gyogyitas_skillel(e,u.mennyit_sebzett,t)}if(n==this.id){if(i.mindenki_megkapja=="mindenki"){for(var l=0;l<karakterek.length;l++){if(karakterek[l].id!=this.id){karakterek[l].skill_hasznalat(e,0,n)}}}if(i.mindenki_megkapja=="mindenki_kiveve_caster"){for(var l=0;l<karakterek.length;l++){if(karakterek[l].id!=this.id){karakterek[l].skill_hasznalat(e,0,n)}else{this.buff_eltavaolitasa_a_dombol(e);var m={skill_id:e,mikor_aktivalta:"",power:0,dexterity:0,defense:0,vitality:0,szint:0,magicfind:0,hp:0,buff_lejart:1,buff_bekapcsolt:0,forras_karakter_id:this.id};this.skillek_hatasok[r]=m}}}if(i.mindenki_megkapja=="caster_es_mellette_allo"){for(var l=0;l<karakterek.length;l++){if(karakterek[l].hanyadik_sorban_van==this.hanyadik_sorban_van&&karakterek[l].id!=this.id){karakterek[l].skill_hasznalat(e,0,n)}else{}}}}if(i.tipus!="aktiv"&&i.tipus!="gyogyitas"){this.skillek_hatasok_szamolas()}this.statok_ujraszamolas()};this.skillek_hatasok_index=function(e){var t="";for(var n=0;n<this.skillek_hatasok.length;n++){if(this.skillek_hatasok[n].skill_id==e){t=n;break}}return t};this.ki_van_rakva_a_skillbarra=function(e){var t=false;var n=$("#portre_skill_ikonok_"+this.id).children(".portre_skill_egy_ikon");for(var r=0;r<n.length;r++){var i=n[r];if($(i).html()!=""){if($(i).children().attr("data-skill-id")==e){t=true;break}}}return t};this.skillek_hatasok_szamolas=function(){for(var e=0;e<this.osszes_skill.length;e++){var t=skillek.skill_adatok(this.osszes_skill[e]);if(t.tipus=="aktiv"||t.tipus=="gyogyitas"){continue}var n=this.skillek_hatasok_index(this.osszes_skill[e]);if(this.id==this.skillek_hatasok[n].forras_karakter_id){if(!this.ki_van_rakva_a_skillbarra(this.osszes_skill[e])){this.buff_eltavaolitasa_a_dombol(this.osszes_skill[e]);var r={skill_id:this.osszes_skill[e],mikor_aktivalta:"",power:0,dexterity:0,defense:0,vitality:0,szint:0,magicfind:0,hp:0,buff_lejart:1,buff_bekapcsolt:0,forras_karakter_id:this.id};this.skillek_hatasok[n]=r;continue}}var i={karakter_id:this.id,power:this.statok_hatasok_nelkul.power,dexterity:this.statok_hatasok_nelkul.dexterity,defense:this.statok_hatasok_nelkul.defense,vitality:this.statok_hatasok_nelkul.vitality,szint:this.statok_hatasok_nelkul.szint,magicfind:this.statok_hatasok_nelkul.magicfind,hp:this.hp,max_hp:this.max_hp,hanyadik_sorban_van:this.hanyadik_sorban_van};var s=skillek.skill_futtatasa(this.osszes_skill[e],i,this.skillek_hatasok[n]);if(s.buff_lejart==1){this.buff_eltavaolitasa_a_dombol(this.osszes_skill[e])}if(s.buff_bekapcsolt==1){this.buff_hozzadas_a_domhoz(t.ikon,this.osszes_skill[e]);s.buff_bekapcsolt=0}this.skillek_hatasok[n]=s}};this.tick=function(){this.statok_ujraszamolas();this.skillek_hatasok_szamolas();this.harcban_van_e()};this.harcban_van_e=function(){var e=0;for(var t=0;t<ellensegek.length;t++){if(ellensegek[t].milyen_messze_van_a_jatekostol()<=100){e=1;break}else{if(ellensegek[t].koveti_a_jatekost===true){e=1;break}}}this.harcban_van=e};this.getFaj=function(){if(this.faj==1){return"Human male"}if(this.faj==2){return"Human female"}if(this.faj==3){return"Dwarf male"}if(this.faj==4){return"Dwarf female"}if(this.faj==5){return"Fallen male"}if(this.faj==6){return"Fallen female"}};this.getOsztaly=function(){if(this.osztaly==1){return"Fanatic"}if(this.osztaly==2){return"Heretic"}if(this.osztaly==3){return"Paladin"}if(this.osztaly==4){return"Warrior"}if(this.osztaly==5){return"Sorcerer"}if(this.osztaly==6){return"Thief"}if(this.osztaly==7){return"Pathfinder"}if(this.osztaly==8){return"Berserker"}};this.adatok_beolvasasa_mentesbol=function(e){this.statok_alapertekek.power=this.statok.power=e.statok_alapertekek.power;this.statok_alapertekek.dexterity=this.statok.dexterity=e.statok_alapertekek.dexterity;this.statok_alapertekek.defense=this.statok.defense=e.statok_alapertekek.defense;this.statok_alapertekek.vitality=this.statok.vitality=e.statok_alapertekek.vitality;this.xp=e.xp;this.szint=e.szint;this.hp=e.hp;this.mana=e.mana;this.kep=e.kep;this.faj=e.faj;this.osztaly=e.osztaly;this.penz=e.penz;this.elkoltheto_skill_pontok=e.elkoltheto_skill_pontok;this.megtanult_skillek=e.megtanult_skillek;if(this.osztaly==1){this.hasznalhato_skillek=[1,2,29,30,31]}if(this.osztaly==2){this.hasznalhato_skillek=[18,3,36,17,12,19,16,15,14]}if(this.osztaly==3){this.hasznalhato_skillek=[20,9,4,21,22,25,23,24]}if(this.osztaly==4){this.hasznalhato_skillek=[6,7,8,10,11,13]}if(this.osztaly==5){this.hasznalhato_skillek=[5,26,34,28,32,33,27,35]}if(this.osztaly==6){this.hasznalhato_skillek=[]}if(this.osztaly==7){this.hasznalhato_skillek=[]}if(this.osztaly==8){this.hasznalhato_skillek=[]}this.skillek_init();if(this.osztaly==1||this.osztaly==3||this.osztaly==4||this.osztaly==6||this.osztaly==7||this.osztaly==8){this.max_mana=100}if(this.osztaly==2||this.osztaly==5){this.max_mana=200}this.max_hp=this.max_hp_mennyi();var t=this;setInterval(function(){t.tick()},500);setInterval(function(){t.mana_regeneralas()},1e3)};this.mana_regeneralas=function(){if(this.mana<this.max_mana&&this.harcban_van==0){this.mana+=this.max_mana*(this.mana_regen/100);var e=parseInt(this.mana/this.max_mana*119);this.mana_csik_animalas(e)}};this.adatok_beolvasasa_chargenbol=function(e){this.statok_alapertekek.power=this.statok.power=e.stat_power;this.statok_alapertekek.dexterity=this.statok.dexterity=e.stat_dexterity;this.statok_alapertekek.defense=this.statok.defense=e.stat_defense;this.statok_alapertekek.vitality=this.statok.vitality=e.stat_vitality;this.faj=e.faj;this.osztaly=e.osztaly;this.kep=e.kep;if(this.osztaly==1||this.osztaly==3||this.osztaly==4||this.osztaly==6||this.osztaly==7||this.osztaly==8){this.max_mana=100}if(this.osztaly==2||this.osztaly==5){this.max_mana=200}this.mana=this.max_mana;this.max_hp=100+this.statok.vitality*2;this.hp=this.max_hp};this.buff_hozzadas_a_domhoz=function(e,t){if($("#karakter_"+this.id+"skill_"+t).length>0){}else{var n='<div class="egy_buff" id="karakter_'+this.id+"skill_"+t+'"><img width="20" src="'+e+'"></div>';$("#buffok_"+this.id).append(n)}};this.buff_eltavaolitasa_a_dombol=function(e){if($("#karakter_"+this.id+"skill_"+e).length>0){$("#karakter_"+this.id+"skill_"+e).remove()}};this.hozzadas_a_domhoz=function(){var e=this.kep;if(this.hp<=0){e="assets/images/skull_portre_kicsi.png"}var t="";t+='<div class="portre" data-id="'+this.id+'">';t+='<div class="portre_kep" data-id="'+this.id+'">';t+='<div class="portre_kep_kep" id="portre_kep_'+this.id+'"><img width="40" src="'+e+'"></div>';t+='<div class="portre_kep_szint" id="portre_kep_szint_'+this.id+'">'+this.szint+"</div>";t+="</div>";t+='<div class="portre_nev" data-id="'+this.id+'">'+this.nev+"</div>";t+='<div class="hp_es_mana"><div class="hp_szam" id="hp_szam_'+this.id+'">'+this.hp+"/"+this.max_hp+'</div><div class="mana_szam" id="mana_szam_'+this.id+'">'+this.mana+"/"+this.max_mana+"</div>";t+='<div id="hp_'+this.id+'" class="hp_bar"></div>';t+='<div id="mana_'+this.id+'" class="mana_bar"></div>';t+="</div>";t+='<div class="kezek_hatter">';t+='<div class="kez1" data-karakter-id="'+this.id+'" id="karakter_'+this.id+'_kez_1"></div>';t+='<div class="kez1" data-karakter-id="'+this.id+'" id="karakter_'+this.id+'_kez_2"></div>';t+="</div>";t+='<div class="portre_ikonok">';t+='<div data-id="'+this.id+'" class="portre_ikon_karakterlap"><img width="20" src="assets/images/ikon_karakterlap.png"></div>';t+='<div data-id="'+this.id+'" class="portre_ikon_inventory"><img width="20" src="assets/images/ikon_inventory.png"></div>';t+='<div data-id="'+this.id+'" class="portre_ikon_skills"><img width="20" src="assets/images/ikon_skills.png"></div>';t+='<div data-id="'+this.id+'" class="portre_ikon_abilities"><img width="20" src="assets/images/ikon_abilities.png"></div>';t+="</div>";t+='<div class="portre_skill_ikonok" data-karakter-id="'+this.id+'" id="portre_skill_ikonok_'+this.id+'">';if(this.osztaly==1||this.osztaly==3||this.osztaly==4||this.osztaly==6||this.osztaly==7||this.osztaly==8){t+='<div class="portre_skill_kitolto2"></div>';t+='<div class="portre_skill_egy_ikon" id="portre_skill_'+this.id+'_1"></div>';t+='<div class="portre_skill_egy_ikon" id="portre_skill_'+this.id+'_2"></div>'}else{t+='<div class="portre_skill_kitolto"></div>';t+='<div class="portre_skill_egy_ikon" id="portre_skill_'+this.id+'_1"></div>';t+='<div class="portre_skill_egy_ikon" id="portre_skill_'+this.id+'_2"></div>';t+='<div class="portre_skill_egy_ikon" id="portre_skill_'+this.id+'_3"></div>'}t+="</div>";t+='<br class="clear"><div class="buffok" id="buffok_'+this.id+'"></div><div class="debuffok"></div>';t+="</div>";$("#portre_kontener").append(t);var n="";n+='<div class="karekterlap_hatter" id="karekterlap_'+this.id+'">';n+='<div class="lapok_dragndrop"></div>';n+='<div class="lapok_bezar" data-id="karekterlap_'+this.id+'"></div>';n+='<div id="karekterlap_felszerelesek" data-karakter-id="'+this.id+'">';n+='<div class="karakterlap_felszereles karakterlap_fej" id="karakterlap_'+this.id+'_fej"></div>';n+='<div class="karakterlap_felszereles karakterlap_nyak" id="karakterlap_'+this.id+'_nyak"></div>';n+='<div class="karakterlap_felszereles karakterlap_torzs" id="karakterlap_'+this.id+'_torzs"></div>';n+='<div class="karakterlap_felszereles karakterlap_bal_kez" id="karakterlap_'+this.id+'_bal_kez"></div>';n+='<div class="karakterlap_felszereles karakterlap_jobb_kez" id="karakterlap_'+this.id+'_jobb_kez"></div>';n+='<div class="karakterlap_felszereles karakterlap_gyuru1" id="karakterlap_'+this.id+'_gyuru1"></div>';n+='<div class="karakterlap_felszereles karakterlap_gyuru2" id="karakterlap_'+this.id+'_gyuru2"></div>';n+='<div class="karakterlap_felszereles karakterlap_kesztyu" id="karakterlap_'+this.id+'_kesztyu"></div>';n+='<div class="karakterlap_felszereles karakterlap_cipo" id="karakterlap_'+this.id+'_cipo"></div>';n+="</div>";n+='<div id="karakterlap_portre"><img src="'+this.kep+'" width="80"><br>'+this.nev+'<br>Level <span id="karakter_'+this.id+'_szint">'+this.szint+"</span><br>"+this.getFaj()+"<br>"+this.getOsztaly()+'<br>XP: <span id="karakter_'+this.id+'_xp">'+this.xp+"</span></div>";n+='<div id="karakterlap_statok">';n+='<div class="karakterlap_stat_sor">Power: '+this.statok.power+"</div>";n+='<div class="karakterlap_stat_sor">Dexterity: '+this.statok.dexterity+"</div>";n+='<div class="karakterlap_stat_sor">Defense: '+this.statok.defense+"</div>";n+='<div class="karakterlap_stat_sor">Vitality: '+this.statok.vitality+"</div>";n+='<div class="karakterlap_stat_sor">Magic find: '+this.statok.magicfind+"%</div>";n+='<div class="karakterlap_stat_sor">Mana regen: '+this.mana_regen+"%</div>";n+="</div>";n+='<div class="karakterlap_szintlepes" id="karakterlap_szintlepes_'+this.id+'">';n+="</div>";n+="</div>";$("body").append(n);var r=this.lepett_e_szintet();if(r.lepett_e==1){this.szintlepes_kezelok()}var i="";i+='<div class="skills_hatter"  id="skills_'+this.id+'">';i+='<div class="lapok_dragndrop"></div>';i+='<div class="lapok_bezar" data-id="skills_'+this.id+'"></div>';i+='<div class="skill_szovegek">';i+='<div class="skill_szoveg_passziv"></div>';i+='<div class="skill_szoveg_buff"></div>';i+='<div class="skill_szoveg_aktiv"></div>';i+="</div>";i+='<div id="skill_szintek_szoveg1">1</div>';i+='<div id="skill_szintek_szoveg2">5</div>';i+='<div id="skill_szintek_szoveg3">15</div>';i+='<div id="skill_szintek_szoveg4">30</div>';i+='<div id="skill_szintek_szoveg5">50</div>';i+='<div class="skills_elemek" data-karakter-id="'+this.id+'">';for(var s=1;s<=20;s++){i+='<div class="egy_skills_hely" id="skills_hely_'+this.id+"_"+s+'"></div>'}i+="</div>";i+='<div class="skill_kolthet_szoveg">You have <span id="elkoltheto_skill_pont_'+this.id+'">'+this.elkoltheto_skill_pontok+"</span> skill points to spend.</div>";i+="</div>";$("body").append(i);this.skillek_feltoltese();var o="";o+='<div class="inventory_hatter"  id="inventory_'+this.id+'">';o+='<div class="lapok_dragndrop"></div>';o+='<div class="lapok_bezar" data-id="inventory_'+this.id+'"></div>';o+='<div id="inventory_elemek" data-karakter-id="'+this.id+'">';for(var s=1;s<=48;s++){o+='<div class="egy_taskahely" id="taskahely_'+this.id+"_"+s+'"></div>'}o+="</div>";o+="</div>";$("body").append(o);var u="";u+='<div class="abilities_hatter" id="abilities_'+this.id+'">';u+='<div class="lapok_dragndrop"></div>';u+='<div class="lapok_bezar" data-id="abilities_'+this.id+'"></div>';u+='<div class="abilities_tartalom">';u+='<div class="abilities_sor">Mana regeneration: 0</div>';u+='<div class="abilities_sor">Maximum mana: 0</div>';u+='<div class="abilities_sor">Door lock pick: 4</div>';u+='<div class="abilities_sor">Chest lock pick: 2</div>';u+='<div class="abilities_sor">Disarm trap: 0</div>';u+='<div class="abilities_sor">Healing power: 0</div>';u+='<div class="abilities_sor">Buff type skill effectiveness: 0</div>';u+='<div class="abilities_sor">Passive type skill effectiveness: 0</div>';u+='<div class="abilities_sor">Active type skill effectiveness: 0</div>';u+='<div class="abilities_sor">Mental stability: 0 debuffok elkerulese</div>';u+='<div class="abilities_sor">Knowledge: 0 cucc aoznositahsoz</div>';u+='<div class="abilities_sor">Search: 0 titkos ajtok keresese</div>';u+='<div class="abilities_sor">Weapon: 0 fegyv haszn. pl 50-70 es sebzot 60-70 eskent</div>';u+='<div class="abilities_sor">Tska: 0 tobb cucc fer az inventoryaba</div>';u+='<div class="abilities_sor">Disarm trap: 0</div>';u+='<div class="abilities_sor">Disarm trap: 0</div>';u+='<div class="abilities_sor">Disarm trap: 0</div>';u+='<div class="abilities_sor">Disarm trap: 0</div>';u+="</div>";u+="</div>";$("body").append(u);var a='<div class="speech_bubble" id="bubble_'+this.id+'"><div class="speech_bubble_szoveg" id="bubble_szoveg_'+this.id+'"></div></div>';$("body").append(a);var f=this;$("#karakter_"+this.id+"_kez_1").click(function(){f.tamadas(1)});$("#karakter_"+this.id+"_kez_2").click(function(){f.tamadas(2)})};this.hp_es_mana_beallitasa=function(){this.statok_ujraszamolas();var e=parseInt(this.hp/this.max_hp*119);$("#hp_"+this.id).css("width",e)};this.szintlepes_kezelok=function(){$("#karakterlap_szintlepes_"+this.id).empty();var e=this.lepett_e_szintet();var t=e.mennyi_pontot_oszthat;karakterlap_dom="";karakterlap_dom+='<div class="csoport_szoveg">You have <span><span id="elkoltheto_pont_'+this.id+'">'+e.mennyi_pontot_oszthat+"</span> points to spend</span></div>";karakterlap_dom+='<div class="stat_egy">';karakterlap_dom+='<div class="stat_egy_neve">Power:</div>';karakterlap_dom+='<div class="stat_egy_nyil_balra_'+this.id+' stat_egy_nyil_balra" data-stat="power"><img width="10" src="assets/images/nyil_balra.png"></div>';karakterlap_dom+='<div class="stat_egy_ertek" id="stat_power_'+this.id+'">0</div>';karakterlap_dom+='<div class="stat_egy_nyil_jobbra_'+this.id+' stat_egy_nyil_jobbra" data-stat="power"><img width="10"  src="assets/images/nyil_jobbra.png"></div>';karakterlap_dom+="</div>";karakterlap_dom+='<div class="stat_egy">';karakterlap_dom+='<div class="stat_egy_neve">Dexterity:</div>';karakterlap_dom+='<div class="stat_egy_nyil_balra_'+this.id+' stat_egy_nyil_balra" data-stat="dexterity"><img width="10" src="assets/images/nyil_balra.png"></div>';karakterlap_dom+='<div class="stat_egy_ertek" id="stat_dexterity_'+this.id+'">0</div>';karakterlap_dom+='<div class="stat_egy_nyil_jobbra_'+this.id+'  stat_egy_nyil_jobbra" data-stat="dexterity"><img width="10"  src="assets/images/nyil_jobbra.png"></div>';karakterlap_dom+="</div>";karakterlap_dom+='<div class="stat_egy">';karakterlap_dom+='<div class="stat_egy_neve">Defense:</div>';karakterlap_dom+='<div class="stat_egy_nyil_balra_'+this.id+' stat_egy_nyil_balra" data-stat="defense"><img width="10" src="assets/images/nyil_balra.png"></div>';karakterlap_dom+='<div class="stat_egy_ertek" id="stat_defense_'+this.id+'">0</div>';karakterlap_dom+='<div class="stat_egy_nyil_jobbra_'+this.id+'  stat_egy_nyil_jobbra"  data-stat="defense"><img width="10"  src="assets/images/nyil_jobbra.png"></div>';karakterlap_dom+="</div>";karakterlap_dom+='<div class="stat_egy">';karakterlap_dom+='<div class="stat_egy_neve">Vitality:</div>';karakterlap_dom+='<div class="stat_egy_nyil_balra_'+this.id+' stat_egy_nyil_balra" data-stat="vitality"><img width="10" src="assets/images/nyil_balra.png"></div>';karakterlap_dom+='<div class="stat_egy_ertek" id="stat_vitality_'+this.id+'">0</div>';karakterlap_dom+='<div class="stat_egy_nyil_jobbra_'+this.id+'  stat_egy_nyil_jobbra" data-stat="vitality"><img width="10"  src="assets/images/nyil_jobbra.png"></div>';karakterlap_dom+="</div>";karakterlap_dom+='<div><input type="button" value="Save" disabled="disabled" id="szintlepes_mentes_'+this.id+'"></div>';$("#karakterlap_szintlepes_"+this.id).append(karakterlap_dom);var n=this;$(".stat_egy_nyil_jobbra_"+this.id).click(function(){var e=$(this).attr("data-stat");var r=parseInt($("#stat_"+e+"_"+n.id).html());if(t>0){$("#szintlepes_mentes_"+n.id).attr("disabled","disabled");$("#stat_"+e+"_"+n.id).html(r+1);t--;$("#elkoltheto_pont_"+n.id).html(t)}if(t==0){$("#szintlepes_mentes_"+n.id).removeAttr("disabled")}});$(".stat_egy_nyil_balra_"+this.id).click(function(){var e=$(this).attr("data-stat");console.log(e);var r=parseInt($("#stat_"+e+"_"+n.id).html());if(r>0){$("#szintlepes_mentes_"+n.id).attr("disabled","disabled");$("#stat_"+e+"_"+n.id).html(r-1);t++;$("#elkoltheto_pont_"+n.id).html(t)}if(t==0){$("#szintlepes_mentes_"+n.id).removeAttr("disabled")}});$("#szintlepes_mentes_"+this.id).click(function(){var t=parseInt($("#stat_power_"+n.id).html());var r=parseInt($("#stat_dexterity_"+n.id).html());var i=parseInt($("#stat_defense_"+n.id).html());var s=parseInt($("#stat_vitality_"+n.id).html());$("#karakterlap_szintlepes_"+n.id).empty();n.statok_alapertekek.power+=t;n.statok_alapertekek.dexterity+=r;n.statok_alapertekek.defense+=i;n.statok_alapertekek.vitality+=s;n.statok_ujraszamolas();n.szint+=e.mennyit;$("#karakter_"+n.id+"_szint").html(n.szint);$("#portre_kep_szint_"+n.id).html(n.szint)})};this.portre_kep_listener=function(){$(".portre_kep").click(function(){minden_ablak_ki();var e=$(this).parent().attr("data-id");inventory_be(e);karakterlap_be(e);skills_be(e);abilities_be(e);hang_lejatszas(33,{pan:0,volume:80})})};this.listenerek_kikapcsolasa=function(){$(".portre_nev").unbind("contextmenu");$(".portre_ikon_karakterlap").off("click");$(".portre_ikon_inventory").off("click");$(".portre_ikon_skills").off("click");$(".portre_ikon_abilities").off("click");$(".portre_skill_egy_ikon").off("click");$(".portre_kep").off("click");$("#karakter_"+this.id+"_kez_1").off("click");$("#karakter_"+this.id+"_kez_2").off("click");$(".skillbook_fedo").off("click")};this.listenerek_bekapcsolasa=function(){this.listenerek_kikapcsolasa();var e=this;$("#karakter_"+this.id+"_kez_1").click(function(){e.tamadas(1)});$("#karakter_"+this.id+"_kez_2").click(function(){e.tamadas(2)});$(".skillbook_fedo").click(function(){var e=$(this).parent().parent().attr("data-karakter-id");var t=karakter_hanyadik_a_tombben_id_alapjan(e);var n=karakterek[t];var r=$(this).attr("data-skill-id");if(n.elkoltheto_skill_pontok<=0){info_szoveg("You dont have any skill point to spend.");hang_lejatszas(38,{pan:0,volume:40});return false}var i=skillek.skill_adatok(r);if(i.mennyi_skillpontba_kerul>n.elkoltheto_skill_pontok){info_szoveg("You dont have enough skill points to learn this skill.");hang_lejatszas(38,{pan:0,volume:40});return false}if(i.szint<=n.szint){var s=confirm("Do you want to learn the "+i.nev+" skill?");if(s){hang_lejatszas(71,{pan:0,volume:40});n.megtanult_skillek.push(parseInt(r));$(this).off("click");$(this).remove();n.elkoltheto_skill_pontok-=i.mennyi_skillpontba_kerul;$("#elkoltheto_skill_pont_"+n.id).html(n.elkoltheto_skill_pontok)}}else{hang_lejatszas(38,{pan:0,volume:40});info_szoveg("Your level is not high enough to learn this skill!")}});$(".portre_nev").bind("contextmenu",function(e){e.preventDefault();if(karakter_cserere_kijelolve==0){$(this).parent().css("background-color","red");karakter_cserere_kijelolve=$(this).attr("data-id");info_szoveg("Select character to replace with.")}else{if(karakter_cserere_kijelolve!=$(this).attr("data-id")){var t=$(this).parent().clone(false);var n=$('.portre[data-id="'+karakter_cserere_kijelolve+'"]').clone(false);$('.portre[data-id="'+karakter_cserere_kijelolve+'"]').replaceWith(t);$(this).parent().replaceWith(n);var r=$(this).attr("data-id");var i=karakter_cserere_kijelolve;var s=karakter_hanyadik_a_tombben_id_alapjan(r);var o=karakter_hanyadik_a_tombben_id_alapjan(i);var u=karakterek[s].hanyadik_sorban_van;var a=karakterek[s].sorban_melyik_oldal;var f=karakterek[o].hanyadik_sorban_van;var l=karakterek[o].sorban_melyik_oldal;karakterek[s].hanyadik_sorban_van=f;karakterek[s].sorban_melyik_oldal=l;karakterek[o].hanyadik_sorban_van=u;karakterek[o].sorban_melyik_oldal=a;$('.portre[data-id="'+karakter_cserere_kijelolve+'"]').css("background-color","transparent");karakter_cserere_kijelolve=0;for(var c=0;c<karakterek.length;c++){karakterek[c].listenerek_bekapcsolasa()}}else{$('.portre[data-id="'+karakter_cserere_kijelolve+'"]').css("background-color","transparent");karakter_cserere_kijelolve=0}}});$(".portre_ikon_karakterlap").click(function(){var e=$(this).attr("data-id");karakterlap_kibe(e);hang_lejatszas(15,{pan:0,volume:50})});$(".portre_ikon_inventory").click(function(){var e=$(this).attr("data-id");inventory_kibe(e);hang_lejatszas(15,{pan:0,volume:50})});$(".portre_ikon_skills").click(function(){var e=$(this).attr("data-id");skills_kibe(e);hang_lejatszas(15,{pan:0,volume:50})});$(".portre_ikon_abilities").click(function(){var e=$(this).attr("data-id");abilities_kibe(e);hang_lejatszas(15,{pan:0,volume:50})});this.portre_kep_listener();$(".portre_skill_egy_ikon").click(function(){if($(this).children().length>0){var e=$(this).parent().parent().attr("data-id");var t=$(this).children().attr("data-skill-id");var n=karakterek[e-1];var r=skillek.skill_adatok(t);if(r.tipus=="gyogyitas"){n.skill_hasznalat_celpont_valasztas(t,e)}else{n.skill_hasznalat(t,0,e)}}});$(".egy_taskahely").droppable(inventory_droppable_options);$(".item").draggable(inventory_draggable_options);$(".skill").draggable(skills_draggable_options);$(".portre_skill_egy_ikon").droppable(portre_skill_droppable_options);$(".karekterlap_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".inventory_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".skills_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".abilities_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".lapok_bezar").click(function(){var e=$(this).attr("data-id");$("#"+e).fadeOut(300)})};this.statok_ujraszamolas=function(){var e=this.statok_alapertekek.power;var t=this.statok_alapertekek.dexterity;var n=this.statok_alapertekek.defense;var r=this.statok_alapertekek.vitality;var i=this.statok_alapertekek.magicfind;var s=$("#karekterlap_"+this.id).children("#karekterlap_felszerelesek").children();for(var o=0;o<s.length;o++){if($(s[o]).html()!=""){var u=$(s[o]).children().attr("data-item-id");var a=targyak.targyadatok(u);e+=parseInt(a.statok.power);t+=parseInt(a.statok.dexterity);n+=parseInt(a.statok.defense);r+=parseInt(a.statok.vitality);i+=parseInt(a.statok.magicfind)}}this.statok_hatasok_nelkul.power=e;this.statok_hatasok_nelkul.dexterity=t;this.statok_hatasok_nelkul.defense=n;this.statok_hatasok_nelkul.vitality=r;this.statok_hatasok_nelkul.magicfind=i;for(var f=0;f<this.skillek_hatasok.length;f++){e+=this.skillek_hatasok[f].power;t+=this.skillek_hatasok[f].dexterity;n+=this.skillek_hatasok[f].defense;r+=this.skillek_hatasok[f].vitality;i+=this.skillek_hatasok[f].magicfind}this.statok.power=e;this.statok.dexterity=t;this.statok.defense=n;this.statok.vitality=r;this.statok.magicfind=i;var l="";l+='<div class="karakterlap_stat_sor">Power: '+e+"</div>";l+='<div class="karakterlap_stat_sor">Dexterity: '+t+"</div>";l+='<div class="karakterlap_stat_sor">Defense: '+n+"</div>";l+='<div class="karakterlap_stat_sor">Vitality: '+r+"</div>";l+='<div class="karakterlap_stat_sor">Magic find: '+i+"%</div>";l+='<div class="karakterlap_stat_sor">Mana regen: '+this.mana_regen+"%</div>";$("#karekterlap_"+this.id).children("#karakterlap_statok").html(l);if(this.hp==this.max_hp){this.max_hp=this.max_hp_mennyi();this.hp=this.max_hp}else{this.max_hp=this.max_hp_mennyi()}$("#hp_szam_"+this.id).html(parseInt(this.hp)+"/"+this.max_hp)};this.max_hp_mennyi=function(){return 100+this.statok.vitality*2};this.targy_kezbe_vetel=function(e,t){var n=targyak.targyadatok(e);var r='<img title="'+n.targy_leirasa+'" class="item" data-item-id="'+n.id+'" src="assets/items/'+n.kep_fajl+'">';$("#karakter_"+this.id+"_kez_"+t).append(r);$(".item").qtip(tooltip_options)};this.sebzodes=function(e){var t=randint(-(e/3),e/3);var n=this.statok.defense/5;var r=parseInt(e-n*2+t);if(r<0){r=0}hang_lejatszas(11,{pan:0,volume:70});this.hp-=r;if(this.hp<0){this.hp=0}info_szoveg(this.nev+" got "+r+" damage!");var i=parseInt(this.hp/this.max_hp*119);var s=randint(1,3);if(s==1){var o=randint(1,6);if(i<50&&this.hp>0){if(o==1){this.szovegbuborek("I need some healing.")}if(o==2){this.szovegbuborek("I wont go down that easy.")}if(o==3){this.szovegbuborek("Fear not!")}if(o==4){this.szovegbuborek("Die!")}if(o==5){this.szovegbuborek("Banish the evil!")}if(o==6){this.szovegbuborek("Just a bruise")}}if(i<20&&this.hp>0){if(o==1){this.szovegbuborek("Heal meeeee!")}if(o==2){this.szovegbuborek("That hurts!")}if(o==3){this.szovegbuborek("Im going to die...")}if(o==4){this.szovegbuborek("Wanna lend some help here")}if(o==5){this.szovegbuborek("Help!")}if(o==6){this.szovegbuborek("Show me your best!")}}if(i<10&&this.hp>0){if(o==1){this.szovegbuborek("I will die for sure.")}if(o==2){this.szovegbuborek("Forgive...me.")}if(o==3){this.szovegbuborek("Cant keep this up..")}if(o==4){this.szovegbuborek("Bring me back..")}if(o==5){this.szovegbuborek("My power will remain..")}if(o==6){this.szovegbuborek("Take my.. weapons..")}}}this.hp_csik_animalas(i);var u=$("#portre_kep_"+this.id).position();$("#portre_kep_"+this.id).append("<div class='portre_fedo' id='portre_fedo_"+this.id+"'>"+r+"</div>");$("#portre_fedo_"+this.id).css("left",u.left);$("#portre_fedo_"+this.id).css("top",u.top);var a=this;var f=setInterval(function(){$("#portre_fedo_"+a.id).remove();clearInterval(f)},1e3);if(this.hp<=0){mozgas_logolas("KARAKTER MEGHALT NEV:"+this.nev);info_szoveg(this.nev+" is DEAD! ");hang_lejatszas(12,{pan:0,volume:80});$("#portre_kep_"+this.id).html('<img src="assets/images/skull_portre_kicsi.png">')}return true};this.hp_csik_animalas=function(e){$("#hp_szam_"+this.id).html(parseInt(this.hp)+"/"+this.max_hp);$("#hp_"+this.id).stop(true).animate({width:e},700)};this.mana_csik_animalas=function(e){$("#mana_szam_"+this.id).html(parseInt(this.mana)+"/"+this.max_mana);$("#mana_"+this.id).stop(true).animate({width:e},700)};this.fegyver_van_e_a_kezben=function(e){var t=0;if(e==1){t=$("#karekterlap_"+this.id).children("#karekterlap_felszerelesek").children("#karakterlap_"+this.id+"_bal_kez").children().attr("data-item-id")}if(e==2){t=$("#karekterlap_"+this.id).children("#karekterlap_felszerelesek").children("#karakterlap_"+this.id+"_jobb_kez").children().attr("data-item-id")}if(typeof t==="undefined"){return false}else{var n=targyak.targyadatok(t);if(n.fokategoria=="fegyver"&&n.alkategoria!="pajzs"){return t}else{return false}}};this.tamadas=function(e){var t=this.fegyver_van_e_a_kezben(e);if(t){var n=false;if(e==1){if(this.balkez_eppen_ut==false){var n=true}}if(e==2){if(this.jobbkez_eppen_ut==false){var n=true}}if(n&&this.hp>0){mozgas_logolas("TAMAD kari_id:"+this.id+" melyik_kez:"+e);if(e==1){this.balkez_eppen_ut=true}if(e==2){this.jobbkez_eppen_ut=true}var r=this.sebzes_szamitas(e,t);this.css_animacio(r,e)}if(n===false){hang_lejatszas(38,{pan:0,volume:40})}}else{info_szoveg("Equip a weapon to attack!")}};this.sebzodo_ellensegek=function(e,t){var n=deg(camera.rotation.y);var r=new Array;for(var i=0;i<ellensegek.length;i++){var s=0;var o=Math.abs(Math.floor(ellensegek[i].mesh.position.x/cubesize));var u=Math.abs(Math.floor(ellensegek[i].mesh.position.z/cubesize));var a=Math.abs(Math.floor(MovingCube.position.x/cubesize));var f=Math.abs(Math.floor(MovingCube.position.z/cubesize));if(n==0){if(u<f){s=1}}if(n==90){if(o<a){s=1}}if(n==180){if(u>f){s=1}}if(n==270){if(o>a){s=1}}var l=ellensegek[i].mesh.position.clone();l.y=0;if(MovingCube.position.distanceTo(l)<=100&&s){if(e!=0){var c=targyak.targyadatok(e);if(c.statok.hatotavolsag<=1){if(this.hanyadik_sorban_van==1){r.push(ellensegek[i])}}if(c.statok.hatotavolsag>=2){r.push(ellensegek[i])}}if(t!=0){r.push(ellensegek[i])}}}return r};this.manat_kap=function(e){this.mana+=e;if(this.mana>this.max_mana){this.mana=this.max_mana}var t=parseInt(this.mana/this.max_mana*119);this.mana_csik_animalas(t);info_szoveg(this.nev+" restored "+e+" mana.")};this.gyogyitas_skillel=function(e,t,n){var r=karakterek[n-1];r.gyogyulas(e,t)};this.gyogyulas=function(e,t){var n=skillek.skill_adatok(e);if(n.funkcio=="resurrect"){if(this.hp<=0){info_szoveg(n.nev+": "+this.nev+" resurrected.");this.hp=t;var r=parseInt(this.hp/this.max_hp*119);this.hp_csik_animalas(r);$("#portre_kep_"+this.id).html('<img width="40" src="'+this.kep+'">')}else{info_szoveg("Target is not dead!")}}else{if(this.hp>0){if(this.hp+t>this.max_hp){info_szoveg(n.nev+": restored "+(this.max_hp-this.hp)+" hp on "+this.nev);this.hp=this.max_hp}else{info_szoveg(n.nev+": restored "+t+" hp on "+this.nev);this.hp+=t}var r=parseInt(this.hp/this.max_hp*119);this.hp_csik_animalas(r)}else{info_szoveg("Target is dead, you need to resurrect him before heal.")}}};this.debuff_ellensegre=function(e,t){var n=new Array;n=this.sebzodo_ellensegek(0,e);var r=skillek.skill_adatok(e);var i={karakter_id:this.id,skill_id:r.id,debuff_ido:r.buff_hany_mpig_marad,elozo_tick:0,parameterek:t};for(var s=0;s<n.length;s++){n[s].debuffot_kap(i)}};this.sebzes_skillel=function(e,t){var n=1;var r=new Array;r=this.sebzodo_ellensegek(0,e);var i=skillek.skill_adatok(e);if(r.length>0){if(n==0){info_szoveg("Skill: Miss")}if(n==1){for(var s=0;s<r.length;s++){var o=r[s].statok;var u=parseInt(i.alap_sebzes*4+this.szint*(this.statok.power-o.defense)*i.alap_sebzes/16);console.log("damage:"+u);var a=parseInt(u*.1);var f=parseInt(u*.1)*-1;var u=u+randint(f,a);var l=null;if(i.dot!=0){var c=parseInt(i.dot*4+this.szint*(this.statok.power-o.defense)*i.dot/16);l={karakter_id:this.id,dot_damage:c,dot_ido:i.dot_ido,skill_id:i.id,elozo_tick:0};r[s].dotot_kap(l)}var h=r[s].sebzodes(u);var p="";p=this.nev+" attack with "+i.nev+": Hit! "+u+" damage";if(h.halott==1){p+=", Enemy Dead!"}info_szoveg(p);if(h.targy!=""){info_szoveg("Loot on the floor!")}}}}else{if(i.alap_sebzes!=0){info_szoveg(i.nev+": no target in line of sight.")}else{}}};this.sebzes_szamitas=function(e,t){var n={utes_eredmenye:"SIKERTELEN",mennyit_sebez:0,ellenseg_halott:0,targy:"",xpt_ad:0};var r=new Array;r=this.sebzodo_ellensegek(t,0);if(r.length>0){for(var i=0;i<r.length;i++){var s=r[i].statok;var o=targyak.targyadatok(t);var u=o.statok;var a=1;var f=randint(0,this.statok.dexterity+s.dexterity);if(f<=this.statok.dexterity){var a=1}else{var a=0}if(a==0){n.utes_eredmenye="SIKERTELEN"}if(a==1){n.utes_eredmenye="SIKERES";var l=randint(u.attack1,u.attack2);var c=parseInt(l*(1+(this.statok.power-s.defense)/100));var h=parseInt(c*.1);var p=parseInt(c*.1)*-1;var c=c+randint(p,h);n.mennyit_sebez=c;var d=null;var v=r[i].sebzodes(c);n.ellenseg_halott=v.halott;n.targy=v.targy;if(v.halott==1){}}}}else{n.utes_eredmenye="SIKERTELEN_NEM_LAT_SENKIT"}return n};this.mindenki_xpt_kap=function(e){for(i=0;i<karakterek.length;i++){if(karakterek[i].hp>0){var t=randint(-5,5);karakterek[i].xp+=e+t;console.log(karakterek[i].nev+"xp:"+karakterek[i].xp);$("#karakter_"+karakterek[i].id+"_xp").html(karakterek[i].xp);var n=karakterek[i].lepett_e_szintet();if(n.lepett_e==1){karakterek[i].szintlepes_kezelok();karakterek[i].elkoltheto_skill_pontok+=n.mennyit;$("#elkoltheto_skill_pont_"+karakterek[i].id).html(karakterek[i].elkoltheto_skill_pontok)}}}};this.lepett_e_szintet=function(){var e={lepett_e:0,mennyit:0,mennyi_pontot_oszthat:0};var t=this.szint;var n=this.xp;var r=0;for(var i=0;i<this.szintlepes_ertekek.length;i++){if(this.szintlepes_ertekek[i].xp>n){r=this.szintlepes_ertekek[i].szint;break}}if(r>this.szint+1){e.lepett_e=1;$("#portre_kep_szint_"+this.id).html("Level up!");var s=r-(this.szint+1);e.mennyit=s;var o=s*10;e.mennyi_pontot_oszthat=o}return e};this.css_animacio=function(e,t){var n=$("#karakter_"+this.id+"_kez_"+t).position();if(e.utes_eredmenye=="SIKERES"){hang_lejatszas(4,{pan:0,volume:100});var r="";r=this.nev+" attack: Hit! "+e.mennyit_sebez+" damage";if(e.ellenseg_halott==1){r+=", Enemy Dead!"}info_szoveg(r);if(e.targy!=""){info_szoveg("Loot on the floor!")}$("#karakter_"+this.id+"_kez_"+t).append("<div class='kez_fedo_sikeres' id='karakter_"+this.id+"_kez_"+t+"_fedo'>"+e.mennyit_sebez+"</div>");$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("left",-3);$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("top",-8)}if(e.utes_eredmenye=="SIKERTELEN_NEM_LAT_SENKIT"){hang_lejatszas(7,{pan:0,volume:100});info_szoveg(this.nev+" attack: No enemy in line of sight!");$("#karakter_"+this.id+"_kez_"+t).append("<div class='kez_fedo_miss' id='karakter_"+this.id+"_kez_"+t+"_fedo'></div>");$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("left",-3);$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("top",-8)}if(e.utes_eredmenye=="SIKERTELEN"){hang_lejatszas(7,{pan:0,volume:100});info_szoveg(this.nev+" attack: Miss! :(");$("#karakter_"+this.id+"_kez_"+t).append("<div class='kez_fedo_miss' id='karakter_"+this.id+"_kez_"+t+"_fedo'>MISS</div>");$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("left",-3);$("#karakter_"+this.id+"_kez_"+t+"_fedo").css("top",-8)}var i=this;var s=this.fegyver_van_e_a_kezben(t);var o=targyak.targyadatok(s);if(t==1){this.utesTimeout_balkez=setTimeout(function(){$("#karakter_"+i.id+"_kez_1_fedo").remove();i.balkez_eppen_ut=false},o.statok.sebesseg)}if(t==2){this.utesTimeout_jobbkez=setTimeout(function(){$("#karakter_"+i.id+"_kez_2_fedo").remove();i.jobbkez_eppen_ut=false},o.statok.sebesseg)}};this.minden_fegyverrol_cd_leszedes=function(){clearTimeout(this.utesTimeout_balkez);clearTimeout(this.utesTimeout_jobbkez);$("#karakter_"+this.id+"_kez_1_fedo").remove();$("#karakter_"+this.id+"_kez_2_fedo").remove();this.balkez_eppen_ut=false;this.jobbkez_eppen_ut=false};this.skillek_feltoltese=function(){for(var e=0;e<this.hasznalhato_skillek.length;e++){this.skill_skillbookba(this.hasznalhato_skillek[e])}$(".skill").qtip(tooltip_options)};this.skill_skillbookba=function(e){var t=$("#skills_"+this.id).children(".skills_elemek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()==""){var r=skillek.skill_adatok(e);$(n).append('<img title="'+r.leiras+'" class="skill" data-skill-id="'+r.id+'" src="'+r.ikon+'">');if(jQuery.inArray(e,this.megtanult_skillek)==-1){var s='<div title="'+r.leiras+'" class="skillbook_fedo" data-skill-id="'+r.id+'" ></div>';$(n).append(s)}$(".skill").qtip(tooltip_options);$(".skillbook_fedo").qtip(tooltip_options);break}}};this.portre_skillre_skill=function(e,t){var n=$("#portre_skill_ikonok_"+this.id).children(".portre_skill_egy_ikon");var r=n[t];var i=skillek.skill_adatok(e);$(r).append('<img title="'+i.leiras+'" class="skill" data-skill-id="'+i.id+'" src="'+i.ikon+'">');$(".skill").qtip(tooltip_options)};this.loot_taskaba_pontos_helyre=function(e,t){var n=$("#inventory_"+this.id).children("#inventory_elemek").children();var r=n[t];var i=targyak.targyadatok(e);$(r).append('<img title="'+i.targy_leirasa+'" class="item" data-item-id="'+i.id+'" src="assets/items/'+i.kep_fajl+'">');$(".item").qtip(tooltip_options);$(".item").draggable(inventory_draggable_options);$(".egy_taskahely").droppable(inventory_droppable_options)};this.loot_taskaba=function(e){if(this.van_e_helye()){var t=$("#inventory_"+this.id).children("#inventory_elemek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()==""){this.loot_taskaba_pontos_helyre(e,i);break}}this.inventory_objektum_frissitese();return true}else{return false}};this.penz_taskaba=function(e){this.penz+=e};this.van_e_helye=function(){var e=false;var t=$("#inventory_"+this.id).children("#inventory_elemek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()==""){e=true;break}}return e};this.sor_beallitas=function(e,t){this.hanyadik_sorban_van=e;this.sorban_melyik_oldal=t};this.hanyadik_a_karakterek_tombben=function(){for(i=0;i<karakterek.length;i++){if(this.id=karakterek[i].id){return i;break}}};this.van_e_nala_targy_id=function(e){var t=false;var n=targyak.targy_generalas(e);for(var r=0;r<this.inventory.length;r++){if(this.inventory[r]==n){t=true;break}}return t};this.targy_elvetele=function(e){var t=$("#inventory_"+this.id).children("#inventory_elemek").children();for(i=0;i<t.length;i++){var n=t[i];if($(n).html()!=""){if($(n).children().attr("data-item-id")==e){$(n).html("");break}}}this.inventory_objektum_frissitese()};this.targy_megsemmisitese_taskabol=function(e,t){if($("#"+e).children().attr("data-item-id")==t){$("#"+e).html("")}this.inventory_objektum_frissitese()};this.feltamasztas=function(){if(this.hp<=0){this.hp=parseInt(this.max_hp*.1);$("#portre_kep_"+this.id).html('<img width="40" src="'+this.kep+'">');var e=parseInt(this.hp/this.max_hp*119);this.hp_csik_animalas(e);info_szoveg(this.nev+" is resurrected.")}};this.szovegbuborek=function(e){$("#bubble_szoveg_"+this.id).html(e);var t=$("#portre_kep_"+this.id).position();$("#bubble_"+this.id).css("left",t.left-110);$("#bubble_"+this.id).css("top",t.top-10);$("#bubble_"+this.id).fadeIn(300);var n=this;setTimeout(function(){$("#bubble_"+n.id).hide()},2500)}}function Terkep(){this.id=0;this.nev="";this.KONYVTAR="assets/levels/";this.ellensegek=new Array;this.terkep_matrix;this.terkep_szelesseg;this.terkep_magassag;this.terkep_matrix_pathfindinghez;this.terkep_matrix_kiegeszitesek=new Array;this.ezen_van=0;this.texturak={};this.meta={};this.storyline=[];this.init=function(e){this.id=e;this.ezen_van=1;that=this;$.ajax({cache:false,async:false,url:this.KONYVTAR+this.id+"_dungeon.moon",dataType:"json",success:function(e){that.terkep_matrix=e;that.terkep_szelesseg=that.terkep_matrix[0].length;that.terkep_magassag=that.terkep_matrix.length}});$.ajax({cache:false,async:false,url:this.KONYVTAR+this.id+"_dungeon_extras.moon",dataType:"json",success:function(e){that.terkep_matrix_kiegeszitesek=e}});$.ajax({cache:false,async:false,url:this.KONYVTAR+this.id+"_dungeon_meta.moon",dataType:"json",success:function(e){that.meta=e;$("#terkep_neve").html(e.TERKEP_NEVE)}});for(var t=0;t<ideiglenes_terkepek.length;t++){if(ideiglenes_terkepek[t].id==this.id){break}}$.ajax({cache:false,async:false,url:this.KONYVTAR+this.id+"_dungeon_storyline.moon",dataType:"json",success:function(e){that.storyline=e}});this.terkep_dom_felepitese()};this.van_e_beszelgetes_a_pozicioban=function(e,t){var n=0;for(var r=0;r<this.storyline.length;r++){if(this.storyline[r].tipus=="pozicio"){if(this.storyline[r].x==e&&this.storyline[r].y==t){n=this.storyline[r].id}}}if(n!=0){if(jQuery.inArray(n,storyline_megtortent)==-1){this.beszelgetes_felepitese(n);return true}else{return false}}else{return false}};this.beszelgetes_felepitese=function(e){var t="";var n=[];for(var r=0;r<this.storyline.length;r++){if(this.storyline[r].id==e){n=this.storyline[r]}}var i=1;for(var r=0;r<n.sorok.length;r++){var s="";if(i==1){s='style="display:block"'}var o=karakter_hanyadik_a_tombben_id_alapjan(n.sorok[r].karakter_id);var u=karakterek[o].nev;var a=karakterek[o].kep;t+='<div class="sl_b_egysor" '+s+'><div class="sl_b_egysor_kep"  ><img src="'+a+'"></div><div class="sl_b_egysor_szoveg"><span>'+u+"</span>: "+n.sorok[r].szoveg+"</div></div>";i=0}t+='<div class="sl_b_egysor_utolso">Click to continue</div>';$("#storyline_beszelhetesek").html(t);var f=$("#storyline_beszelhetesek").children(".sl_b_egysor");var l=0;$("#storyline_beszelhetesek").off("click");$("#storyline_beszelhetesek").click(function(){hang_lejatszas(33,{pan:0,volume:60});var e=0;for(var t=l;t<f.length;t++){if($(f[t]).is(":visible")){e++}else{if(e>=4){$(f[l]).hide("slide",{direction:"left"},300,function(){$(f[t]).slideDown(300);l++})}else{$(f[t]).slideDown(300)}break}}if(l+e+1==f.length){$(".sl_b_egysor_utolso").html("Click to close")}if(l+e>=f.length){$("#storyline_beszelhetesek").hide()}});hang_lejatszas(41,{pan:0,volume:60});$("#storyline_beszelhetesek").show("slide",{direction:"left"},300);storyline_megtortent.push(e)};this.terkep_dom_felepitese=function(){var e=this.getTerkepMatrix();var t=this.getTerkepMatrixKiegeszitesek();var n=e[0].length;var r=e.length;var i=8;terkep_canvas=document.createElement("canvas");ctx=terkep_canvas.getContext("2d");terkep_canvas.setAttribute("width",n*i);terkep_canvas.setAttribute("height",r*i);terkep_canvas.setAttribute("id","terkep_tartalom_"+this.id);for(var s=0;s<n;s++){for(var o=0;o<r;o++){if(e[o][s]==1){ctx.fillStyle="black";ctx.fillStyle="rgba(0, 0, 0, .5)";ctx.fillRect(s*i,o*i,i,i)}else{ctx.fillStyle="white";ctx.fillRect(s*i,o*i,i,i)}}}for(var u=0;u<t.length;u++){var a=t[u];if(a.tipus=="AJTO1"||a.tipus=="AJTO2"){ctx.fillStyle="red";ctx.fillRect(a.x*i,a.y*i,i,i)}if(a.tipus=="NPC"){ctx.fillStyle="blue";ctx.fillRect(a.x*i,a.y*i,i,i)}if(a.tipus=="TELEPORT"){ctx.fillStyle="brown";ctx.fillRect(a.x*i,a.y*i,i,i)}if(a.tipus=="SZINTVALTAS_LE"||a.tipus=="SZINTVALTAS_FEL"){var f=0;var l=0;if(a.melyik_oldalon=="ESZAK"){l=1}ctx.fillStyle="green";ctx.fillRect((a.x+f)*i,(a.y+l)*i,i,i)}}$("#terkepek_terkep").append(terkep_canvas);$("#terkepek_szovegek_nev").html(this.meta.TERKEP_NEVE)};this.kiegeszitesek_pozicio_alapjan=function(e,t){var n=new Array;for(var r=0;r<this.terkep_matrix_kiegeszitesek.length;r++){if(this.terkep_matrix_kiegeszitesek[r].x==e&&this.terkep_matrix_kiegeszitesek[r].y==t){n.push(this.terkep_matrix_kiegeszitesek[r])}}return n};this.getTerkepKiegeszitesek=function(){return{ezen_van:this.ezen_van,id:this.id,terkep_matrix_kiegeszitesek:this.terkep_matrix_kiegeszitesek}};this.dungeon_felepitese=function(){var e=this.terkep_matrix;var t=this.terkep_matrix_kiegeszitesek;var n=this.terkep_szelesseg;var r=this.terkep_magassag;var i=new Elemek;var s=i.createPadlo({x:cubesize*n/2-cubesize/2,y:-38,z:cubesize*r/2-cubesize/2},{x:cubesize*n,y:0,z:cubesize*r},{x:n,y:r});scene.add(s);var s=i.createPlafon("assets/textures/"+this.meta.ALAP_PLAFON_TEXTURA,{x:cubesize*n/2-cubesize/2,y:38,z:cubesize*r/2-cubesize/2},{x:cubesize*n,y:0,z:cubesize*r},{x:n,y:r});scene.add(s);if(this.meta.ALAP_FAL_TEXTURA_NORMAL!=""&&this.meta.ALAP_FAL_TEXTURA_SPECULAR!=""){var o=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA_NORMAL);o.anisotropy=anisotropy;o.wrapS=THREE.RepeatWrapping;o.wrapT=THREE.RepeatWrapping;var u=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA_SPECULAR);u.anisotropy=anisotropy;u.wrapS=THREE.RepeatWrapping;u.wrapT=THREE.RepeatWrapping;var a=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA);a.anisotropy=anisotropy;a.wrapS=THREE.RepeatWrapping;a.wrapT=THREE.RepeatWrapping;var f=new THREE.Vector2(1,1);var l=new THREE.MeshPhongMaterial({map:a,normalMap:o,normalScale:f,specularMap:u,specular:16755578,shininess:180})}else{var o=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA);var l=new THREE.MeshPhongMaterial({map:o})}if(this.meta.ALAP_FAL_TEXTURA_NORMAL!=""&&this.meta.ALAP_FAL_TEXTURA_SPECULAR!=""){var o=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA_NORMAL,new THREE.Vector2(.3,1));o.anisotropy=anisotropy;o.repeat.x=.3;o.repeat.y=1;var u=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA_SPECULAR,new THREE.Vector2(.3,1));u.anisotropy=anisotropy;u.repeat.x=.3;u.repeat.y=1;var a=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA,new THREE.Vector2(.3,1));a.anisotropy=anisotropy;a.repeat.x=.3;a.repeat.y=1;var f=new THREE.Vector2(1,1);var c=new THREE.MeshPhongMaterial({map:a,normalMap:o,normalScale:f,specularMap:u,specular:16755578,shininess:180})}else{var u=getTextureFromCache("assets/textures/"+this.meta.ALAP_FAL_TEXTURA,new THREE.Vector2(.3,1));u.anisotropy=anisotropy;var c=new THREE.MeshPhongMaterial({map:u})}var h=new THREE.Geometry;var p=new THREE.Geometry;for(var d=0;d<n;d++){for(var v=0;v<r;v++){var m={x:cubesize,y:cubesize,z:cubesize};var g={x:m.x*d,y:0,z:m.z*v};if(e[v][d]==1){var y=new THREE.CubeGeometry(cubesize,cubesize_y,cubesize,1,1,1);var b=new THREE.Mesh(y,l);b.position.set(g.x,g.y,g.z);collidableMeshList.push(b);THREE.GeometryUtils.merge(h,b);if(this.meta.FAL_OSZLOPOK==1){var y=new THREE.CubeGeometry(cubesize-85,cubesize_y,cubesize-85,1,1,1);var b=new THREE.Mesh(y,c);b.position.set(g.x+50,g.y,g.z-50);THREE.GeometryUtils.merge(p,b);var y=new THREE.CubeGeometry(cubesize-85,cubesize_y,cubesize-85,1,1,1);var b=new THREE.Mesh(y,c);b.position.set(g.x-50,g.y,g.z+50);THREE.GeometryUtils.merge(p,b)}}}}var b=new THREE.Mesh(h,l);scene.add(b);collidableMeshList.push(b);var w=new THREE.Mesh(p,c);scene.add(w);for(var E=0;E<t.length;E++){var S=t[E];var g={x:S.x*cubesize,y:0,z:S.y*cubesize};if(S.tipus=="KEZDO_POZICIO"){MovingCube.position.set(S.x*cubesize,0,S.y*cubesize);MovingCube.rotation.y=rad(S.merre_nez)}if(S.tipus=="AJTO_TITKOS1"){var x=i.createDoorTitkos("assets/textures/"+this.meta.ALAP_FAL_TEXTURA,g,{x:cubesize,y:cubesize_y,z:cubesize},S.tipus,S);scene.add(x);aktiv_objektumok.push(new Array(S.id,x))}if(S.tipus=="AJTO1"||S.tipus=="AJTO2"){var x=i.createDoor("assets/textures/celldoor1.png",g,{x:cubesize-40,y:cubesize_y,z:20},S.tipus,S);scene.add(x);aktiv_objektumok.push(new Array(S.id,x))}if(S.tipus=="AJTO_KAPCSOLO1"){var T=S.ajto_id;var N=0;for(var C=0;C<aktiv_objektumok.length;C++){if(aktiv_objektumok[C][0]==T){N=aktiv_objektumok[C][1];break}}var s=i.createWallSwitch(g,N,S)}if(S.tipus=="AJTO_TITKOS1_KAPCSOLO1"){var T=S.ajto_id;var N=0;for(var C=0;C<aktiv_objektumok.length;C++){if(aktiv_objektumok[C][0]==T){N=aktiv_objektumok[C][1];break}}var s=i.createTitkosKapcsolo(g,N,S)}if(S.tipus=="KULCSLYUK"){var T=S.ajto_id;var N=0;for(var C=0;C<aktiv_objektumok.length;C++){if(aktiv_objektumok[C][0]==T){N=aktiv_objektumok[C][1];break}}var s=i.createKulcslyuk(g,N,S);scene.add(s)}if(S.tipus=="KULCSLYUK_AKTIV"){var T=S.ajto_id;var N=0;for(var C=0;C<aktiv_objektumok.length;C++){if(aktiv_objektumok[C][0]==T){N=aktiv_objektumok[C][1];break}}var s=i.createKulcslyukAktiv(g,N,S)}if(S.tipus=="UTJELZO_TABLA"){i.utjelzo_tabla_a_foldre(S.szoveg,g)}if(S.tipus=="TARGY"){i.targy_a_foldre(S,g)}if(S.tipus=="SZINTVALTAS_LE"){i.lepcso_le(S,g)}if(S.tipus=="SZINTVALTAS_FEL"){i.lepcso_fel(S,g)}if(S.tipus=="ELLENSEG"){var k=new Enemy(S,g);k.create()}if(S.tipus=="TABLA_FALRA"){i.tabla_falra(S,g)}if(S.tipus=="NPC"){var L=new Npc(S,g);L.create()}if(S.tipus=="LADA"){i.laba_foldre(S,g)}if(S.tipus=="TELEPORT"){i.teleport(S,g)}if(S.tipus=="FAKLYA"){i.faklya(S,g)}if(S.tipus=="FELTAMASZTAS"){i.feltamasztas(S,g)}}fenyek_bekapcsolasa3()};this.van_e_ajto_a_pozicioban=function(e,t){var n=false;for(var r=0;r<this.terkep_matrix_kiegeszitesek.length;r++){if(this.terkep_matrix_kiegeszitesek[r].tipus=="AJTO1"||this.terkep_matrix_kiegeszitesek[r].tipus=="AJTO2"||this.terkep_matrix_kiegeszitesek[r].tipus=="AJTO3"||this.terkep_matrix_kiegeszitesek[r].tipus=="AJTO4"||this.terkep_matrix_kiegeszitesek[r].tipus=="AJTO5"){if(this.terkep_matrix_kiegeszitesek[r].x==e&&this.terkep_matrix_kiegeszitesek[r].y==t){n=true}}}return n};this.hol_a_legkozelebbi_ures_hely=function(e,t){var n={x:0,y:0};var r=e;var i=t-1;console.log(r);console.log(i);console.log("TERKEP hol_a_legkozelebbi_ures_hely TODO! tobbet is vizsgalni kell");console.log(this.terkep_matrix);console.log(this.terkep_matrix[r][i]);if(this.terkep_matrix[i][r]==0){n.x=r;n.y=i}return n};this.kezdo_pozicio_frissitese_forgas=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].tipus=="KEZDO_POZICIO"){this.terkep_matrix_kiegeszitesek[t].merre_nez=deg(e);break}}};this.kezdo_pozicio_frissitese=function(e,t){for(var n=0;n<this.terkep_matrix_kiegeszitesek.length;n++){if(this.terkep_matrix_kiegeszitesek[n].tipus=="KEZDO_POZICIO"){this.terkep_matrix_kiegeszitesek[n].x=e;this.terkep_matrix_kiegeszitesek[n].y=t;break}}};this.targy_felveve=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].id==e){this.terkep_matrix_kiegeszitesek.splice(t,1);break}}};this.ellenseg_meghalt=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].id==e){this.terkep_matrix_kiegeszitesek.splice(t,1);break}}};this.feltamasztas=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].id==e){this.terkep_matrix_kiegeszitesek[t].hanyszor_hasznalta=1;break}}};this.lada_kinyitva=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].id==e){this.terkep_matrix_kiegeszitesek[t].kinyitva="IGEN";break}}};this.sima_ajto_kinyitva=function(e){for(var t=0;t<this.terkep_matrix_kiegeszitesek.length;t++){if(this.terkep_matrix_kiegeszitesek[t].id==e){this.terkep_matrix_kiegeszitesek[t].kinyitva="IGEN";break}}};this.titkos_ajto_kinyitva=function(e,t){for(var n=0;n<this.terkep_matrix_kiegeszitesek.length;n++){if(this.terkep_matrix_kiegeszitesek[n].id==e){this.terkep_matrix_kiegeszitesek[n].kinyitva="IGEN";break}}for(var n=0;n<this.terkep_matrix_kiegeszitesek.length;n++){if(this.terkep_matrix_kiegeszitesek[n].id==t){this.terkep_matrix_kiegeszitesek[n].kinyitva="IGEN";break}}};this.zart_ajto_kinyitva=function(e,t){for(var n=0;n<this.terkep_matrix_kiegeszitesek.length;n++){if(this.terkep_matrix_kiegeszitesek[n].id==e){this.terkep_matrix_kiegeszitesek[n].kinyitva="IGEN";break}}for(var n=0;n<this.terkep_matrix_kiegeszitesek.length;n++){if(this.terkep_matrix_kiegeszitesek[n].id==t){this.terkep_matrix_kiegeszitesek[n].kinyitva="IGEN";break}}};this.getTerkepMatrix=function(){var e;e=this.terkep_matrix;return e};this.getTerkepMatrix_pathfindinghez=function(){var e=this.getTerkepMatrix();for(var t=0;t<this.terkep_szelesseg;t++){for(var n=0;n<this.terkep_magassag;n++){var r=this.kiegeszitesek_pozicio_alapjan(t,n);for(var i=0;i<r.length;i++){if(r[i].tipus=="AJTO1"||r[i].tipus=="AJTO_TITKOS1"||r[i].tipus=="AJTO2"){}}}}return e};this.getTerkepMatrixKiegeszitesek=function(){return this.terkep_matrix_kiegeszitesek}}var tutorial_hol_jar=0;var tooltip_options={content:{attr:"title"},style:{classes:"ui-tooltip-tipped"},position:{my:"top left",target:"mouse",viewport:$(window),adjust:{x:10,y:10}}};var skills_draggable_options={helper:"clone",stack:".skill",start:function(e,t){var n=true;var r=$(t.helper).attr("data-skill-id");var i=$(t.helper).parent().parent().attr("data-karakter-id");var s=$("#portre_skill_ikonok_"+i).children();for(var o=0;o<s.length;o++){if($(s[o]).children().length!=0){if($(s[o]).children().attr("data-skill-id")==r){n=false;info_szoveg("This skill is already in your the skill bar!");break}}}var u=skillek.skill_adatok(r);var a=karakter_hanyadik_a_tombben_id_alapjan(i);if(u.szint>karakterek[a].szint){n=false;hang_lejatszas(38,{pan:0,volume:40});info_szoveg("Your level is not high enough to use that skill!")}return n},stop:function(e,t){},drag:function(e,t){},scroll:false,cursor:"default",revert:"invalid",revertDuration:100};var portre_skill_droppable_options={hoverClass:"karakterlap_egy_taskahely_drop-hover",activeClass:"portre_skill_egy_ikon_aktiv",tolerance:"intersect",accept:function(e){var t=$(e).parent().parent().attr("data-karakter-id");var n=$(this).parent().attr("data-karakter-id");if(e.hasClass("skill")&&t==n){var r=skillek.skill_adatok($(e).attr("data-skill-id"));var i=karakter_hanyadik_a_tombben_id_alapjan(t);if(r.szint<=karakterek[i].szint){return true}else{return false}}else{return false}},drop:function(e,t){t.draggable.attr("style","");var n=$(this).attr("id");var r=t.draggable.parent().attr("id");var i=r.substring(0,11);$("#"+n).html($(t.draggable));$("#"+r).html($(t.draggable).clone());$(".skill").draggable(skills_draggable_options);var s=$(this).parent().attr("data-karakter-id");var o=karakter_hanyadik_a_tombben_id_alapjan(s);karakterek[o].portre_skillek_objektum_frissitese();hang_lejatszas(8,{pan:0,volume:17});mozgas_logolas("SKILLT BERAK skill:"+n+" melyik_karakter:"+s+" melyikbol_jott:"+r);$(".skill").qtip(tooltip_options)},over:function(e,t){},deactivate:function(e,t){}};var inventory_draggable_options={stack:".item",start:function(e,t){$(".item").qtip("destroy")},stop:function(e,t){$(".item").qtip(tooltip_options)},drag:function(e,t){},scroll:false,cursor:"default",revert:"invalid",revertDuration:100,snapMode:"inner"};var karakterlap_draggable_options={stack:".item",start:function(e,t){$(".item").qtip("destroy");$(".inventory_hatter").css("z-index","9")},stop:function(e,t){$(".item").qtip(tooltip_options)},scroll:false,cursor:"default",revert:"invalid",revertDuration:100,snapMode:"inner"};var inventory_droppable_options={hoverClass:"karakterlap_egy_taskahely_drop-hover",accept:function(e){if($(this).children().length==0&&(e.hasClass("item")||e.hasClass("item_karakterrol"))){return true}else{return false}},drop:function(e,t){$(".inventory_hatter").css("z-index","10");hang_lejatszas(8,{pan:0,volume:20});t.draggable.attr("style","");var n=$(this).attr("id");var r=t.draggable.parent().attr("id");var i=r.substring(0,11);if(i=="karakterlap"){var s=t.draggable.parent().parent().parent().attr("id").substring(12);var o=$("#karekterlap_"+s).children("#karekterlap_felszerelesek").children("#"+r);$("#"+n).html(o.html());$("#"+n).children().attr("style","position: relative");$("#"+n).children().draggable(inventory_draggable_options);o.html("");karakterek[s-1].statok_ujraszamolas()}else{var s=$(this).parent().parent().attr("id").substring(10);$("#"+n).html($("#"+r).html());$("#"+n).children().attr("style","position: relative");$("#"+n).children().draggable(inventory_draggable_options);$("#"+r).html("")}$(".item").qtip(tooltip_options);if(r=="karakterlap_bal_kez"){$("#karakter_"+s+"_kez_1").html("")}if(r=="karakterlap_jobb_kez"){$("#karakter_"+s+"_kez_2").html("")}var u=karakter_hanyadik_a_tombben_id_alapjan(s);karakterek[u].inventory_objektum_frissitese();karakterek[u].karakterlap_objektum_frissitese()},over:function(e,t){},deactivate:function(e,t){}};var karakterlap_felszereles_droppable_options={hoverClass:"karakterlap_egy_taskahely_drop-hover",accept:function(e){var t=false;var n=e.attr("data-item-id");var r=targyak.targyadatok(n);var i=$(this).attr("id");if(r.fokategoria=="fegyver"||r.fokategoria=="pancel"||r.fokategoria=="kiegeszito"){if(r.fokategoria=="fegyver"&&(i=="karakterlap_bal_kez"||i=="karakterlap_jobb_kez")){t=true}if(r.fokategoria=="pancel"){if(r.alkategoria=="sapka"&&i=="karakterlap_fej"){t=true}if(r.alkategoria=="kesztyu"&&(i=="karakterlap_jobb_kez_kesztyu"||i=="karakterlap_bal_kez_kesztyu")){t=true}if(r.alkategoria=="mellvert"&&i=="karakterlap_torzs"){t=true}if(r.alkategoria=="cipo"&&i=="karakterlap_cipo"){t=true}if(r.alkategoria=="ov"&&i=="karakterlap_ov"){t=true}if(r.alkategoria=="nadrag"&&i=="karakterlap_nadrag"){t=true}}if(r.fokategoria=="kiegeszito"){if(r.alkategoria=="nyaklanc"&&i=="karakterlap_nyak"){t=true}if(r.alkategoria=="gyuru"&&(i=="karakterlap_bal_kez_gyuru"||i=="karakterlap_jobb_kez_gyuru")){t=true}}}return t},drop:function(e,t){t.draggable.attr("style","");var n=$(this).attr("id");var r=t.draggable.parent().attr("id");var i=r.substring(0,11);var s=$(this).parent().parent().attr("id").substring(12);if(i=="karakterlap"){var o=t.draggable.parent().parent().parent().attr("id").substring(12);if(o==s){var u=$("#karekterlap_"+s).children("#karekterlap_felszerelesek").children("#"+n);var a=$("#karekterlap_"+s).children("#karekterlap_felszerelesek").children("#"+r);u.html(a.html());u.children().draggable(karakterlap_draggable_options);a.html("")}else{var u=$("#karekterlap_"+s).children("#karekterlap_felszerelesek").children("#"+n);var a=$("#karekterlap_"+o).children("#karekterlap_felszerelesek").children("#"+r);u.html(a.html());u.children().draggable(karakterlap_draggable_options);a.html("")}karakterek[o-1].statok_ujraszamolas()}else{var u=$("#karekterlap_"+s).children("#karekterlap_felszerelesek").children("#"+n);u.html($("#"+r).html());u.children().attr("style","position: relative");u.children().draggable(karakterlap_draggable_options);$("#"+r).html("")}$(".item").qtip(tooltip_options);var f=t.draggable.attr("data-item-id");var l=targyak.targyadatok(f);if(o==s){if(r=="karakterlap_bal_kez"){$("#karakter_"+s+"_kez_1").html("")}if(r=="karakterlap_jobb_kez"){$("#karakter_"+s+"_kez_2").html("")}}else{if(r=="karakterlap_bal_kez"){$("#karakter_"+o+"_kez_1").html("")}if(r=="karakterlap_jobb_kez"){$("#karakter_"+o+"_kez_2").html("")}}karakterek[s-1].statok_ujraszamolas();if(n=="karakterlap_bal_kez"){$("#karakter_"+s+"_kez_1").html('<img src="assets/items/'+l.kep_fajl+'">')}if(n=="karakterlap_jobb_kez"){$("#karakter_"+s+"_kez_2").html('<img src="assets/items/'+l.kep_fajl+'">')}var c=karakter_hanyadik_a_tombben_id_alapjan(s);karakterek[c].inventory_objektum_frissitese();karakterek[c].karakterlap_objektum_frissitese()},over:function(e,t){},deactivate:function(e,t){}};$(document).ready(function(){$.contextMenu({selector:".item",trigger:"left",build:function(e,t){var n=e.attr("data-item-id");var r=null;var i=null;var s=new Array;if(e.parent().hasClass("egy_taskahely")){var o=e.parent().attr("id");var r=e.parent().parent().attr("data-karakter-id");var u=karakter_hanyadik_a_tombben_id_alapjan(r);var a=new Object;for(var f=0;f<karakterek.length;f++){var l="giveto_"+karakterek[f].id;s.push(l);if(karakterek[f].id==r){a[l]={name:karakterek[f].nev,disabled:true}}else{a[l]={name:karakterek[f].nev}}}items_kattintastol_fuggoen={use:{name:"Use"},equip:{name:"Equip"},indentify:{name:"Indentify",disabled:true},almenu1:{name:"Give to ...",items:a},sep1:"---------",destroy:{name:"Destroy"}}}if(e.parent().hasClass("karakterlap_felszereles")){var c=e.parent().attr("id");var r=e.parent().parent().attr("data-karakter-id");var u=karakter_hanyadik_a_tombben_id_alapjan(r);items_kattintastol_fuggoen={unequip:{name:"Move to inventory"}}}return{callback:function(e,t){if(e=="destroy"){var i=confirm("Are you sure?");if(i){karakterek[u].targy_megsemmisitese_taskabol(o,n)}}if(e=="equip"){targy_equip(o,n,r)}if(e=="unequip"){targy_unequip(c,n,r)}if(e=="use"){targy_use(o,n,r)}for(var a=0;a<s.length;a++){if(e==s[a]){var f=s[a].substr(7,1);targy_atadas(o,n,r,f)}}var l="clicked: "+e+" iemid:"+n},items:items_kattintastol_fuggoen}}});$(this).bind("contextmenu",function(e){});$(".skills_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".forge_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".achievements_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".gems_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".kuldi_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".inventory_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".karekterlap_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$(".abilities_hatter").draggable({scroll:false,cursor:"move",handle:".lapok_dragndrop"});$("#menuk_jatek_menu").click(function(){jatek_menu_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#menuk_terkep").click(function(){terkep_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#menuk_forge").click(function(){forge_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#menuk_achievements").click(function(){achievements_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#menuk_gems").click(function(){gems_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#menuk_artifakt").click(function(){artifakt_toogle();hang_lejatszas(33,{pan:0,volume:80})});$("#jatek_menu_exit").click(function(){document.location="index.php"});$("#jatek_menu_load").click(function(){alert("Exit to main menu and load from there. ( this menu is under develpoment )")});$("#jatek_menu_options").click(function(){alert("Under development.")});$("#jatek_menu_mentes").click(function(){var e="";var t=new Array;for(var n=0;n<npck.length;n++){t.push({npc_id:npck[n].id,adatok:npck[n].targyak})}$.ajax({type:"POST",url:"ajax_jatek_mentese.php",data:{screen:e,karakterek:JSON.stringify(karakterek),terkep:JSON.stringify(ideiglenes_terkepek),npck:JSON.stringify(t)},success:function(e){info_szoveg("Game saved.");jatek_menu_toogle()}})});$(".artifact_runa").qtip(tooltip_options);$(".item").qtip(tooltip_options);$(".item_chatben").qtip(tooltip_options);$(".item").draggable(inventory_draggable_options);$(".egy_taskahely").droppable(inventory_droppable_options);$(".lapok_bezar").click(function(){var e=$(this).attr("data-id");$("#"+e).fadeOut(300)});$("#cutscenes").click(function(){clearInterval(cutscene);var e=100;intro_hang_fade=setInterval(function(){mySound.setVolume(e);e-=1;if(e<=1){mySound.stop();$("#cutscenes").hide();init();clearInterval(intro_hang_fade)}},1)});info_szoveg("Welcome to Moonshades! Version: 0.1 alpha");info_szoveg("Press F11 to go into fullscreen mode!");info_szoveg("Please bear in mind its an early alpha version :)")});var fade_time=2500;var cutscenes_length=3;var elso=0;var mySound;var sound_ambient1;var hangok_betoltesre=new Array;hangok_betoltesre.push(new Array("27","assets/audio/57714__dj-chronos__metal-atmosphere-001.ogg",0));hangok_betoltesre.push(new Array("0","assets/audio/sword-unsheathe.ogg",0));hangok_betoltesre.push(new Array("3","assets/audio/stepstone_1.ogg",0));hangok_betoltesre.push(new Array("4","assets/audio/sword-unsheathe.ogg",0));hangok_betoltesre.push(new Array("5","assets/audio/cloth-heavy.ogg",0));hangok_betoltesre.push(new Array("6","assets/audio/random5.ogg",0));hangok_betoltesre.push(new Array("7","assets/audio/swing.ogg",0));hangok_betoltesre.push(new Array("8","assets/audio/armor-light.ogg",0));hangok_betoltesre.push(new Array("9","assets/audio/cloth-heavy.ogg",0));hangok_betoltesre.push(new Array("10","assets/audio/18048__dobroide__20060413-doorlock_2.ogg",0));hangok_betoltesre.push(new Array("11","assets/audio/pain3.ogg",0));hangok_betoltesre.push(new Array("12","assets/audio/3yell1.ogg",0));hangok_betoltesre.push(new Array("13","assets/audio/2yell4.ogg",0));hangok_betoltesre.push(new Array("14","assets/audio/monster-17.ogg",0));hangok_betoltesre.push(new Array("15","assets/audio/interface1.ogg",0));hangok_betoltesre.push(new Array("16","assets/audio/skull_hit_2.ogg",0));hangok_betoltesre.push(new Array("17","assets/audio/merchant_female1.mp3",0));hangok_betoltesre.push(new Array("18","assets/audio/merchant_female1.mp3",0));hangok_betoltesre.push(new Array("19","assets/audio/merchant_female1.mp3",0));hangok_betoltesre.push(new Array("20","assets/audio/stepdirt_1.ogg",0));hangok_betoltesre.push(new Array("28","assets/audio/skull_hit_2.ogg",0));hangok_betoltesre.push(new Array("29","assets/audio/qubodup-DoorOpen01.ogg",0));hangok_betoltesre.push(new Array("30","assets/audio/Fireball.ogg",0));hangok_betoltesre.push(new Array("31","assets/audio/Heal.ogg",0));hangok_betoltesre.push(new Array("32","assets/audio/coin.ogg",0));hangok_betoltesre.push(new Array("33","assets/audio/skull_hit_2.ogg",0));hangok_betoltesre.push(new Array("34","assets/audio/stepdirt_1.ogg",0));hangok_betoltesre.push(new Array("35","assets/audio/stepdirt_2.ogg",0));hangok_betoltesre.push(new Array("36","assets/audio/stepdirt_3.ogg",0));hangok_betoltesre.push(new Array("37","assets/audio/stepdirt_8.ogg",0));hangok_betoltesre.push(new Array("38","assets/audio/negative_2.ogg",0));hangok_betoltesre.push(new Array("39","assets/audio/99197__robinhood76__01735-falling-great-wall_2.ogg",0));hangok_betoltesre.push(new Array("40","assets/audio/55843__sergenious__port.ogg",0));hangok_betoltesre.push(new Array("41","assets/audio/load.mp3",0));hangok_betoltesre.push(new Array("42","assets/audio/listentome.mp3",0));hangok_betoltesre.push(new Array("43","assets/audio/146733__fins__energy.ogg",0));hangok_betoltesre.push(new Array("45","assets/audio/skills/fire_blast.ogg",0));hangok_betoltesre.push(new Array("46","assets/audio/skills/magic_arrow.ogg",0));hangok_betoltesre.push(new Array("47","assets/audio/skills/blessing.ogg",0));hangok_betoltesre.push(new Array("48","assets/audio/skills/yourweakness.ogg",0));hangok_betoltesre.push(new Array("49","assets/audio/skills/protect.ogg",0));hangok_betoltesre.push(new Array("50","assets/audio/skills/martyr.ogg",0));hangok_betoltesre.push(new Array("51","assets/audio/skills/flamingagony.ogg",0));hangok_betoltesre.push(new Array("52","assets/audio/skills/meteorshower.ogg",0));hangok_betoltesre.push(new Array("53","assets/audio/skills/scorch.ogg",0));hangok_betoltesre.push(new Array("54","assets/audio/skills/astralshield.ogg",0));hangok_betoltesre.push(new Array("55","assets/audio/skills/letyourhatred.ogg",0));hangok_betoltesre.push(new Array("56","assets/audio/skills/resurect.ogg",0));hangok_betoltesre.push(new Array("57","assets/audio/skills/weakentheir.ogg",0));hangok_betoltesre.push(new Array("58","assets/audio/skills/punishthem.ogg",0));hangok_betoltesre.push(new Array("59","assets/audio/skills/judgement.ogg",0));hangok_betoltesre.push(new Array("60","assets/audio/skills/willingto.ogg",0));hangok_betoltesre.push(new Array("61","assets/audio/skills/finalcharge.ogg",0));hangok_betoltesre.push(new Array("62","assets/audio/skills/standunited.ogg",0));hangok_betoltesre.push(new Array("63","assets/audio/skills/makethembleed.ogg",0));hangok_betoltesre.push(new Array("64","assets/audio/skills/rallyingshout.ogg",0));hangok_betoltesre.push(new Array("65","assets/audio/skills/heroespres.ogg",0));hangok_betoltesre.push(new Array("66","assets/audio/skills/onmymark.ogg",0));hangok_betoltesre.push(new Array("67","assets/audio/skills/corruption.ogg",0));hangok_betoltesre.push(new Array("68","assets/audio/skills/suddendeath.ogg",0));hangok_betoltesre.push(new Array("69","assets/audio/skills/nightmaire.ogg",0));hangok_betoltesre.push(new Array("70","assets/audio/skills/huricane.ogg",0));hangok_betoltesre.push(new Array("71","assets/audio/skill_learned.ogg",0));hangok_betoltesre.push(new Array("72","assets/audio/skeleton/serul1.ogg",0));hangok_betoltesre.push(new Array("73","assets/audio/skeleton/serul2.ogg",0));hangok_betoltesre.push(new Array("74","assets/audio/skeleton/serul3.ogg",0));hangok_betoltesre.push(new Array("75","assets/audio/antlion/serul1.ogg",0));hangok_betoltesre.push(new Array("76","assets/audio/antlion/serul2.ogg",0));hangok_betoltesre.push(new Array("77","assets/audio/antlion/serul3.ogg",0));hangok_betoltesre.push(new Array("78","assets/audio/spider/serul1.ogg",0));hangok_betoltesre.push(new Array("79","assets/audio/spider/serul2.ogg",0));hangok_betoltesre.push(new Array("80","assets/audio/spider/serul3.ogg",0));hangok_betoltesre.push(new Array("1","assets/audio/spider/serul1.ogg",0));Number.prototype.pad=function(e){return((new Array(e+1)).join("0")+this).slice(-e)};var removeByAttr=function(e,t,n){var r=e.length;while(r--){if(e[r]&&e[r][t]&&arguments.length>2&&e[r][t]===n){e.splice(r,1)}}return e};jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,($(window).height()-this.outerHeight())/2+$(window).scrollTop())+"px");this.css("left",Math.max(0,($(window).width()-this.outerWidth())/2+$(window).scrollLeft())+"px");return this};var lada_kinyitva_timeout;var toltes_hanyszor_kapcsolt_be=0;var Targyak={};Targyak=function(){this.targyak=[[1,"basic","short_sword1.png","Short Sword","fegyver","kard","7000","20","25","1","13","10","0","10","1","1"],[2,"basic","short_sword1.png","Short Sword","fegyver","kard","7000","20","25","1","10","13","0","10","1","1"],[3,"basic","short_sword1.png","Short Sword","fegyver","kard","7000","20","25","1","10","10","0","13","1","1"],[4,"basic","short_sword1.png","Short Sword","fegyver","kard","7000","20","25","1","10","10","0","10","2","1"],[5,"fine","short_sword1.png","Short Sword Of Power","fegyver","kard","7000","25","30","1","15","10","0","10","1","1"],[6,"fine","short_sword1.png","Short Sword Of Dexterity","fegyver","kard","7000","25","30","1","10","15","0","10","1","1"],[7,"fine","short_sword1.png","Short Sword Of Vitality","fegyver","kard","7000","25","30","1","10","10","0","15","1","1"],[8,"fine","short_sword1.png","Short Sword Of Luck","fegyver","kard","7000","25","30","1","10","10","0","10","3","1"],[9,"masterwork","short_sword1.png","Short Sword Of Greater Power","fegyver","kard","7000","30","35","1","17","10","0","10","1","1"],[10,"masterwork","short_sword1.png","Short Sword Of Greater Dexterity","fegyver","kard","7000","30","35","1","10","17","0","10","1","1"],[11,"masterwork","short_sword1.png","Short Sword Of Greater Vitality","fegyver","kard","7000","30","35","1","10","10","0","17","1","1"],[12,"masterwork","short_sword1.png","Short Sword Of Greater Luck","fegyver","kard","7000","30","35","1","10","10","0","10","4","1"],[13,"rare","short_sword1.png","Arcane Shortsword of Death","fegyver","kard","7000","35","40","1","20","10","0","10","1","1"],[14,"rare","short_sword1.png","Eternal Shortsword of the Hero","fegyver","kard","7000","35","40","1","10","20","0","10","1","1"],[15,"rare","short_sword1.png","Runic Shortsword of the Underworld","fegyver","kard","7000","35","40","1","10","10","0","20","1","1"],[16,"rare","short_sword1.png","Sharp Shortsword of Hope","fegyver","kard","7000","35","40","1","10","10","0","10","5","1"],[100,"basic","crossbow1.png","Crossbow","fegyver","szamszerij","7000","30","35","2","10","10","10","10","1","1"],[101,"fine","crossbow1.png","Crossbow Of Power","fegyver","szamszerij","7000","30","35","2","15","10","0","10","1","1"],[102,"fine","crossbow1.png","Crossbow Of Dexterity","fegyver","szamszerij","7000","30","35","2","10","15","0","10","1","1"],[103,"fine","crossbow1.png","Crossbow Of Vitality","fegyver","szamszerij","7000","30","35","2","10","10","0","15","1","1"],[104,"fine","crossbow1.png","Crossbow Of Luck","fegyver","szamszerij","7000","30","35","2","10","10","0","10","2","1"],[105,"masterwork","crossbow1.png","Crossbow Of Power","fegyver","szamszerij","7000","30","35","2","15","10","0","10","1","1"],[106,"masterwork","crossbow1.png","Crossbow Of Dexterity","fegyver","szamszerij","7000","30","35","2","10","15","0","10","1","1"],[107,"masterwork","crossbow1.png","Crossbow Of Vitality","fegyver","szamszerij","7000","30","35","2","10","10","0","15","1","1"],[108,"masterwork","crossbow1.png","Crossbow Of Luck","fegyver","szamszerij","7000","30","35","2","10","10","0","10","2","1"],[109,"rare","crossbow1.png","Crossbow Of Power","fegyver","szamszerij","7000","30","35","2","15","10","0","10","1","1"],[110,"rare","crossbow1.png","Crossbow Of Dexterity","fegyver","szamszerij","7000","30","35","2","10","15","0","10","1","1"],[111,"rare","crossbow1.png","Crossbow Of Vitality","fegyver","szamszerij","7000","30","35","2","10","10","0","15","1","1"],[112,"rare","crossbow1.png","Crossbow Of Luck","fegyver","szamszerij","7000","30","35","2","10","10","0","10","2","1"],[115,"basic","broad_axe1.png","Axe","fegyver","fejsze","7000","20","34","1","10","10","0","10","1","1"],[130,"basic","knife.png","Knife","fegyver","kes","7000","20","34","1","10","10","0","10","1","1"],[150,"basic","flail1.png","Flail","fegyver","csephadaro","7000","20","34","1","10","10","0","10","1","1"],[170,"basic","halberd1.png","Halberd","fegyver","alabard","7000","20","34","1","10","10","0","10","1","1"],[190,"basic","hammer1.png","Hammer","fegyver","kalapacs","7000","20","34","1","10","10","0","10","1","1"],[210,"basic","morningstar1.png","Morningstar","fegyver","morningstar","7000","20","34","1","10","10","0","10","1","1"],[230,"basic","quarterstaff.png","Quarterstaff","fegyver","vivobot","7000","20","34","1","10","10","0","10","1","1"],[250,"basic","scythe1.png","Scythe","fegyver","kasza","7000","20","34","1","10","10","0","10","1","1"],[270,"basic","trident1.png","Trident","fegyver","szigony","7000","20","34","1","10","10","0","10","1","1"],[290,"basic","spear2.png","Spear","fegyver","landzsa","7000","20","34","1","10","10","0","10","1","1"],[310,"basic","sling1.png","Sling","fegyver","csuzli","7000","20","34","2","10","10","0","10","1","1"],[330,"basic","bow1.png","Bow","fegyver","ij","7000","20","34","2","10","10","0","10","1","1"],[350,"basic","shield3_round.png","Shield","fegyver","pajzs","7000","","","1","10","10","10","10","1",""],[370,"basic","greatsword1.png","Greatsword","fegyver","ketkezes_kard","7000","20","34","1","10","10","0","10","1","1"],[390,"basic","katana2.png","Katana","fegyver","katana","7000","20","34","1","10","10","0","10","1","1"],[410,"basic","scimitar1.png","Scimitar","fegyver","scimitar","7000","20","34","1","10","10","0","10","1","1"],[430,"basic","falchion1.png","Falchion","fegyver","falchion","7000","20","34","1","10","10","0","10","1","1"],[450,"basic","staff07.png","Staff","fegyver","bot","7000","20","34","1","10","10","0","10","1","1"],[470,"basic","gem_bone.png","Wand","fegyver","palca","7000","20","34","1","10","10","0","10","1","1"],[1001,"fine","runes/rune_cerebov.png","Cerebov Rune","dragako","runa","","","","","10","10","","","","",[{leiras:"Can be embedded into weapon or armor."}]],[1002,"fine","runes/rune_cocytus.png","Cocytus Rune","dragako","runa","","","","","10","","10","","","",[{leiras:"Can be embedded into weapon or armor."}]],[1003,"fine","runes/rune_dis.png","Dis Rune","dragako","runa","","","","","10","","","10","","",[{leiras:"Can be embedded into weapon or armor."}]],[1004,"fine","runes/rune_gehenna.png","Gehenna Rune","dragako","runa","","","","","","10","10","","","",[{leiras:"Can be embedded into weapon or armor."}]],[1005,"fine","runes/rune_gloorx_vloq.png","Gloorx vloq Rune","dragako","runa","","","","","","10","","10","","",[{leiras:"Can be embedded into weapon or armor."}]],[1006,"fine","runes/rune_lom_lobon.png","Lom Lobon Rune","dragako","runa","","","","","","","10","10","","",[{leiras:"Can be embedded into weapon or armor."}]],[1007,"fine","runes/rune_mnoleg.png","Mnoleg Rune","dragako","runa","","","","","","","","","5","",[{leiras:"Can be embedded into weapon or armor."}]],[1008,"fine","runes/rune_tartarus.png","Tartarus Rune","dragako","runa","","","","","3","3","3","3","1","",[{leiras:"Can be embedded into weapon or armor."}]],[6e3,"fine","key.png","Golden key","kulcs","kulcs","","","","","","","","","",""],[6001,"fine","key.png","Old Golden key","kulcs","kulcs","","","","","","","","","",""],[6002,"fine","mirror.png","Mirror","kulcs","tukor","","","","","","","","","",""],[6003,"fine","book_of_the_dead.png","Book of the Dead","kulcs","konyv","","","","","","","","","",""],[2e3,"basic","armors/chain_mail1.png","Chain Mail","pancel","mellvert","","","","","13","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2001,"basic","armors/chain_mail1.png","Chain Mail","pancel","mellvert","","","","","10","13","10","10","1","1",[{pancel_anyaga:"plate"}]],[2002,"basic","armors/chain_mail1.png","Chain Mail","pancel","mellvert","","","","","10","10","13","10","1","1",[{pancel_anyaga:"plate"}]],[2003,"basic","armors/chain_mail1.png","Chain Mail","pancel","mellvert","","","","","10","10","10","13","1","1",[{pancel_anyaga:"plate"}]],[2004,"basic","armors/chain_mail1.png","Chain Mail","pancel","mellvert","","","","","10","10","10","10","2","1",[{pancel_anyaga:"plate"}]],[2005,"fine","armors/chain_mail1.png","Chain Mail Of Power","pancel","mellvert","","","","","15","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2006,"fine","armors/chain_mail1.png","Chain Mail Of Dexterity","pancel","mellvert","","","","","10","15","10","10","1","1",[{pancel_anyaga:"plate"}]],[2007,"fine","armors/chain_mail1.png","Chain Mail Of Defense","pancel","mellvert","","","","","10","10","15","10","1","1",[{pancel_anyaga:"plate"}]],[2008,"fine","armors/chain_mail1.png","Chain Mail Of Vitality","pancel","mellvert","","","","","10","10","10","15","1","1",[{pancel_anyaga:"plate"}]],[2009,"fine","armors/chain_mail1.png","Chain Mail Of Luck","pancel","mellvert","","","","","10","10","10","10","3","1",[{pancel_anyaga:"plate"}]],[2015,"masterwork","armors/chain_mail1.png","Chain Mail Of Greater Power","pancel","mellvert","","","","","17","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2016,"masterwork","armors/chain_mail1.png","Chain Mail Of Greater Dexterity","pancel","mellvert","","","","","10","17","10","10","1","1",[{pancel_anyaga:"plate"}]],[2017,"masterwork","armors/chain_mail1.png","Chain Mail Of Greater Defense","pancel","mellvert","","","","","10","10","17","10","1","1",[{pancel_anyaga:"plate"}]],[2018,"masterwork","armors/chain_mail1.png","Chain Mail Of Greater Vitality","pancel","mellvert","","","","","10","10","10","17","1","1",[{pancel_anyaga:"plate"}]],[2019,"masterwork","armors/chain_mail1.png","Chain Mail Of Greater Luck","pancel","mellvert","","","","","10","10","10","10","4","1",[{pancel_anyaga:"plate"}]],[2025,"rare","armors/chain_mail1.png","Chain Mail Of Power","pancel","mellvert","","","","","20","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2026,"rare","armors/chain_mail1.png","Chain Mail Of Dexterity","pancel","mellvert","","","","","10","20","10","10","1","1",[{pancel_anyaga:"plate"}]],[2027,"rare","armors/chain_mail1.png","Chain Mail Of Defense","pancel","mellvert","","","","","10","10","20","10","1","1",[{pancel_anyaga:"plate"}]],[2028,"rare","armors/chain_mail1.png","Chain Mail Of Vitality","pancel","mellvert","","","","","10","10","10","20","1","1",[{pancel_anyaga:"plate"}]],[2029,"rare","armors/chain_mail1.png","Chain Mail Of Magic Find","pancel","mellvert","","","","","10","10","10","10","5","1",[{pancel_anyaga:"plate"}]],[2020,"rare","headgear/helmet2_etched.png","Helmet Of Power","pancel","sapka","","","","","13","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2040,"basic","amulet/bone_gray.png","Amulet","pancel","nyaklanc","","","","","13","10","10","10","1","1"],[2070,"basic","ring/brass.png","Ring","pancel","gyuru","","","","","13","10","10","10","1","1"],[2090,"basic","armors/boots2_jackboots.png","Boots","pancel","cipo","","","","","13","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2110,"basic","armors/glove1.png","Plate Glove","pancel","kesztyu","","","","","13","10","10","10","1","1",[{pancel_anyaga:"plate"}]],[2500,"basic","armors/glove2.png","Leather Glove","pancel","kesztyu","","","","","13","10","10","10","1","1",[{pancel_anyaga:"leather"}]],[2600,"basic","armors/leather_armour2.png","Leather armor","pancel","mellvert","","","","","13","10","10","10","1","1",[{pancel_anyaga:"leather"}]],[2800,"basic","armors/glove3.png","Cloth Glove","pancel","kesztyu","","","","","13","10","10","10","1","1",[{pancel_anyaga:"cloth"}]],[2900,"basic","armors/robe2.png","Cloth armor","pancel","mellvert","","","","","13","10","10","10","1","1",[{pancel_anyaga:"cloth"}]],[4e3,"rare","scroll.png","Strange Scroll part 1/3 - quest item","papir","papir","","","","","","","","","","1",[{leiras:"The name of... ( the scroll is not complete )"}]],[4001,"rare","scroll.png","Strange Scroll part 2/3 - quest item","papir","papir","","","","","","","","","","1",[{leiras:"...the demon is Ca... ( the scroll is not complete )"}]],[4002,"rare","scroll.png","Strange Scroll part 3/3 - quest item","papir","papir","","","","","","","","","","1",[{leiras:"...ton"}]],[4005,"rare","scroll.png","Golden Scroll part 1/2 - quest item","papir","papir","","","","","","","","","","1",[{leiras:"The word you searching for is Amal... ( the scroll is not complete )"}]],[4006,"rare","scroll.png","Golden Scroll part 2/2 - quest item","papir","papir","","","","","","","","","","1",[{leiras:"...ryn ( the scroll is not complete )"}]],[5e3,"basic","brilliant_blue.png","Mana Potion","ital","mana","","","","","","","","","","1",[{leiras:"Restores 20 mana",mennyi_manat_ad:20}]],[5001,"masterwork","brilliant_blue.png","Mana Potion","ital","mana","","","","","","","","","","1",[{leiras:"Restores 30 mana",mennyi_manat_ad:30}]],[8e3,"basic","skeleton_humanoid_large.png","Bones from a skeleton","ellenseg_darabok","csont","","","","","","","","","","1",[{leiras:"Can be used for transmutation"}]]]};Targyak.prototype.alap_targyadatok=function(e){var t={id:0,kep_fajl:"",fokategoria:"",alkategoria:"",kategoria_neve:"",kategoria_szine:"",targy_neve:"",targy_leirasa:"",statok:{sebesseg:0,attack1:0,attack2:0,hatotavolsag:0,power:0,dexterity:0,defense:0,vitality:0,magicfind:0}};for(var n=0;n<this.targyak.length;n++){if(this.targyak[n][0]==e){t.id=e;t.statok={sebesseg:this.targyak[n][6],attack1:this.targyak[n][7],attack2:this.targyak[n][8],hatotavolsag:this.targyak[n][9],power:this.targyak[n][10],dexterity:this.targyak[n][11],defense:this.targyak[n][12],vitality:this.targyak[n][13],magicfind:this.targyak[n][14]};break}}return t};Targyak.prototype.random_ertek_generalas=function(e){var t;if(e!=0){e=parseInt(e);var n=parseInt(e-e*.1);var r=parseInt(e+e*.1);var i=randint(n,r);if(i==0){i=1}t=i}else{t=0}return t};Targyak.prototype.targy_generalas=function(e){var t="";var n=this.alap_targyadatok(e);t=base64_encode(e+"|"+this.random_ertek_generalas(n.statok.sebesseg)+"|"+this.random_ertek_generalas(n.statok.attack1)+"|"+this.random_ertek_generalas(n.statok.attack2)+"|"+this.random_ertek_generalas(n.statok.power)+"|"+this.random_ertek_generalas(n.statok.dexterity)+"|"+this.random_ertek_generalas(n.statok.defense)+"|"+this.random_ertek_generalas(n.statok.vitality)+"|"+this.random_ertek_generalas(n.statok.magicfind));return t};Targyak.prototype.mi_a_kategoria_szine=function(e){var t="";if(e=="basic"){t="cccccc"}if(e=="fine"){t="62A4DA"}if(e=="masterwork"){t="1A9306"}if(e=="rare"){t="FCD00B"}return t};Targyak.prototype.targyadatok=function(e){if(typeof e==="undefined"){return false}var t=base64_decode(e);var n=t.split("|");var r=n[0];var i={id:0,kep_fajl:"",fokategoria:"",alkategoria:"",kategoria_neve:"",kategoria_szine:"",targy_neve:"",targy_leirasa:"",statok:{sebesseg:0,attack1:0,attack2:0,hatotavolsag:0,power:0,dexterity:0,defense:0,vitality:0,magicfind:0},pancel_anyaga:""};for(var s=0;s<this.targyak.length;s++){if(this.targyak[s][0]==r){i.id=e;i.statok={sebesseg:n[1],attack1:n[2],attack2:n[3],hatotavolsag:this.targyak[s][9],power:n[4],dexterity:n[5],defense:n[6],vitality:n[7],magicfind:n[8]};i.kep_fajl=this.targyak[s][2];i.fokategoria=this.targyak[s][4];i.alkategoria=this.targyak[s][5];i.kategoria_neve=this.targyak[s][1];i.kategoria_szine=this.mi_a_kategoria_szine(this.targyak[s][1]);i.targy_kepe=this.targyak[s][2];i.targy_neve=this.targyak[s][3];i.targy_leirasa="";i.targy_leirasa+="<strong style='color:#"+i.kategoria_szine+"'>"+this.targyak[s][3]+"</strong><br>";if(this.targyak[s][4]=="fegyver"){if(this.targyak[s][5]=="kard"){i.targy_leirasa+="<span class='kicsi'>(One handed sword)</span><br>"}if(this.targyak[s][5]=="ketkezes_kard"){i.targy_leirasa+="<span class='kicsi'>(Two handed sword)</span><br>"}if(this.targyak[s][5]=="katana"){i.targy_leirasa+="<span class='kicsi'>(Katana)</span><br>"}if(this.targyak[s][5]=="scimitar"){i.targy_leirasa+="<span class='kicsi'>(Scimitar)</span><br>"}if(this.targyak[s][5]=="falchion"){i.targy_leirasa+="<span class='kicsi'>(Falchion)</span><br>"}if(this.targyak[s][5]=="pajzs"){i.targy_leirasa+="<span class='kicsi'>(Shield)</span><br>"}if(this.targyak[s][5]=="ij"){i.targy_leirasa+="<span class='kicsi'>(Bow)</span><br>"}if(this.targyak[s][5]=="szamszerij"){i.targy_leirasa+="<span class='kicsi'>(Crossbow)</span><br>"}if(this.targyak[s][5]=="fejsze"){i.targy_leirasa+="<span class='kicsi'>(Axe)</span><br>"}if(this.targyak[s][5]=="kes"){i.targy_leirasa+="<span class='kicsi'>(Knife)</span><br>"}if(this.targyak[s][5]=="csephadaro"){i.targy_leirasa+="<span class='kicsi'>(Flail)</span><br>"}if(this.targyak[s][5]=="alabard"){i.targy_leirasa+="<span class='kicsi'>(Halberd)</span><br>"}if(this.targyak[s][5]=="kalapacs"){i.targy_leirasa+="<span class='kicsi'>(Hammer)</span><br>"}if(this.targyak[s][5]=="morningstar"){i.targy_leirasa+="<span class='kicsi'>(Morningstar)</span><br>"}if(this.targyak[s][5]=="vivobot"){i.targy_leirasa+="<span class='kicsi'>(Quarterstaff)</span><br>"}if(this.targyak[s][5]=="kasza"){i.targy_leirasa+="<span class='kicsi'>(Scythe)</span><br>"}if(this.targyak[s][5]=="szigony"){i.targy_leirasa+="<span class='kicsi'>(Trident)</span><br>"}if(this.targyak[s][5]=="landzsa"){i.targy_leirasa+="<span class='kicsi'>(Spear)</span><br>"}if(this.targyak[s][5]=="csuzli"){i.targy_leirasa+="<span class='kicsi'>(Sling)</span><br>"}if(this.targyak[s][5]=="bot"){i.targy_leirasa+="<span class='kicsi'>(Staff)</span><br>"}if(this.targyak[s][5]=="palca"){i.targy_leirasa+="<span class='kicsi'>(Wand)</span><br>"}}i.targy_leirasa+="<br>";if(this.targyak[s][7]!=0&&this.targyak[s][8]!=0){i.targy_leirasa+="Damage: "+n[2]+"-"+n[3]+"<br>"}if(this.targyak[s][10]!=0){i.targy_leirasa+="Power: +"+n[4]+"<br>"}if(this.targyak[s][11]!=0){i.targy_leirasa+="Dexterity: +"+n[5]+"<br>"}if(this.targyak[s][12]!=0){i.targy_leirasa+="Defense: +"+n[6]+"<br>"}if(this.targyak[s][13]!=0){i.targy_leirasa+="Vitality: +"+n[7]+"<br>"}if(this.targyak[s][14]!=0){i.targy_leirasa+="Magic Find:"+n[8]+"%<br>"}if(this.targyak[s][6]!=0){i.targy_leirasa+="<br>Speed: "+n[1]+"<br>"}if(this.targyak[s][15]!=0){i.targy_leirasa+="<br>Level: "+this.targyak[s][15]+"<br>"}if(this.targyak[s][16]){var o=this.targyak[s][16];for(var u=0;u<o.length;u++){if(typeof o[u].mennyi_manat_ad!=="undefined"){i.mennyi_manat_ad=o[u].mennyi_manat_ad}if(typeof o[u].leiras!=="undefined"){i.targy_leirasa+="<br>"+o[u].leiras+"<br>"}if(typeof o[u].gyogyit!=="undefined"){i.targy_leirasa+="<br>Restores "+o[u].gyogyit+" HP<br>"}if(typeof o[u].pancel_anyaga!=="undefined"){i.pancel_anyaga=o[u].pancel_anyaga}}}if(this.targyak[s][4]=="fegyver"){i.targy_leirasa+="<br>2 unused gem slot<br>"}i.targy_leirasa+="<br><strong style='color:#"+i.kategoria_szine+"'>"+this.targyak[s][1]+"</strong><br><br>";if(this.targyak[s][4]=="fegyver"||this.targyak[s][4]=="pancel"){if(this.targyak[s][1]=="basic"){i.targy_leirasa+="Price: 15 gold<br>"}if(this.targyak[s][1]=="fine"){i.targy_leirasa+="Price: 30 gold<br>"}if(this.targyak[s][1]=="masterwork"){i.targy_leirasa+="Price: 50 gold<br>"}if(this.targyak[s][1]=="rare"){i.targy_leirasa+="Price: 75 gold<br>"}}break}}return i};var Skillek={};Skillek=function(){this.skillek=[{id:1,tipus:"passziv",nev:"Defy me not",leiras:"+10% power if your HP is less than 50%",funkcio:"defy_me_not",buff_hany_mpig_marad:0,ikon:"assets/images/tukimas_dance.png",cd:0,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:2,tipus:"buff",nev:"Let your rage burn",leiras:"+5% power and +5% dexterity",funkcio:"let_your_rage_burn",buff_hany_mpig_marad:6,ikon:"assets/images/berserker_rage.png",cd:11e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:3,tipus:"aktiv",nev:"Fire blast",leiras:"Shoots a fireball dealing high damage",funkcio:"fireball",buff_hany_mpig_marad:0,ikon:"assets/images/fireball.png",cd:12e3,spell_power:18,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:32,szint:1,mennyi_skillpontba_kerul:1},{id:4,tipus:"gyogyitas",nev:"Blessing",leiras:"Bless your target and restore 20% hp",funkcio:"blessing",buff_hany_mpig_marad:0,ikon:"assets/images/tame_beasts.png",cd:8e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:5,tipus:"aktiv",nev:"Magic arrows",leiras:"Shoots 3 magic arrow",funkcio:"magic_arrow",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/bolt_of_magma.png",cd:4e3,spell_power:6,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:6,tipus:"passziv",nev:"Fired up",leiras:"+10% power, +10% dexterity, +5% hp if character is at the first row",funkcio:"fired_up",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/orb_of_destruction.png",cd:0,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:7,tipus:"aktiv",nev:"Make them bleed",leiras:"Deal damage and apply bleed on enemy",funkcio:"make_them_bleed",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/pain.png",cd:27e3,spell_power:11,dot_per_mp:4,dot_hany_mp_ig_marad:10,mindenki_megkapja:"nem",mana:15,szint:1,mennyi_skillpontba_kerul:1},{id:8,tipus:"buff",nev:"Protect",leiras:"+20% defense, +20% vitality for everyone except the caster",funkcio:"protect",buff_hany_mpig_marad:20,ikon:"assets/items/skillek/phase_shift.png",cd:3e4,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"mindenki_kiveve_caster",mana:10,szint:5,mennyi_skillpontba_kerul:2},{id:9,tipus:"passziv",nev:"In God we trust",leiras:"+12% power, +12% vitality",funkcio:"in_god_we_trust",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/apportation.png",cd:0,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:10,tipus:"buff",nev:"Rallying shout",leiras:"+10% power for everyone",funkcio:"rallying_shout",buff_hany_mpig_marad:5,ikon:"assets/items/skillek/silence.png",cd:22e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"mindenki",mana:10,szint:4,mennyi_skillpontba_kerul:1},{id:11,tipus:"buff",nev:"Hero's presence",leiras:"+20% power, +15% dexterity for you and the character next to you for 5 minutes",funkcio:"heros_presence",buff_hany_mpig_marad:300,ikon:"assets/items/skillek/statue_form.png",cd:3e5,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"caster_es_mellette_allo",mana:10,szint:5,mennyi_skillpontba_kerul:1},{id:12,tipus:"buff",nev:"Let your hatred flow",leiras:"+10% power, +15% dexterity for everyone.",funkcio:"let_your_hatred_flow",buff_hany_mpig_marad:11,ikon:"assets/items/skillek/lees_rapid_deconstruction.png",cd:27e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"mindenki",mana:10,szint:10,mennyi_skillpontba_kerul:1},{id:13,tipus:"aktiv",nev:"On my mark",leiras:"Removes cooldown from every character's weapon.",funkcio:"on_my_mark",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/selective_amnesia.png",cd:12e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:23,szint:5,mennyi_skillpontba_kerul:1},{id:14,tipus:"aktiv",nev:"Corruption",leiras:"Deals dark damage.",funkcio:"corruption",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/alter_self.png",cd:12e3,spell_power:18,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:8,mennyi_skillpontba_kerul:1},{id:15,tipus:"aktiv",nev:"Nightmares",leiras:"Deal dark damage and apply damage over time on enemy",funkcio:"nightmares",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/banishment.png",cd:17e3,spell_power:9,dot_per_mp:3,dot_hany_mp_ig_marad:13,mindenki_megkapja:"nem",mana:10,szint:7,mennyi_skillpontba_kerul:1},{id:16,tipus:"aktiv",nev:"Sudden death",leiras:"Deals lightning damage.",funkcio:"sudden_death",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/insulation.png",cd:22e3,spell_power:28,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:20,szint:10,mennyi_skillpontba_kerul:1},{id:17,tipus:"buff",nev:"Your weakness, my pleasure",leiras:"Apply -20% damage debuff on enemy and 5% power to caster",funkcio:"your_weakness_my_pleasure",buff_hany_mpig_marad:25,ikon:"assets/items/skillek/fulsome_distillation.png",cd:38e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:20,szint:5,mennyi_skillpontba_kerul:2},{id:18,tipus:"buff",nev:"Punish them",leiras:"+30% dexterity",funkcio:"punish_them",buff_hany_mpig_marad:15,ikon:"assets/items/skillek/symbol_of_torment.png",cd:23e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:7,mennyi_skillpontba_kerul:1},{id:19,tipus:"aktiv",nev:"Flaming agony",leiras:"Deals area of effect fire damage",funkcio:"flaming_agony",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/sticky_flame.png",cd:48e3,spell_power:31,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:46,szint:10,mennyi_skillpontba_kerul:3},{id:20,tipus:"buff",nev:"Judgement",leiras:"+15% dexterity and 15% power",funkcio:"judgement",buff_hany_mpig_marad:15,ikon:"assets/items/skillek/blade_hands.png",cd:23e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:21,tipus:"buff",nev:"Final charge",leiras:"+38% power but -50% defense",funkcio:"final_charge",buff_hany_mpig_marad:10,ikon:"assets/items/skillek/warp_weapon.png",cd:23e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:7,mennyi_skillpontba_kerul:2},{id:22,tipus:"buff",nev:"Stand united",leiras:"+5% to all stat for everyone.",funkcio:"stand_united",buff_hany_mpig_marad:600,ikon:"assets/items/skillek/flight.png",cd:6e5,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"mindenki",mana:10,szint:5,mennyi_skillpontba_kerul:1},{id:23,tipus:"gyogyitas",nev:"Martyr",leiras:"Deals damage to caster and heal target for max hp",funkcio:"martyr",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/detect_traps.png",cd:35e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:30,szint:8,mennyi_skillpontba_kerul:2},{id:24,tipus:"gyogyitas",nev:"Resurrect",leiras:"Resurrects target character",funkcio:"resurrect",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/invisibility.png",cd:18e5,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:60,szint:10,mennyi_skillpontba_kerul:3},{id:25,tipus:"buff",nev:"Willing to sacrifice",leiras:"+15% to all stat for everyone but deals damage to caster when the buff ends",funkcio:"willing_to_sacrifice",buff_hany_mpig_marad:15,ikon:"assets/items/skillek/see_invisible.png",cd:6e4,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"mindenki",mana:30,szint:5,mennyi_skillpontba_kerul:1},{id:26,tipus:"aktiv",nev:"Hurricane",leiras:"Deals area of effect air damage",funkcio:"hurricane",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/airstrike.png",cd:28e3,spell_power:31,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:29,szint:1,mennyi_skillpontba_kerul:1},{id:27,tipus:"aktiv",nev:"Meteor shower",leiras:"Deals area of effect fire damage",funkcio:"meteor_shower",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/flame_tongue.png",cd:31e3,spell_power:34,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:32,szint:5,mennyi_skillpontba_kerul:1},{id:28,tipus:"aktiv",nev:"Weaken their mind",leiras:"Deals damage and gives -20% damage debuff to enemy",funkcio:"weaken_their_mind",buff_hany_mpig_marad:14,ikon:"assets/items/skillek/detect_items.png",cd:22e3,spell_power:22,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:19,szint:5,mennyi_skillpontba_kerul:1},{id:29,tipus:"aktiv",nev:"Setting fire",leiras:"Deals fire damage",funkcio:"setting_fire",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/bolt_of_fire.png",cd:17e3,spell_power:24,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:12,szint:1,mennyi_skillpontba_kerul:1},{id:30,tipus:"buff",nev:"Burning Hatred",leiras:"+10% power and +10% dexterity",funkcio:"burning_hatred",buff_hany_mpig_marad:20,ikon:"assets/items/skillek/dragon_form.png",cd:3e4,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:31,tipus:"passziv",nev:"In flames I come",leiras:"At 100% HP +10% dexterity",funkcio:"in_flames_i_come",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/evaporate.png",cd:0,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:10,szint:1,mennyi_skillpontba_kerul:1},{id:32,tipus:"aktiv",nev:"Scorch",leiras:"Deals damage and gives -30% power, -30% defense debuff to enemy",funkcio:"scorch",buff_hany_mpig_marad:10,ikon:"assets/items/skillek/enslavement.png",cd:22e3,spell_power:24,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:22,szint:5,mennyi_skillpontba_kerul:1},{id:33,tipus:"buff",nev:"Astral shield",leiras:"+20% defense and reflects 70% of attacks",funkcio:"astral_shield",buff_hany_mpig_marad:20,ikon:"assets/items/skillek/polymorph_other.png",cd:3e4,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:24,szint:10,mennyi_skillpontba_kerul:1},{id:34,tipus:"gyogyitas",nev:"Heal",leiras:"Heal your target, restores 30% hp",funkcio:"heal",buff_hany_mpig_marad:0,ikon:"assets/images/tame_beasts.png",cd:9e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:30,szint:1,mennyi_skillpontba_kerul:1},{id:35,tipus:"aktiv",nev:"Group Heal",leiras:"Heal every character for 40% hp",funkcio:"group_heal",buff_hany_mpig_marad:0,ikon:"assets/items/skillek/sandblast.png",cd:35e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:90,szint:8,mennyi_skillpontba_kerul:2},{id:36,tipus:"gyogyitas",nev:"Dark Heal",leiras:"Heal your target, restores 23% hp",funkcio:"dark_heal",buff_hany_mpig_marad:0,ikon:"assets/images/tame_beasts.png",cd:12e3,spell_power:0,dot_per_mp:0,dot_hany_mp_ig_marad:0,mindenki_megkapja:"nem",mana:25,szint:1,mennyi_skillpontba_kerul:1}]};Skillek.prototype.skill_adatok=function(e){var t={};for(var n=0;n<this.skillek.length;n++){if(this.skillek[n].id==e){t.id=this.skillek[n].id;t.tipus=this.skillek[n].tipus;t.nev=this.skillek[n].nev;t.leiras="<strong>"+this.skillek[n].id+" "+this.skillek[n].nev+"</strong>";if(this.skillek[n].tipus=="buff"){t.leiras+=" - Buff<br><br>"}if(this.skillek[n].tipus=="aktiv"||this.skillek[n].tipus=="gyogyitas"){t.leiras+=" - Active<br><br>"}if(this.skillek[n].tipus=="passziv"){t.leiras+=" - Passive<br><br>"}t.leiras+=this.skillek[n].leiras;if(this.skillek[n].tipus=="aktiv"&&this.skillek[n].spell_power!=0){t.leiras+="<br><br>Spell power: "+this.skillek[n].spell_power}if(this.skillek[n].buff_hany_mpig_marad!=0){t.leiras+="<br><br>Buff length: "+this.skillek[n].buff_hany_mpig_marad+" seconds"}if(this.skillek[n].cd!=0){t.leiras+="<br><br>Cooldown: "+this.skillek[n].cd/1e3+" seconds"}if(this.skillek[n].mana!=0){t.leiras+="<br><br>Mana cost: "+this.skillek[n].mana+" mana"}t.leiras+="<br><br>Requires level "+this.skillek[n].szint;t.leiras+="<br><br>Skill point cost: "+this.skillek[n].mennyi_skillpontba_kerul;t.funkcio=this.skillek[n].funkcio;t.ikon=this.skillek[n].ikon;t.cd=this.skillek[n].cd;t.alap_sebzes=this.skillek[n].spell_power;t.dot=this.skillek[n].dot_per_mp;t.dot_ido=this.skillek[n].dot_hany_mp_ig_marad;t.mennyi_ideig_marad_aktiv=this.skillek[n].buff_hany_mpig_marad;t.mindenki_megkapja=this.skillek[n].mindenki_megkapja;t.mana=this.skillek[n].mana;t.szint=this.skillek[n].szint;t.mennyi_skillpontba_kerul=this.skillek[n].mennyi_skillpontba_kerul;break}}return t};Skillek.prototype.skill_futtatasa=function(skill_id,karakter_adatok,skillek_hatasok){var skilladatok=this.skill_adatok(skill_id);var mi_a_funkcio_neve=skilladatok.funkcio;if(mi_a_funkcio_neve!=""){var mit="var valasz = this."+mi_a_funkcio_neve+"("+skill_id+",karakter_adatok,skillek_hatasok);";eval(mit);return valasz}};Skillek.prototype.skill_animalas=function(e,t){if(e==7){var n=new TextureAnimator(texture_skill_anim_magic_006,5,7,35,40,0);explosionTexture=texture_skill_anim_magic_006}if(e==3){var n=new TextureAnimator(texture_skill_anim_fire_002,5,5,25,40,0);explosionTexture=texture_skill_anim_fire_002}if(e==14){var n=new TextureAnimator(texture_skill_anim_cast_008,5,4,20,40,0);explosionTexture=texture_skill_anim_cast_008}if(e==17){var n=new TextureAnimator(texture_skill_anim_darkness_002,5,6,30,40,0);explosionTexture=texture_skill_anim_darkness_002}if(e==19){var n=new TextureAnimator(texture_skill_anim_fire_001,5,4,20,40,0);explosionTexture=texture_skill_anim_fire_001}if(e==16){var n=new TextureAnimator(texture_skill_anim_thunder_002,5,5,25,40,0);explosionTexture=texture_skill_anim_thunder_002}if(e==15){var n=new TextureAnimator(texture_skill_anim_darkness_001,5,6,30,40,0);explosionTexture=texture_skill_anim_darkness_001}if(e==5){var n=new TextureAnimator(texture_skill_anim_cast_001,5,4,20,40,0);explosionTexture=texture_skill_anim_cast_001}if(e==26){var n=new TextureAnimator(texture_skill_anim_wind_003,5,6,30,40,0);explosionTexture=texture_skill_anim_wind_003}if(e==27){var n=new TextureAnimator(texture_skill_anim_fire_003,5,8,40,40,0);explosionTexture=texture_skill_anim_fire_003}if(e==28){var n=new TextureAnimator(texture_skill_anim_magic_007,5,4,20,40,0);explosionTexture=texture_skill_anim_magic_007}if(e==32){var n=new TextureAnimator(texture_skill_anim_cast_009,5,4,20,40,0);explosionTexture=texture_skill_anim_cast_009}if(e==20||e==10||e==25||e==21||e==22||e==18||e==17||e==12||e==8){var n=new TextureAnimator(texture_skill_anim_effect_002,5,5,25,40,0);explosionTexture=texture_skill_anim_effect_002}if(e==11||e==13||e==4||e==24||e==23||e==33||e==34||e==35||e==36){var n=new TextureAnimator(texture_skill_anim_effect_002,5,5,25,40,0);explosionTexture=texture_skill_anim_effect_002}if(e==1||e==2||e==29||e==30||e==31){var n=new TextureAnimator(texture_skill_anim_effect_002,5,5,25,40,0);explosionTexture=texture_skill_anim_effect_002}skill_animaciok.push(n);var r=this.skill_adatok(e);if(r.tipus=="aktiv"){var i=new THREE.PlaneGeometry(35,35,1,1)}else{var i=new THREE.PlaneGeometry(15,15,1,1)}var s=new THREE.MeshBasicMaterial({map:explosionTexture});s.transparent=true;var o=new THREE.Mesh(i,s);o.rotation=MovingCube.rotation;if(r.tipus=="aktiv"){o.position.set(MovingCube.position.x,-10,MovingCube.position.z)}else{o.position.set(MovingCube.position.x,-15,MovingCube.position.z)}scene.add(o);var u=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);o.position.x=MovingCube.position.x;o.position.z=MovingCube.position.z;if(r.tipus=="aktiv"){var a=65}else{var a=25}if(deg(MovingCube.rotation.y)==180){o.position.z+=a;if(karakterek[u].sorban_melyik_oldal=="bal"){o.position.x+=8}else{o.position.x-=8}}if(deg(MovingCube.rotation.y)==0){o.position.z-=a;if(karakterek[u].sorban_melyik_oldal=="bal"){o.position.x-=8}else{o.position.x+=8}}if(deg(MovingCube.rotation.y)==90){o.position.x-=a;if(karakterek[u].sorban_melyik_oldal=="bal"){o.position.z+=8}else{o.position.z-=8}}if(deg(MovingCube.rotation.y)==270){o.position.x+=a;if(karakterek[u].sorban_melyik_oldal=="bal"){o.position.z-=8}else{o.position.z+=8}}setTimeout(function(){scene.remove(o)},4e3)};Skillek.prototype.skill_inditasa=function(e,t,n){var r=n;if(e==3){hang_lejatszas(45,{pan:0,volume:50})}if(e==5){hang_lejatszas(46,{pan:0,volume:60})}if(e==4){hang_lejatszas(47,{pan:0,volume:30})}if(e==17){hang_lejatszas(48,{pan:0,volume:60})}if(e==8){hang_lejatszas(49,{pan:0,volume:60})}if(e==23){hang_lejatszas(50,{pan:0,volume:60})}if(e==19){hang_lejatszas(51,{pan:0,volume:60})}if(e==27){hang_lejatszas(52,{pan:0,volume:60})}if(e==32){hang_lejatszas(53,{pan:0,volume:60})}if(e==33){hang_lejatszas(54,{pan:0,volume:60})}if(e==12){hang_lejatszas(55,{pan:0,volume:60})}if(e==24){hang_lejatszas(56,{pan:0,volume:60})}if(e==28){hang_lejatszas(57,{pan:0,volume:60})}if(e==18){hang_lejatszas(58,{pan:0,volume:60})}if(e==20){hang_lejatszas(59,{pan:0,volume:60})}if(e==25){hang_lejatszas(60,{pan:0,volume:60})}if(e==21){hang_lejatszas(61,{pan:0,volume:60})}if(e==22){hang_lejatszas(62,{pan:0,volume:60})}if(e==7){hang_lejatszas(63,{pan:0,volume:60})}if(e==10){hang_lejatszas(64,{pan:0,volume:60})}if(e==11){hang_lejatszas(65,{pan:0,volume:60})}if(e==13){hang_lejatszas(66,{pan:0,volume:60})}if(e==14){hang_lejatszas(67,{pan:0,volume:60})}if(e==16){hang_lejatszas(68,{pan:0,volume:60})}if(e==15){hang_lejatszas(69,{pan:0,volume:60})}if(e==26){hang_lejatszas(70,{pan:0,volume:60})}if(e==34){hang_lejatszas(47,{pan:0,volume:30})}if(e==35){hang_lejatszas(47,{pan:0,volume:30})}if(e==36){hang_lejatszas(47,{pan:0,volume:30})}var i=this.skill_adatok(e);var s=i.cd+i.mennyi_ideig_marad_aktiv*1e3;this.skill_animalas(e,t);var o="";if(n.mikor_aktivalta!=""){o=n.mikor_aktivalta}if(o==""){r.mikor_aktivalta=Math.round((new Date).getTime()/1e3)}this.skill_futtatasa(e,t,n);return r};Skillek.prototype.willing_to_sacrifice=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.defense=0;r.vitality=0;r.dexterity=0;if(n.buff_lejart==0){r.buff_lejart=1;if(t.karakter_id==n.forras_karakter_id){var u=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);karakterek[u].sebzodes(karakterek[u].max_hp*.35)}}if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.15);r.defense=parseInt(t.defense*.15);r.vitality=parseInt(t.defense*.15);r.dexterity=parseInt(t.defense*.15);r.buff_lejart=0}}return r};Skillek.prototype.astral_shield=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.defense=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.defense=parseInt(t.defense*.1);r.buff_lejart=0}}return r};Skillek.prototype.burning_hatred=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.1);r.dexterity=parseInt(t.defense*.1);r.buff_lejart=0}}return r};Skillek.prototype.stand_united=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.defense=0;r.vitality=0;r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.05);r.defense=parseInt(t.defense*.05);r.vitality=parseInt(t.defense*.05);r.dexterity=parseInt(t.defense*.05);r.buff_lejart=0}}return r};Skillek.prototype.final_charge=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.defense=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.39);r.defense=-parseInt(t.defense*.5);r.buff_lejart=0}}return r};Skillek.prototype.judgement=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.dexterity=0;r.power=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.15);r.dexterity=parseInt(t.dexterity*.15);r.buff_lejart=0}}return r};Skillek.prototype.punish_them=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.dexterity=parseInt(t.dexterity*.3);r.buff_lejart=0}}return r};Skillek.prototype.let_your_hatred_flow=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.1);r.dexterity=parseInt(t.dexterity*.15);r.buff_lejart=0}}return r};Skillek.prototype.rallying_shout=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.1);r.buff_lejart=0}}return r};Skillek.prototype.protect=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.defense=0;r.vitality=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.defense=parseInt(t.defense*.2);r.vitality=parseInt(t.vitality*.2);r.buff_lejart=0}}return r};Skillek.prototype.your_weakness_my_pleasure=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.enemy_damage=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.05);r.enemy_damage=.2;r.buff_lejart=0}}return r};Skillek.prototype.let_your_rage_burn=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.1);r.dexterity=parseInt(t.dexterity*.15);r.buff_lejart=0}}return r};Skillek.prototype.nightmares=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;r.dot=i.dot;return r};Skillek.prototype.make_them_bleed=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;r.dot=i.dot;return r};Skillek.prototype.on_my_mark=function(e,t,n){var r=n;var i=this.skill_adatok(e);for(var s=0;s<karakterek.length;s++){karakterek[s].minden_fegyverrol_cd_leszedes()}return r};Skillek.prototype.scorch=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;r.enemy_power=.3;r.enemy_defense=.3;return r};Skillek.prototype.weaken_their_mind=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;r.enemy_damage=.2;return r};Skillek.prototype.setting_fire=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.meteor_shower=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.hurricane=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.flaming_agony=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.sudden_death=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.corruption=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.fireball=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=i.alap_sebzes;return r};Skillek.prototype.magic_arrow=function(e,t,n){var r=n;var i=this.skill_adatok(e);r.mennyit_sebzett=30;return r};Skillek.prototype.resurrect=function(e,t,n){var r=n;r.mennyit_sebzett=30;return r};Skillek.prototype.martyr=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);karakterek[s].sebzodes(karakterek[s].max_hp*.3);r.mennyit_sebzett=99999;return r};Skillek.prototype.group_heal=function(e,t,n){var r=n;var i=this.skill_adatok(e);for(var s=0;s<karakterek.length;s++){var o=parseInt(karakterek[s].max_hp*.4);karakterek[s].gyogyulas(35,o)}return r};Skillek.prototype.dark_heal=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);var o=parseInt(karakterek[s].max_hp*.23);r.mennyit_sebzett=o;return r};Skillek.prototype.heal=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);var o=parseInt(karakterek[s].max_hp*.3);r.mennyit_sebzett=o;return r};Skillek.prototype.blessing=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s=karakter_hanyadik_a_tombben_id_alapjan(t.karakter_id);var o=parseInt(karakterek[s].max_hp*.2);r.mennyit_sebzett=o;return r};Skillek.prototype.fired_up=function(e,t,n){var r=n;if(t.hanyadik_sorban_van==1){r.power=parseInt(t.power*.1);r.dexterity=parseInt(t.dexterity*.1);r.vitality=parseInt(t.vitality*.05);r.buff_bekapcsolt=1}else{r.power=0;r.dexterity=0;r.vitality=0;r.buff_lejart=1}return r};Skillek.prototype.heros_presence=function(e,t,n){var r=n;var i=this.skill_adatok(e);var s="";if(n.mikor_aktivalta!=""){s=n.mikor_aktivalta}if(s!=""){var o=Math.round((new Date).getTime()/1e3);if(parseInt(s)+i.mennyi_ideig_marad_aktiv<o){r.power=0;r.dexterity=0;r.buff_lejart=1;if(parseInt(s)+i.mennyi_ideig_marad_aktiv+i.cd/1e3<o){r.mikor_aktivalta=""}}else{r.power=parseInt(t.power*.2);r.dexterity=parseInt(t.dexterity*.15);r.buff_lejart=0}}return r};Skillek.prototype.in_god_we_trust=function(e,t,n){var r=n;r.power=parseInt(t.power*.15);r.vitality=parseInt(t.vitality*.15);r.buff_bekapcsolt=1;return r};Skillek.prototype.in_flames_i_come=function(e,t,n){var r=n;var i=t.hp/t.max_hp*100;if(i==100){r.dexterity=parseInt(t.dexterity*.1);r.buff_bekapcsolt=1}else{r.buff_lejart=1}return r};Skillek.prototype.defy_me_not=function(e,t,n){var r=n;var i=t.hp/t.max_hp*100;if(i<50){r.power=parseInt(t.power/100*10);r.buff_bekapcsolt=1}else{r.buff_lejart=1}return r};if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];if(a&&typeof a==="object"&&typeof a.toJSON==="function"){a=a.toJSON(e)}if(typeof rep==="function"){a=rep.call(t,e,a)}switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a){return"null"}gap+=indent;u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1){u[n]=str(n,a)||"null"}i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&&typeof rep==="object"){s=rep.length;for(n=0;n<s;n+=1){if(typeof rep[n]==="string"){r=rep[n];i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}else{for(r in a){if(Object.prototype.hasOwnProperty.call(a,r)){i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","    ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})()